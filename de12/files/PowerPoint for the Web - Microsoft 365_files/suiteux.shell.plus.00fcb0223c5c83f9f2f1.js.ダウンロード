var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_plus_start"),(self["suiteux_shell_webpackJsonp_suiteux-main"]=self["suiteux_shell_webpackJsonp_suiteux-main"]||[]).push([["plus"],{69215:function(e,t,n){"use strict";n.d(t,{I:function(){return l}});var a=/[\(\[\{\<][^\)\]\}\>]*[\)\]\}\>]/g,i=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,r=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,o=/\s+/g,s=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function l(e,t,n){return e?(e=function(e){return(e=(e=(e=e.replace(a,"")).replace(i,"")).replace(o," ")).trim()}(e),s.test(e)||!n&&r.test(e)?"":function(e,t){var n="",a=e.split(" ");return 2===a.length?(n+=a[0].charAt(0).toUpperCase(),n+=a[1].charAt(0).toUpperCase()):3===a.length?(n+=a[0].charAt(0).toUpperCase(),n+=a[2].charAt(0).toUpperCase()):0!==a.length&&(n+=a[0].charAt(0).toUpperCase()),t&&n.length>1?n.charAt(1)+n.charAt(0):n}(e,t)):""}},13879:function(e,t,n){(t=e.exports=n(51904)(!1)).push([e.id,'.o365cs-base .qNo\\/sN23chEBUe0H8Hn0HA\\=\\={padding-top:14px;padding-bottom:15px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1)}.o365cs-base .F0O9Uh2pe9g2AY0G8h\\/\\+Ig\\=\\={height:100%;display:table-cell;vertical-align:middle}.o365cs-base ._9vDKNLv2p0rO0JuPUAbO2Q\\=\\={outline:none;width:100%;height:100%;display:table;vertical-align:middle;white-space:nowrap;font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .CdPZflTrXWHEicpXXS6AlQ\\=\\={height:88px;display:inline-block;background:transparent;background-color:transparent;border-width:0;padding:0;width:88px}.o365cs-base ._8EiyIQbC2jdaO0EOWDlujA\\=\\={overflow:hidden;width:88px;height:88px;position:relative;vertical-align:middle}.o365cs-base ._8EiyIQbC2jdaO0EOWDlujA\\=\\= .ms-Persona{position:absolute;top:0;left:0}.o365cs-base ._8EiyIQbC2jdaO0EOWDlujA\\=\\= .ms-Persona .ms-Image-image{overflow:hidden;top:0}.o365cs-base .MpvtHlUkaovZcuOiXBne3A\\=\\={border-radius:50%;text-align:center;width:88px;height:88px;overflow:hidden;background-color:#a6a6a6}.o365cs-base .MpvtHlUkaovZcuOiXBne3A\\=\\=:before{margin-top:17px;padding-right:2px}.o365cs-base .ET90q9eZ8tc8ZXPAo76Ylg\\=\\={border-radius:50%;font-size:32px;text-align:center;line-height:88px!important;color:#fff;background-color:rgba(0,0,0,.6);position:absolute;left:0;top:0;width:100%;cursor:pointer}.o365cs-base .ET90q9eZ8tc8ZXPAo76Ylg\\=\\=:active{color:#bebbb8}.o365cs-base .SaqVecUjoNb0KEBe216b2A\\=\\={max-width:214px;white-space:nowrap;padding-left:10px;overflow:hidden;display:table-cell;line-height:88px;vertical-align:middle}.o365cs-base .nNx1yCZ2\\/ORVO8TDM3nSWg\\=\\=,.o365cs-base .hNLixTh\\+CloPpy10mYs9tw\\=\\=,.o365cs-base .pWVVXrrMBYjXprMj26pk8Q\\=\\={display:block;overflow:hidden;text-overflow:ellipsis;font:600 16px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .pWVVXrrMBYjXprMj26pk8Q\\=\\={font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .nNx1yCZ2\\/ORVO8TDM3nSWg\\=\\={text-align:right;font:10px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .\\+BuUSN5J6XE4OQWpQxcjlQ\\=\\={color:#106ebe}.o365cs-base .\\+BuUSN5J6XE4OQWpQxcjlQ\\=\\= div{line-height:30px}.o365cs-base .\\+BuUSN5J6XE4OQWpQxcjlQ\\=\\= div a{font-size:14px;font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;padding:0;text-decoration:none}.o365cs-base .\\+BuUSN5J6XE4OQWpQxcjlQ\\=\\= div{margin-top:4px;line-height:19px}.o365cs-base .\\+BuUSN5J6XE4OQWpQxcjlQ\\=\\= div:hover{text-decoration:underline}.o365cs-base .jnUqGtlqOJFibeuSHEVQ\\/w\\=\\={color:#8a8886}.o365cs-base .dANNEUd\\/6gcUsHCwwo4vMg\\=\\={display:inline;margin-right:30px}.o365cs-base .VX1ElPIMzFMFz9C\\/WiPN\\+A\\=\\={color:#fff;position:absolute}.o365cs-base .gD7D0IvB2LK4DtpKHP\\/kcg\\=\\={position:absolute;right:24px;bottom:24px}.o365cs-base .\\/mOlWjAqPf2WqoRBvRI6TA\\=\\={position:absolute;right:20px;bottom:38px}.o365cs-base .zbYgVZLJkpwl3AoOQWq7Vg\\=\\={width:8px;height:8px;position:absolute;z-index:2;padding-top:22px;padding-left:4px}.o365cs-base .eZeFoO97j7vtIHA7a4IQJQ\\=\\={width:16px;height:16px;position:absolute;z-index:2;padding-left:4px;padding-top:4px}.o365cs-base .sXytkqjdjf0xvjn5T2RLeA\\=\\={width:16px;height:16px;position:absolute;z-index:2;border-radius:12px}.o365cs-base .l\\+hNN9VULKqxAzbeinOj2Q\\=\\={color:#fff;position:absolute;left:2px;top:2px}',""]),t.locals={container:"qNo/sN23chEBUe0H8Hn0HA==",photoWrapper:"F0O9Uh2pe9g2AY0G8h/+Ig==",personaView:"_9vDKNLv2p0rO0JuPUAbO2Q==",personaPhotoContainer:"CdPZflTrXWHEicpXXS6AlQ==",personaPhoto:"_8EiyIQbC2jdaO0EOWDlujA==",doughboy:"MpvtHlUkaovZcuOiXBne3A==",cameraOverlay:"ET90q9eZ8tc8ZXPAo76Ylg==",personaDetails:"SaqVecUjoNb0KEBe216b2A==",companyDisplayName:"nNx1yCZ2/ORVO8TDM3nSWg==",userDisplayName:"hNLixTh+CloPpy10mYs9tw==",userEmail:"pWVVXrrMBYjXprMj26pk8Q==",linkList:"+BuUSN5J6XE4OQWpQxcjlQ==",chatUnknownSolid:"jnUqGtlqOJFibeuSHEVQ/w==",statusIconContainer:"dANNEUd/6gcUsHCwwo4vMg==",backGroundIconStyle:"VX1ElPIMzFMFz9C/WiPN+A==",presenceStatusDiv:"gD7D0IvB2LK4DtpKHP/kcg==",headerPresenceIconDiv:"/mOlWjAqPf2WqoRBvRI6TA==",headerPresenceIconCommonStyle:"zbYgVZLJkpwl3AoOQWq7Vg==",statusIconCommonStyle:"eZeFoO97j7vtIHA7a4IQJQ==",contextMenuIconStyle:"sXytkqjdjf0xvjn5T2RLeA==",headerBackGroundIconStyle:"l+hNN9VULKqxAzbeinOj2Q=="}},97027:function(e,t,n){(t=e.exports=n(51904)(!1)).push([e.id,'._07tLGRYM\\/89D7ElAIBuDmw\\=\\={top:100%;max-width:184px;width:auto!important;padding:8px 0}.o365cs-base .ZfuvsgSmPhMAqqrv55yOMA\\=\\={font:400 14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;border:0 solid #f4f4f4;text-align:center;background-color:transparent;position:relative;display:block;padding:4px 0 0}.o365cs-base .ZfuvsgSmPhMAqqrv55yOMA\\=\\=:active,.o365cs-base .ZfuvsgSmPhMAqqrv55yOMA\\=\\=:hover{text-decoration:underline}.o365cs-base .ZfuvsgSmPhMAqqrv55yOMA\\=\\=>span{display:-ms-flexbox;display:flex;justify-content:center}.o365cs-base .ZfuvsgSmPhMAqqrv55yOMA\\=\\=>span>div{margin-left:4px}.o365cs-base .DEfKR7CR9jTmB2rhYOL\\/jg\\=\\={font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;display:flex;height:36px;padding:7px 12px 0}',""]),t.locals={presenceContextMenu:"_07tLGRYM/89D7ElAIBuDmw==",presenceButton:"ZfuvsgSmPhMAqqrv55yOMA==",presenceContextMenuItem:"DEfKR7CR9jTmB2rhYOL/jg=="}},40308:function(e,t,n){(t=e.exports=n(51904)(!1)).push([e.id,'.ohcfXYh6LUBy5DS5kNUjRQ\\=\\={position:relative;overflow:hidden;border-radius:50%;width:100%;height:100%}._8ZYZKvxC8bvw1xgQGSkvvA\\=\\={position:absolute;left:0;top:0;display:inline-block;line-height:normal}.Mc\\+fiAdJTuKKS\\+yJLN3rDQ\\=\\=,._8ZYZKvxC8bvw1xgQGSkvvA\\=\\=,._8ZYZKvxC8bvw1xgQGSkvvA\\=\\= img{width:100%;height:100%}.Mc\\+fiAdJTuKKS\\+yJLN3rDQ\\=\\={position:absolute;left:0;top:0;border-radius:50%;text-align:center;display:inline-block;color:#fff;font-family:SegoeUI-SemiLight-final,Segoe UI Semilight,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;line-height:195%}.OLlo7WBYb7HJTGfGyVkiWQ\\=\\={font-size:13px!important;font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;line-height:normal!important;display:flex;align-items:center;justify-content:center}.Csa69b1duifKpk7Dd1dnYQ\\=\\=,.OLlo7WBYb7HJTGfGyVkiWQ\\=\\={background-color:transparent!important;border:1px solid;box-sizing:border-box}.Csa69b1duifKpk7Dd1dnYQ\\=\\={color:inherit!important}.lMHKWNw\\+dCJnMDe9\\+woOeA\\=\\={display:flex!important;align-items:center;justify-content:center;background-color:#a6a6a6;font-size:6em}.lMHKWNw\\+dCJnMDe9\\+woOeA\\=\\=,.AVxO7n7xVC0r\\+UpsGePEyg\\=\\={position:absolute;left:0;top:0;border-radius:50%;text-align:center;width:100%;height:100%;overflow:hidden}.AVxO7n7xVC0r\\+UpsGePEyg\\=\\={line-height:1!important;font-size:18px;margin-top:1px}.AVxO7n7xVC0r\\+UpsGePEyg\\=\\=:before{margin-top:.4em}',""]),t.locals={mePhotoContainer:"ohcfXYh6LUBy5DS5kNUjRQ==",mePhoto:"_8ZYZKvxC8bvw1xgQGSkvvA==",meInitials:"Mc+fiAdJTuKKS+yJLN3rDQ==",meInitialsThemed:"OLlo7WBYb7HJTGfGyVkiWQ==",meFlexPane:"Csa69b1duifKpk7Dd1dnYQ==",doughboy:"lMHKWNw+dCJnMDe9+woOeA==",headerDoughboy:"AVxO7n7xVC0r+UpsGePEyg=="}},78541:function(e,t,n){(t=e.exports=n(51904)(!1)).push([e.id,".\\/FzkYcX7qvnoEMaUtV922A\\=\\=,.hNRvTvwVOsDErxAdwaiZGQ\\=\\={-webkit-transform-origin:top;-ms-transform-origin:top;transform-origin:top;-webkit-animation-duration:.18s;animation-duration:.18s;-webkit-animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-timing-function:cubic-bezier(.1,.9,.2,1)}.MqP9cttxW\\/k6fP9KBfvJXw\\=\\=,.tqq1tl3OHof\\+9xOfBWUR4Q\\=\\={width:100%;height:8px;visibility:hidden;display:none}.tqq1tl3OHof\\+9xOfBWUR4Q\\=\\={background:transparent;cursor:pointer}.tqq1tl3OHof\\+9xOfBWUR4Q\\=\\=:hover{opacity:.4;background:#404040}.mYrlHvrSR57f9RgjZDapRg\\=\\={position:absolute;left:47.81%;right:47.81%;border-radius:6px;width:14px;height:2px;align-self:center;pointer-events:none}.DJNRezt7dApXIOSDqmGElw\\=\\={-webkit-animation-name:headerSlideInFrames;animation-name:headerSlideInFrames}.QU0CdgILUm0YoP\\+SCe437g\\=\\={-webkit-animation-name:headerSlideOutFrames;animation-name:headerSlideOutFrames}.ICSgbPvcuYIMYmjWDVZjyQ\\=\\={-webkit-animation-name:workloadDivSlideInFrames;animation-name:workloadDivSlideInFrames;animation-fill-mode:forwards}.psEYMGfctmMkbBQaQqGwDg\\=\\={-webkit-animation-name:workloadDivSlideOutFrames;animation-name:workloadDivSlideOutFrames;animation-fill-mode:forwards}@-webkit-keyframes headerSlideInFrames{0%{height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@keyframes headerSlideInFrames{0%{height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@-webkit-keyframes headerSlideOutFrames{0%{visibility:visible;display:flex;height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}to{visibility:hidden;display:none;height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}}@keyframes headerSlideOutFrames{0%{visibility:visible;display:flex;height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}to{visibility:hidden;display:none;height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}}@-webkit-keyframes workloadDivSlideInFrames{0%{height:8px;min-height:8px}to{height:48px;min-height:48px}}@keyframes workloadDivSlideInFrames{0%{height:8px;min-height:8px}to{height:48px;min-height:48px}}@-webkit-keyframes workloadDivSlideOutFrames{0%{height:48px;min-height:48px}to{height:8px;min-height:8px}}@keyframes workloadDivSlideOutFrames{0%{height:48px;min-height:48px}to{height:8px;min-height:8px}}",""]),t.locals={headerAnimations:"/FzkYcX7qvnoEMaUtV922A==",workloadDivAnimations:"hNRvTvwVOsDErxAdwaiZGQ==",shyHeader:"MqP9cttxW/k6fP9KBfvJXw==",shyHeaderOverlay:"tqq1tl3OHof+9xOfBWUR4Q==",shyHeaderGripper:"mYrlHvrSR57f9RgjZDapRg==",headerSlideIn:"DJNRezt7dApXIOSDqmGElw==",headerSlideOut:"QU0CdgILUm0YoP+SCe437g==",workloadDivSlideIn:"ICSgbPvcuYIMYmjWDVZjyQ==",workloadDivSlideOut:"psEYMGfctmMkbBQaQqGwDg=="}},25462:function(e,t,n){var a=n(13879);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(79128)(a,i);a.locals&&(e.exports=a.locals)},17750:function(e,t,n){var a=n(97027);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(79128)(a,i);a.locals&&(e.exports=a.locals)},13943:function(e,t,n){var a=n(40308);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(79128)(a,i);a.locals&&(e.exports=a.locals)},20002:function(e,t,n){var a=n(78541);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(79128)(a,i);a.locals&&(e.exports=a.locals)},74107:function(e,t,n){"use strict";var a;n.d(t,{J:function(){return a}}),function(e){e[e.OWA=1]="OWA",e[e.TokenFactory=3]="TokenFactory"}(a||(a={}))},917:function(e,t,n){"use strict";n.d(t,{T:function(){return I}});var a=n(16533);function i(e){let t=null;try{null!=sessionStorage&&(t=sessionStorage.getItem(e))}catch(e){}return t}var r=n(16968),o=n(87948),s=n(94190),l=n(50954),c=n(74107),u=n(83251),p=n(66873),d=n(88514),h=n(23653),m=n(27501),g=n(9522),S=n(7668),f=n(68105),y=n(83834),C=n(48314);class I{get appWebProxyUrl(){return g.buildUrl(this.url,this.iFrameSourceUrl)}get canExecuteNow(){return null!==document.body||I.sWindowLoadCalled}constructor(e,t,n,a=!1){if(g.validateField(t,"url",g.StringTypeString,!0),g.isNullOrEmptyString(t))throw g.createInvalidParameterException("url");if(t.indexOf("?")>=0)throw g.createInvalidParameterException("url");"/"===t.charAt(0)&&(t=g.buildUrl(g.getCurrentWindowLocation(),t)),g.validateFullUrl(t,"url"),t.charCodeAt(t.length-1)==="/".charCodeAt(0)&&(t=t.substr(0,t.length-1)),t=t.toLowerCase(),this.url=t,this.initializeEcsConfig(),g.getUrlDomainPart(t,!0)!==g.getUrlDomainPart(g.getCurrentWindowLocation(),!0)&&!a||window.IsO365ShellTestPage?this.mode=1:this.mode=0,this.formDigestHandlingEnabled=!1,this.iFrameSourceUrl=n,I.sIFrameInstanceCode[this.appWebProxyUrl]=e,window.addEventListener("unload",I.resetMessageListenerAttachedFlag)}initializeEcsConfig(){try{(0,l.l)().getConfig().then((e=>{e&&(this.oneShellECSConfig=e)}))}catch(e){(0,r.tZ)().exception("AppsManager_InitializeEcsConfig_Failed",6,e)}}executeAsync(e){return this.validateRequest(e,!1),this.executeValidatedRequestInternal(e)}executeCrossDomainRequestAsync(e,t=!1){return this.validateRequest(e,!0),this.executeValidatedRequestInternal(e,t)}ping(){return null!=I.sFramePinged&&I.sFramePinged[this.appWebProxyUrl]}registerOpxHost(e){this.executeOrQueueCrossDomainRequest(C.k.RegisterOpxHost,e)}executeOpxRequest(e){const t={requestObject:e};this.executeOrQueueCrossDomainRequest(C.k.OutgoingOpxMessage,t)}executeStorageRequest(e){if(1===this.mode)this.executeOrQueueCrossDomainRequest(C.k.Storage,e);else if(0===this.mode)try{const t=e.requestObject,n=t=>{const n={responseObject:t};I.fireDataWatchSentCallback(e),null!=e.success&&e.success(n),I.fireDataWatchReceivedCallbackGivenResponseInfo(e,n,0,"")};1===t.RequestType?(0,r.tZ)().tag("RequestExecutor_SuiteDataSharingDeprecated",6,-1018,m.pc):y.A.processRequest(t,n)}catch(t){null!=e.error&&e.error({},0,t.message),I.fireDataWatchReceivedCallbackGivenResponseInfo(e,{},t.errorCode||0,t.message)}}executeIdentityProviderRequest(e){1===this.mode&&this.executeOrQueueCrossDomainRequest(C.k.UserState,e)}executeSignalRRequest(e){this.validateRequest(e,!1),e.timeout=0,this.executeOrQueueCrossDomainRequest(C.k.SignalR,e)}setBeforeSendRequestAction(e){this.beforeSendRequest=e}prefetchOAuthAccessToken(e){p.p.Instance.configuration.EnableTokenDictionary?d.E.getToken(e).catch((t=>{1===t.responseType&&this.executeOrQueueCrossDomainRequest(C.k.TokenPrefetch,e)})):this.executeOrQueueCrossDomainRequest(C.k.TokenPrefetch,e)}getOwaUserConfiguration(e){this.executeOrQueueCrossDomainRequest(C.k.OwaUserConfig,e)}static internalProcessIFrameRequestTimeoutCallback(e){if(null===I.sPostMessageIdToRequestInfoMap)return;const t=I.sPostMessageIdToRequestInfoMap[e];null!=t&&(I.isCurrentSiteInTrustOrLocalZone()&&(0,r.tZ)().tag("RequestExecutor_IFrameLoadError",4,-1007,m.Ep),I.sPostMessageIdToRequestInfoMap[e]=null,delete I.sPostMessageIdToRequestInfoMap[e],g.reportSimpleError(t.requestInfo,-1001,m.Pr,"IFrameRequest"),(0,r.tZ)().serverRequest(t.command,t.requestInfo.method,I.sIFrameInstanceCode[t.appWebProxyUrl].toString(),t.requestInfo.url,-1001),I.fireDataWatchReceivedCallbackGivenResponseInfo(t.requestInfo,null,-1001,m.Pr))}validateRequest(e,t){if(g.validateRequestInfo(e),g.isFullUrl(e.url)){if(!t&&g.getUrlDomainPart(e.url,!0).toLowerCase()!==g.getUrlDomainPart(this.url,!0))throw g.createInvalidParameterException("requestInfo.url")}else e.url=g.buildUrl(this.url,e.url);(e.binaryStringRequestBody||e.binaryStringResponseBody)&&g.checkBrowserBinaryDataSupport()}executeValidatedRequestInternal(e,t=!1){return t?this.executeQueryDirect(e):1===this.mode?this.executeOrQueueCrossDomainRequest(C.k.Query,e):this.executeQueryDirect(e),e.postMessageId}executeQueryDirect(e){let t=g.buildUrl(this.url,"_api/contextinfo");t=g.encodeUrlForXmlHttpRequest(t),(0,r.tZ)().tag("RequestExecutor_ExecuteQueryDirect",1,e.timeout,`PostMessageId: ${e.postMessageId}, Url: ${e.url}, Method: ${e.method}`),I.ensureFormDigest(this.url,t,this.formDigestHandlingEnabled,e,((e,t)=>this.executeQueryUsingXMLHttpRequest(e,t)))}static ensureFormDigest(e,t,n,a,i){e=e.toLowerCase();const s=new Date;if(!n||"GET"===a.method.toUpperCase()||null!=I.sFormDigestExpirationCache[e]&&I.sFormDigestExpirationCache[e]>s.getTime())i(I.sFormDigestValueCache[e],a);else{const n=g.getXMLHttpRequest();n.open("POST",t),n.setRequestHeader("accept","application/json;odata=verbose");const s=Date.now();let l=0;a.timeout>0&&(l=window.setTimeout((()=>{n.onreadystatechange=()=>{};try{n.abort()}catch(e){}g.reportSimpleError(a,-1001,m.Pr,"ensureFormDigest"),(0,r.tZ)().serverRequest(C.k.Query,a.method,null,a.url,-1001,a.isTokenGeneratedFromWorkload)}),a.timeout)),n.onreadystatechange=()=>{if(4===n.readyState){const t=Date.now()-s;if(0!==l&&window.clearTimeout(l),n.onreadystatechange=()=>{},200!==n.status||null===n.getResponseHeader("content-type")||n.getResponseHeader("content-type").toLowerCase().indexOf("application/json")<0){const e=(0,o.JT)(m.Xs,n.status.toString(),n.getResponseHeader("content-type"));g.reportSimpleError(a,-1002,e),(0,r.tZ)().tag("RequestExecutor_UnexpectedResponse",6,-1002,n.status.toString(),n.getResponseHeader("content-type")),(0,r.tZ)().serverRequest(C.k.Query,a.method,null,a.url,-1002,a.isTokenGeneratedFromWorkload,t,g.getXMLHttpResponseLength(n))}else{const o=JSON.parse(n.responseText);if(null!=o){const s=o.d.GetContextWebInformation.FormDigestValue,l=o.d.GetContextWebInformation.FormDigestTimeoutSeconds,c=(new Date).getTime()+750*l;I.sFormDigestValueCache[e]=s,I.sFormDigestExpirationCache[e]=c,i(s,a),(0,r.tZ)().serverRequest(C.k.Query,a.method,null,a.url,n.status,a.isTokenGeneratedFromWorkload,t,g.getXMLHttpResponseLength(n))}else g.reportSimpleError(a,-1002,m.s5),(0,r.tZ)().tag("RequestExecutor_UnableToParseJson",6,-1002,m.s5,n.status.toString(),n.responseText),(0,r.tZ)().serverRequest(C.k.Query,a.method,null,a.url,-1002,a.isTokenGeneratedFromWorkload,t,g.getXMLHttpResponseLength(n))}}},n.send("")}}executeOrQueueCrossDomainRequest(e,t){s.isBrowserIE()&&I.sIFrameInstanceCode[this.appWebProxyUrl]===c.J.TokenFactory||(I.sMessageListenerAttached=!!I.sMessageListenerAttached||g.ensureAttachMessageListener(I.internalOnMessage),I.fireDataWatchSentCallback(t),t.postMessageId=I.getPostMessageId(),(0,r.tZ)().tag("RequestExecutor_ExecuteOrQueueCrossDomainRequest",1,t.timeout,`Command: ${e}, PostMessageId: ${t.postMessageId}, Url: ${t.url}`),this.canExecuteNow?this.executeCommandByIFrame(e,this.appWebProxyUrl,t):I.addToRequestExecutorQueue(this,t))}executeCommandByIFrame(e,t,n){const a={command:e,postMessageId:n.postMessageId,appWebProxyUrl:t,requestInfo:n,timeoutId:null};let i=I.sPendingRequestInfo[t];null==i&&(i=[],I.sPendingRequestInfo[t]=i),I.sPostMessageIdToRequestInfoMap[a.postMessageId]=a,a.requestInfo.timeout>0&&(a.timeoutId=window.setTimeout((()=>I.internalProcessIFrameRequestTimeoutCallback(a.postMessageId)),a.requestInfo.timeout));let r=g.getFrameElement(I.sIFrameInstanceCode[t]);null!=r?I.sFrameLoaded[t]&&I.sFramePinged[t]?I.sendPostMessage(a):i.push(a):(i.push(a),r=I.createIFrame(t))}static createIFrame(e){const t=I.sIFrameInstanceCode[e],n=g.getFrameID(t);switch(t){case c.J.OWA:(0,r.tZ)().perfMarker("OwaIframeLoadStarted");break;case c.J.TokenFactory:(0,r.tZ)().perfMarker("TokenFactoryIframeLoadStarted")}const a=document.createElement("iframe");a.src=e,a.id=n,a.name=n,a.style.display="none",a.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms");a.addEventListener("load",(()=>{I.internalProcessIFrameOnload(e)})),document.body.appendChild(a);const i=window.setTimeout((()=>{delete I.sFrameLoadTimeoutId[e],I.processPingTimeoutOrIFrameLoadTimeout(e)}),this.IFrameLoadTimeout);return I.sFrameLoadTimeoutId[e]=i,a}executeQueryUsingXMLHttpRequest(e,t){var n,i,o;const s=g.getXMLHttpRequest(),l=g.encodeUrlForXmlHttpRequest(t.url),c=null!==(i=null===(n=this.oneShellECSConfig)||void 0===n?void 0:n.MaxRetriesForXMLRequest)&&void 0!==i?i:I.DefaultMaxRetries;s.open(t.method,l);let u=!1;if(t.maxRetries=c,null!=t.headers)for(const e of Object.keys(t.headers))null!=e&&(s.setRequestHeader(e,t.headers[e]),"x-requestdigest"===e.toLowerCase()&&(u=!0));u||null==e||s.setRequestHeader("X-RequestDigest",e),t.binaryStringResponseBody&&(s.responseType="arraybuffer");let d=0;t.timeout>0&&(d=window.setTimeout((()=>this.internalProcessXMLHttpRequestTimeoutCallback(s,t)),t.timeout)),s.onreadystatechange=()=>this.internalProcessXMLHttpRequestOnreadystatechange(s,t,d);let h=t.body;if(t.binaryStringRequestBody&&(h=g.convertBinaryStringToXmlHttpRequestBody(t.body)),null!=this.beforeSendRequest&&this.beforeSendRequest(s,null,null),!f.B.isAllowedApi(l)&&!p.p.Instance.configuration.EnableTokenDictionary)return g.reportSimpleError(t,-1009,m.iZ),void(0,r.tZ)().serverRequest(C.k.Query,t.method,null,l,-1009);if(null===(o=this.oneShellECSConfig)||void 0===o?void 0:o.SendLoggingForRequestInfo){const{headers:e}=t,n=(0,a.__rest)(t,["headers"]);(0,r.tZ)().tag("RequestExecutor_SendData",1,JSON.stringify(n))}I.fireDataWatchSentCallback(t),(0,r.tZ)().tag("RequestExecutor_ExecuteQueryUsingXMLHttpRequest",1,t.timeout,`PostMessageId: ${t.postMessageId}, Url: ${l}, Method: ${t.method}`),t.requestSentTime=Date.now(),s.send(h)}static sendPostMessage(e){g.validateField(e.postMessageId,"requestInfo.postMessageId",g.StringTypeString,!0),g.validateField(e.appWebProxyUrl,"requestInfo.appWebProxyUrl",g.StringTypeString,!0);const t=g.getFrameElement(I.sIFrameInstanceCode[e.appWebProxyUrl]);if(null==t)throw(0,r.tZ)().tag("RequestExecutor_IFrameNull",6,-2002,m.fo,e.appWebProxyUrl),new h.K(m.fo,-2002);null==I.sPostMessageIdToRequestInfoMap&&(I.sPostMessageIdToRequestInfoMap={}),I.sPostMessageIdToRequestInfoMap[e.postMessageId]=e;const n={command:e.command,url:e.requestInfo.url,resource:e.requestInfo.resource,method:e.requestInfo.method,body:e.requestInfo.body,headers:e.requestInfo.headers,postMessageId:e.postMessageId,timeout:e.requestInfo.timeout,binaryStringRequestBody:e.requestInfo.binaryStringRequestBody,binaryStringResponseBody:e.requestInfo.binaryStringResponseBody,requestObject:e.requestInfo.requestObject,getPerformanceTrace:e.requestInfo.getPerformanceTrace},a=JSON.stringify(n),i=e.appWebProxyUrl;e.requestInfo.requestSentTime=Date.now(),p.p.isUnitTestMode||t.contentWindow.postMessage(a,i)}static getPostMessageId(){return I.sPostMessageIdCount++,g.PostMessageIdPrefix+I.sPostMessageIdCount.toString()}static internalProcessWindowLoad(){I.sWindowLoadCalled=!0;const e=I.sRequestExecutorQueue;I.sRequestExecutorQueue=null;const t=I.sRequestExecutorParameterQueue;if(I.sRequestExecutorParameterQueue=null,null!==e)for(let n=0;n<e.length;n++)e[n].executeAsync(t[n])}static resetMessageListenerAttachedFlag(){I.sMessageListenerAttached=!1}static internalProcessIFrameOnload(e){I.sFrameLoaded[e]=!0,null!=I.sFrameLoadTimeoutId[e]&&(window.clearTimeout(I.sFrameLoadTimeoutId[e]),delete I.sFrameLoadTimeoutId[e]),g.ensureAttachMessageListener(I.internalOnMessage),null!=I.sFramePingTimeoutId[e]&&(window.clearTimeout(I.sFramePingTimeoutId[e]),delete I.sFramePingTimeoutId[e]);const t={requestObject:{upn:p.p.Instance.configuration.CurrentUserUpn,puid:p.p.Instance.configuration.CurrentUserPuid,shellConfig:{enableOpx:p.p.Instance.configuration.OpxEnabled}}},n=i("shellver");n&&window.O365ShellBootInfo&&(t.requestObject.overrideRequest=g.buildIframeResourceData(n,window.O365ShellBootInfo));const a={command:C.k.Ping,postMessageId:I.getPostMessageId(),appWebProxyUrl:e,timeoutId:-1,requestInfo:t};I.sPostMessageIdToRequestInfoMap[a.postMessageId]=a;const r=window.setTimeout((()=>{delete I.sFrameLoadTimeoutId[e],I.processPingTimeout(a.postMessageId,e)}),I.IFramePingTimeout);a.timeoutId=r,p.p.isUnitTestMode||(I.sFramePingTimeoutId[e]=r),I.sendPostMessage(a)}static internalOnMessage(e){if(null==e)return;const t=e.origin,n=e.data;if(null!=t&&""!==t&&null!=n&&""!==n)try{const e=JSON.parse(n);I.isPostMessageResponseInfo(e)&&I.onResponseMessageReceived(t,e)}catch(e){}}static isPostMessageResponseInfo(e){const t=e;return null!=t.postMessageId&&null!=t.command}static onResponseMessageReceived(e,t){const n=Date.now();if(null==I.sPostMessageIdToRequestInfoMap)return;if(null==t.postMessageId)return;const a=I.sPostMessageIdToRequestInfoMap[t.postMessageId];if(null==a)return;const i=g.getUrlDomainPart(e,!0),o=g.getUrlDomainPart(a.appWebProxyUrl,!0);if(i.toLowerCase()!==o.toLowerCase())return;const s=t.postMessageId,l=n-a.requestInfo.requestSentTime,c=t.command===C.k.Query&&0===t.errorCode&&3===t.readyState,u=t.command===C.k.Notification&&null==t.errorMessage;if(c||u||(delete I.sPostMessageIdToRequestInfoMap[s],null!=a.timeoutId&&(window.clearTimeout(a.timeoutId),a.timeoutId=0,delete a.timeoutId)),t.command===C.k.Ping)I.processPingMessage(a.appWebProxyUrl,t),I.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(a.requestInfo,t),(0,r.tZ)().serverRequest(a.command,a.requestInfo.method,I.sIFrameInstanceCode[a.appWebProxyUrl].toString(),g.getUrlDomainPart(a.appWebProxyUrl),0===t.errorCode?200:t.errorCode,a.requestInfo.isTokenGeneratedFromWorkload,l,t.responseText?t.responseText.length:0);else if(t.command===C.k.Query){const e={responseAvailable:t.responseAvailable,body:t.responseText||"",statusCode:t.statusCode,statusText:t.statusText,contentType:t.contentType,state:a.requestInfo.state,allResponseHeaders:t.allResponseHeaders,headers:g.parseResponseHeaders(t.allResponseHeaders),binaryStringResponseBody:t.binaryStringResponseBody};let n=0,i=null;0!==t.errorCode?(n=t.errorCode,i=t.errorMessage):t.statusCode>=200&&t.statusCode<300||1223===t.statusCode||(n=-1003,i=t.statusCode),0===n?4===t.readyState?(e.performanceTrace=t.performanceTrace,null!=a.requestInfo.success&&a.requestInfo.success(e),I.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,e,0,null),(0,r.tZ)().serverRequest(a.command,a.requestInfo.method,I.sIFrameInstanceCode[a.appWebProxyUrl].toString(),a.requestInfo.url,t.statusCode,a.requestInfo.isTokenGeneratedFromWorkload,l,t.responseText?t.responseText.length:0)):3===t.readyState&&null!=a.requestInfo.loading&&a.requestInfo.loading(e):4!==t.readyState&&0!==t.readyState&&null!=t.readyState||(e.performanceTrace=t.performanceTrace,null!=a.requestInfo.error&&a.requestInfo.error(e,n,i),(0,r.tZ)().tag("RequestExecutor_IFrameError",4,n,i),I.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,e,n,i),(0,r.tZ)().serverRequest(a.command,a.requestInfo.method,I.sIFrameInstanceCode[a.appWebProxyUrl].toString(),a.requestInfo.url,n,a.requestInfo.isTokenGeneratedFromWorkload,l,t.responseText?t.responseText.length:0))}else if(t.command===C.k.Storage||t.command===C.k.TokenPrefetch||t.command===C.k.OwaUserConfig){const e={responseObject:t.responseObject},n=t.errorCode,i=t.errorMessage;0===n&&g.isNullOrEmptyString(i)?(null!=a.requestInfo.success&&a.requestInfo.success(e),I.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,e,0,null)):(null!=a.requestInfo.error&&a.requestInfo.error(e,n,i),I.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,e,n,i)),(0,r.tZ)().serverRequest(a.command,a.requestInfo.method,I.sIFrameInstanceCode[a.appWebProxyUrl].toString(),a.requestInfo.url,0!==n?n:200,a.requestInfo.isTokenGeneratedFromWorkload,l,t.responseText?t.responseText.length:0)}else t.command===C.k.Notification?(0!==t.errorCode&&null!=a.requestInfo.error&&a.requestInfo.error({responseObject:t.responseObject},t.errorCode,t.errorMessage),I.NotificationCallback(JSON.stringify(t.responseObject)),I.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(a.requestInfo,t)):t.command===C.k.RegisterOpxHost&&null!=a.requestInfo.success&&a.requestInfo.success(null)}internalProcessXMLHttpRequestTimeoutCallback(e,t){var n;e.onreadystatechange=()=>{};try{e.abort()}catch(e){}if(I.shouldRetryRequest(t,0,-1001))return(0,r.tZ)().tag("RequestExecutor_RetryingTimeout",4,"Request timeout. Retrying request.",t.url,`Attempt ${(null!==(n=t.retryCount)&&void 0!==n?n:0)+1}/${I.getMaxRetries(t)}`),void this.retryXMLHttpRequest(t);g.reportSimpleError(t,-1001,m.Pr,"XMLHttpRequest"),(0,r.tZ)().tag("RequestExecutor_RequestAbortedOrTimedout",6,t.timeout,t.requestSentTime,t.dataRequestId,t.getPerformanceTrace,t.url,-1001),(0,r.tZ)().serverRequest(C.k.Query,t.method,null,t.url,-1001),I.fireDataWatchReceivedCallbackGivenResponseInfo(t,null,-1001,m.Pr)}internalProcessXMLHttpRequestOnreadystatechange(e,t,n){var a;if(4===e.readyState){const i=Date.now();0!==n&&window.clearTimeout(n),e.onreadystatechange=()=>{};const o={state:t.state,responseAvailable:!0,body:t.binaryStringResponseBody?g.convertArrayBufferToBinaryString(e.response):e.responseText,statusCode:e.status,statusText:e.statusText,contentType:e.getResponseHeader("content-type"),allResponseHeaders:e.getAllResponseHeaders(),headers:g.parseResponseHeaders(e.getAllResponseHeaders()),performanceTrace:null},s=i-t.requestSentTime;if(t.getPerformanceTrace){const e=performance.getEntriesByName(t.url);null!=e&&e.length>0&&(o.performanceTrace=e[0])}if(e.status>=200&&e.status<300||1223===e.status)null!=t.success&&t.success(o),I.fireDataWatchReceivedCallbackGivenResponseInfo(t,o,0,null),(0,r.tZ)().serverRequest(C.k.Query,t.method,null,t.url,o.statusCode,t.isTokenGeneratedFromWorkload,s,g.getXMLHttpResponseLength(e));else{if(I.shouldRetryRequest(t,e.status,-1003))return(0,r.tZ)().tag("RequestExecutor_RetryingHttpError",4,`HTTP Error ${e.status} - ${e.statusText}. Retrying request.`,t.url,`Attempt ${(null!==(a=t.retryCount)&&void 0!==a?a:0)+1}/${I.getMaxRetries(t)}`),void this.retryXMLHttpRequest(t);(window.navigator&&"boolean"==typeof window.navigator.onLine&&!window.navigator.onLine||0===e.status)&&null!=t.error?t.error(o,-1019,m.sP):null!=t.error&&t.error(o,-1003,e.statusText),I.fireDataWatchReceivedCallbackGivenResponseInfo(t,o,-1003,e.statusText),(0,r.tZ)().serverRequest(C.k.Query,t.method,null,t.url,e.status,t.isTokenGeneratedFromWorkload,s,g.getXMLHttpResponseLength(e))}}}static isCurrentSiteInTrustOrLocalZone(){if(!I.isTrustedSiteEvaluated){if(s.isBrowserIE()){const e=window.status,t=window.status+(new Date).getTime();window.status=t,I.isTrustedSite=window.status===t,window.status=e}I.isTrustedSiteEvaluated=!0}return I.isTrustedSite}static processPingTimeout(e,t){null!=I.sPostMessageIdToRequestInfoMap[e]&&(I.sFramePinged[t]||((0,r.tZ)().tag("PingTimeout",0,I.sIFrameInstanceCode[t].toString()),I.sPostMessageIdToRequestInfoMap[e]=null,delete I.sPostMessageIdToRequestInfoMap[e],I.processPingTimeoutOrIFrameLoadTimeout(t)))}static processPingTimeoutOrIFrameLoadTimeout(e){switch(I.sIFrameInstanceCode[e]){case c.J.OWA:(0,r.tZ)().perfMarker("OwaIframeLoadFailed");break;case c.J.TokenFactory:(0,r.tZ)().perfMarker("TokenFactoryIframeLoadFailed")}const t=g.getUrlDomainPart(e,!0);if(t.toLowerCase()===g.getUrlDomainPart(p.p.Instance.configuration.SuiteServiceUrl,!0)){const e=I.isCurrentSiteInTrustOrLocalZone()?S.I.SecurityZoneMismatched:S.I.IframeLoadError;u.k.Instance.blockSuiteServiceCalls(e,t)}const n=(0,o.JT)(m.D8,t);I.reportFrameLoadError(e,n)}static reportFrameLoadError(e,t,n=-1007){I.sFrameLoadError[e]=!0;const a=I.sPendingRequestInfo[e];I.sPendingRequestInfo[e]=[];let i=!1;if(i=I.isTrustedSiteEvaluated?I.isTrustedSite:I.isCurrentSiteInTrustOrLocalZone(),(0,r.tZ)().tag("RequestExecutor_IFrameLoadError",4,n,t,"isTrustedSite: "+i),null!=I.sFrameLoadTimeoutId[e]&&(window.clearTimeout(I.sFrameLoadTimeoutId[e]),delete I.sFrameLoadTimeoutId[e]),I.removeIFrame(e),null!=a)for(const i of a){const a=i.postMessageId;null!=I.sPostMessageIdToRequestInfoMap[a]&&(I.sPostMessageIdToRequestInfoMap[a]=null,delete I.sPostMessageIdToRequestInfoMap[a],null!=i.timeoutId&&window.clearTimeout(i.timeoutId),g.reportSimpleError(i.requestInfo,n,t),(0,r.tZ)().serverRequest(i.command,i.requestInfo.method,I.sIFrameInstanceCode[e].toString(),i.requestInfo.url,-1007))}}static removeIFrame(e){const t=g.getFrameElement(I.sIFrameInstanceCode[e]);null!=t&&null!=t.parentNode&&t.parentNode.removeChild(t),null!=I.sPendingRequestInfo&&delete I.sPendingRequestInfo[e],null!=I.sFrameLoadTimeoutId&&delete I.sFrameLoadTimeoutId[e],null!=I.sFrameLoaded&&delete I.sFrameLoaded[e],null!=I.sFramePinged&&delete I.sFramePinged[e],null!=I.sFramePingTimeoutId&&delete I.sFramePingTimeoutId[e],null!=I.sFrameLoadError&&delete I.sFrameLoadError[e]}static processPingMessage(e,t){switch(I.sIFrameInstanceCode[e]){case c.J.OWA:(0,r.tZ)().perfMarker("OwaIframeLoadCompleted");break;case c.J.TokenFactory:(0,r.tZ)().perfMarker("TokenFactoryIframeLoadCompleted")}if(t.errorCode&&0!==t.errorCode)return void I.reportFrameLoadError(e,t.errorMessage,t.errorCode);I.sFramePinged[e]=!0;const n=I.sPendingRequestInfo[e];if(null!=n){I.sPendingRequestInfo[e]=[];for(const e of n)null!=I.sPostMessageIdToRequestInfoMap[e.postMessageId]&&I.sendPostMessage(e)}}static addToRequestExecutorQueue(e,t){null===I.sRequestExecutorQueue&&(I.sRequestExecutorQueue=[]),null===I.sRequestExecutorParameterQueue&&(I.sRequestExecutorParameterQueue=[]),I.sRequestExecutorQueue.push(e),I.sRequestExecutorParameterQueue.push(t)}static fireDataWatchSentCallback(e){null!==I.DataWatchSentCallback&&(I.DataWatchRequestId++,e.dataRequestId=I.DataWatchRequestId,I.DataWatchSentCallback(I.DataWatchRequestId,e))}static fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(e,t){if(null==I.DataWatchReceivedCallback)return;const n={body:t.responseText,responseAvailable:t.responseAvailable,statusCode:t.statusCode,statusText:t.statusText,contentType:t.contentType,allResponseHeaders:t.allResponseHeaders,headers:g.parseResponseHeaders(t.allResponseHeaders),binaryStringResponseBody:t.binaryStringResponseBody,responseObject:t.responseObject,state:e.state,performanceTrace:t.performanceTrace};I.fireDataWatchReceivedCallbackGivenResponseInfo(e,n,t.errorCode,t.errorMessage)}static fireDataWatchReceivedCallbackGivenResponseInfo(e,t,n,a){null!==I.DataWatchReceivedCallback&&null!=e.dataRequestId&&I.DataWatchReceivedCallback(e.dataRequestId,t,n,a)}static shouldRetryRequest(e,t,n){var a,i,r;const o=I.getMaxRetries(e),s=null!==(a=e.retryCount)&&void 0!==a?a:0,l=null!==(i=e.retryStatusCodes)&&void 0!==i?i:I.DefaultRetryStatusCodes,c=null!==(r=e.retryOnTimeout)&&void 0!==r?r:I.DefaultRetryOnTimeout;return!(s>=o)&&(!(-1001!==n||!c)||!(-1003!==n||!l.includes(t)))}static getRetryDelay(e){var t,n;const a=null!==(t=e.retryDelay)&&void 0!==t?t:I.DefaultRetryDelay,i=null!==(n=e.retryCount)&&void 0!==n?n:1;return a*Math.pow(2,i-1)}static getMaxRetries(e){var t;return e&&null!==(t=null==e?void 0:e.maxRetries)&&void 0!==t?t:I.DefaultMaxRetries}retryXMLHttpRequest(e){var t;e.retryCount=(null!==(t=e.retryCount)&&void 0!==t?t:0)+1;const n=I.getRetryDelay(e);(0,r.tZ)().tag("RequestExecutor_RetryXMLHttpRequest",1,`Retrying XMLHttpRequest after ${n}ms. Attempt ${e.retryCount}/${I.getMaxRetries(e)}`,e.url),window.setTimeout((()=>{this.executeQueryDirect(e)}),n)}}I.DefaultTimeout=6e4,I.DefaultTimeoutHigh=12e4,I.IFrameLoadTimeout=3e4,I.IFramePingTimeout=3e4,I.DefaultMaxRetries=3,I.DefaultRetryDelay=500,I.DefaultRetryStatusCodes=[408,429,500,502,503,504,0],I.DefaultRetryOnTimeout=!0,I.sPendingRequestInfo={},I.sFrameLoaded={},I.sFramePinged={},I.sFramePingTimeoutId={},I.sFrameLoadTimeoutId={},I.sFrameLoadError={},I.sPostMessageIdToRequestInfoMap={},I.sIFrameInstanceCode={},I.sFormDigestValueCache={},I.sFormDigestExpirationCache={},I.sPostMessageIdCount=0,I.sWindowLoadCalled=!1,I.sRequestExecutorQueue=[],I.sRequestExecutorParameterQueue=[],I.DataWatchSentCallback=null,I.DataWatchRequestId=0,I.DataWatchReceivedCallback=null},37171:function(e,t,n){"use strict";n.d(t,{b6:function(){return c}});var a=n(87948),i=n(68105),r=n(74107),o=n(917),s=n(66873);const l="SuiteServiceProxy.aspx";class c{static get OwaInstance(){return null==c.suiteSvcInstance?c.createOwaRequestExecutor():c.suiteSvcInstance}static get OauthTokenFactoryInstance(){return null==c.tokenFactoryInstance?c.createOauthTokenFactoryRequestExecutor():c.tokenFactoryInstance}static setOauthTokenFactoryInstanceForTesting(e){s.p.isUnitTestMode&&(c.tokenFactoryInstance=e)}static resetAllInstancesForTesting(){c.tokenFactoryInstance=null,c.suiteSvcInstance=null}static createOauthTokenFactoryRequestExecutor(){if(s.p.assertInitialized(),null!=s.p.Instance.configuration.TokenFactoryIframeOrigin){let e=(0,a.JT)("{0}//{1}",window.location.protocol,window.location.host),t=(0,a.JT)(c.TokenFactoryIframePath,encodeURIComponent(e),encodeURIComponent(s.p.Instance.configuration.ShellSID),encodeURIComponent(c.TokenFactoryIframeApiVersion),encodeURIComponent(s.p.Instance.configuration.ClientShellVersion));t+=`&upn=${encodeURIComponent(s.p.Instance.configuration.CurrentUserUpn)}`;let n="https://consumer.suite.office.com"===s.p.Instance.configuration.TokenFactoryIframeOrigin;c.tokenFactoryInstance=new o.T(r.J.TokenFactory,s.p.Instance.configuration.TokenFactoryIframeOrigin,t,n)}return c.tokenFactoryInstance}static createOwaRequestExecutor(){if(s.p.assertInitialized(),null!=s.p.Instance.suiteServiceHostPageBaseUrl&&s.p.Instance.configuration.UserHasExchangeLicense){let e;e=s.p.Instance.configuration.HintUserName?(0,a.JT)("{0}?suiteServiceUserName={1}&{2}={3}&{4}",l,encodeURIComponent(s.p.Instance.configuration.CurrentUserUpn),c.SuiteServiceReturnUrlParam,encodeURIComponent(window.location.href),c.SuiteServiceProxyIframeApiVersion):(0,a.JT)("{0}?{1}={2}&{3}",l,c.SuiteServiceReturnUrlParam,encodeURIComponent(window.location.href),c.SuiteServiceProxyIframeApiVersion),c.suiteSvcInstance=new o.T(r.J.OWA,s.p.Instance.suiteServiceHostPageBaseUrl,e),c.suiteSvcInstance.setBeforeSendRequestAction(i.B.onBeforeSendRequestSuiteService)}return c.suiteSvcInstance}}c.TokenFactoryIframePath="/iframe/TokenFactoryIframe?origin={0}&shsid={1}&apiver={2}&cshver={3}",c.TokenFactoryIframeApiVersion="oneshell",c.SuiteServiceProxyIframeApiVersion="apiver=1",c.SuiteServiceReturnUrlParam="suiteServiceReturnUrl"},83251:function(e,t,n){"use strict";n.d(t,{k:function(){return y}});var a=n(16968),i=n(87894),r=n(87948),o=n(66873),s=n(23653),l=n(7668),c=n(3709);class u{constructor(e){this.service=e,this.NumMinutesToADReplication=2}setTargetServerReceivedTime(e){if(!o.p.isUnitTestMode)throw new s.W("Operation not allowed if it is not a unit test",-2002);this.targetServerReceivedTime=e}beforeSuiteServiceCall(e){if(null!=this.targetServer){(new Date).getTime()-this.targetServerReceivedTime.getTime()<=60*this.NumMinutesToADReplication*1e3&&(e[u.TargetServerHeader]=this.targetServer)}}afterSuiteServiceSuccess(e){null==this.targetServer&&null!=e[u.TargetServerHeader]&&(this.targetServer=e[u.TargetServerHeader],this.targetServerReceivedTime=new Date)}afterSuiteServiceError(e,t){null!=e[y.XSuiteError]&&e[y.XSuiteError]===u.ShardNotFoundException?(this.service.blockSuiteServiceCalls(l.I.ShardNotDetected),t(c.convertErrorToException(null,-1010,l.I.ShardNotDetected.toString()))):t(e)}}u.TargetServerHeader="X-TARGETSERVER",u.ShardNotFoundException="InvalidOrUnavailableMailboxException";var p=n(9522);class d{constructor(){this.handleMessage=e=>{let t=!1;if(null!=e)for(let n=0;!t&&n<this.handlers.length;n++)if(e&&e.data&&e.origin){let a=this.handlers[n];if(a.validateOrigin(e.origin)){let n=e.data;a.validateMessage(n)&&(t=a.handleMessage(n))}}},this.handlers=[],(0,p.ensureAttachMessageListener)(this.handleMessage)}registerHandler(e){this.handlers.push(e)}}var h=n(917),m=n(37171),g=n(88514),S=n(44954);class f{constructor(e,t,n){this.RequestExecutor=e,this.RequestInfo=t,this.ErrorCallback=n}}class y{constructor(){this.firstDataRequestSent=!1,this.startupCallbacks=[],this.owsStartupActionCompleted=!1,this.queuedCalls=[],this.messageDispatcher=new d}static get Instance(){return this.instance}get ConnectionEstablished(){return this.owsStartupActionCompleted}get AreSuiteServiceCallsBlocked(){return null!=this.suiteServiceCallsBlockedReason}get ShouldQueueOwsCalls(){return!this.owsStartupActionCompleted&&!o.p.Instance.configuration.IsOwa}registerPostMessageHandler(e){this.messageDispatcher.registerHandler(e)}setStartupActionCompleted(){this.owsStartupActionCompleted=!0;for(const e of this.queuedCalls)try{e.RequestExecutor.executeAsync(e.RequestInfo)}catch(e){}this.queuedCalls=[],this.callStartupCallbacks()}static setInstanceForTesting(e){o.p.isUnitTestMode&&(this.instance=e)}callOwaIframeAction(e,t,n=!0){return this.callOwaIframeActionWithAdditionalHeaders(e,t,null,n)}callOwaIframeResourceUrl(e,t,n){return new Promise(((a,r)=>{i.throwOnNullOrEmpty(e,"resourceUrl"),i.throwOnUndefined(n,"method"),null!==this.owaCallsInterceptor||o.p.Instance.configuration.UserHasExchangeLicense||(this.owaCallsInterceptor=new u(this)),n===S.o.PUT&&i.throwOnUndefined(t,"data");const s={};null!==o.p.Instance.configuration.CurrentUserUpn&&(s[y.UPNAnchorMailboxHeaderKey]=o.p.Instance.configuration.CurrentUserUpn);const l=o.p.Instance.configuration.SuiteServiceUrl.replace(p.OwsRelativePath,e);null!=this.owaCallsInterceptor&&this.owaCallsInterceptor.beforeSuiteServiceCall(s);let c=r;null!=this.owaCallsInterceptor&&(c=e=>{this.owaCallsInterceptor.afterSuiteServiceError(e,r)}),this.callOwaIframeWithOrWithoutRetry(l,s,t,n).then((e=>a(""!==e?JSON.parse(e):""))).catch(c)}))}callOwaIframeActionWithAdditionalHeaders(e,t,n,a=!0){return new Promise(((s,l)=>{i.throwOnNullOrEmpty(e,"action"),i.throwOnUndefined(t,"data");const c=o.p.Instance.configuration.SuiteServiceUrl,u="suiteservice.svc",p=-1!==c.toLowerCase().indexOf(u,c.length-16)?"{0}/?action={1}":"{0}?action={1}",d=this.isUserInitiatedCall(e)?e:e+"&UA=0",h=(0,r.JT)(p,c,d);null===n&&(n={}),n[y.ActionHeaderKey]=e,this.callOwaIframeWithOrWithoutRetry(h,n,t,S.o.POST,a).then((e=>s(""!==e?JSON.parse(e):""))).catch(l)}))}prefetchAccessToken(e,t=null){const n={url:e,resource:t};return new Promise(((e,t)=>{n.error=(e,n,a)=>{t(c.convertErrorToException(e,n,a))},n.success=t=>e(t);const a=m.b6.OauthTokenFactoryInstance;null!=a&&a.prefetchOAuthAccessToken(n)}))}registerOpxHost(e,t,n=h.T.DefaultTimeout){return new Promise(((a,i)=>{const r={resource:e,url:t,error:(e,t,n)=>{i(c.convertErrorToException(e,t,n))},success:e=>{a()},timeout:n},o=m.b6.OauthTokenFactoryInstance;null==o?i(new s.W("OauthTokenFactoryIframe",-1011)):o.registerOpxHost(r)}))}callOpxIframe(e){const t=m.b6.OauthTokenFactoryInstance;if(null==t)throw new s.W("OauthTokenFactoryIframe",-1011);t.executeOpxRequest(e)}callEndpointWithOauthToken(e,t){return new Promise(((n,i)=>{(0,a.tZ)().tag("Service_CallEndpointWithOauthToken_Start",1,e.url,`Method: ${e.method}, Resource: ${e.resource}, ReturnFullResponse: ${t}`),null==e.body&&(e.body=""),null==e.method&&(e.method="GET"),null==e.headers&&(e.headers={}),e.resource===o.p.Instance.configuration.TokenFactoryIframeOrigin&&(e.headers["x-o365suiteuxshell-workloadid"]=o.p.Instance.configuration.WorkloadId,(0,a.tZ)().tag("Service_CallEndpointWithOauthToken_AddWorkloadHeader",1,e.url,`WorkloadId: ${o.p.Instance.configuration.WorkloadId}`)),e.success=r=>{try{let i;(0,a.tZ)().tag("Service_CallEndpointWithOauthToken_Success",1,e.url,`StatusCode: ${r.statusCode}, ContentType: ${r.contentType}`),i=null!=r.contentType&&r.contentType.indexOf("application/json")>-1?t?r:JSON.parse(r.body):t?r:r.body,n(i)}catch(t){return(0,a.tZ)().tag("Service_CallEndpointWithOauthToken_ParseError",6,e.url,`Error: ${t instanceof Error?t.message:t}`),void i(new s.W("Invalid response format."))}},e.error=(t,n,r)=>{(0,a.tZ)().tag("Service_CallEndpointWithOauthToken_Error",6,e.url,`ErrorCode: ${n}, ErrorMessage: ${r}, StatusCode: ${null==t?void 0:t.statusCode}`),i(c.convertErrorToException(t,n,r))};const r=m.b6.OauthTokenFactoryInstance;if(null==r)return(0,a.tZ)().tag("Service_CallEndpointWithOauthToken_NoExecutor",6,e.url,"Could not create RequestExecutor"),void i(new s.W("OauthTokenFactoryIframe",-1011));(0,a.tZ)().tag("Service_CallEndpointWithOauthToken_TokenDictionary",1,e.url,`EnableTokenDictionary: ${o.p.Instance.configuration.EnableTokenDictionary}, ExecutorMode: ${r.mode}`),o.p.Instance.configuration.EnableTokenDictionary||0===r.mode?g.E.getToken(e).then((t=>{0===t.responseType&&((0,a.tZ)().tag("Service_CallEndpointWithOauthToken_TokenSuccess",1,e.url,"Token retrieved successfully"),e.headers.Authorization="Bearer "+t.token,null!=o.p.Instance.configuration.ServiceWorkerCacheId&&null!=o.p.Instance.configuration.ServiceWorkerCacheId&&(e.headers["X-SW-OHP-UserCacheId"]=o.p.Instance.configuration.ServiceWorkerCacheId,e.headers["X-SW-OHP-FetchStrategy"]=o.p.Instance.configuration.ServiceWorkerFetchStrategy,(0,a.tZ)().tag("Service_CallEndpointWithOauthToken_ServiceWorkerHeaders",1,e.url,`CacheId: ${o.p.Instance.configuration.ServiceWorkerCacheId}, FetchStrategy: ${o.p.Instance.configuration.ServiceWorkerFetchStrategy}`)),e.isTokenGeneratedFromWorkload=!0,delete e.headers["x-o365suiteuxshell-workloadid"],(0,a.tZ)().tag("Service_CallEndpointWithOauthToken_ExecuteWithToken",1,e.url,"Executing cross domain request with token"),r.executeCrossDomainRequestAsync(e,!0))})).catch((t=>{(0,a.tZ)().tag("Service_CallEndpointWithOauthToken_TokenError",4,e.url,`TokenResponseType: ${t.responseType}`),1===t.responseType&&((0,a.tZ)().tag("Service_CallEndpointWithOauthToken_ExecuteWithoutToken",1,e.url,"Executing cross domain request without token"),r.executeCrossDomainRequestAsync(e))})):((0,a.tZ)().tag("Service_CallEndpointWithOauthToken_DirectExecute",1,e.url,"Executing cross domain request directly without token dictionary"),r.executeCrossDomainRequestAsync(e))}))}callWebClientShellServiceFunction(e,t,n,a,i){const s=(0,r.JT)("{0}/{1}",o.p.Instance.configuration.TokenFactoryIframeOrigin,"/"===e.charAt(0)?e.substr(1):e);null==n&&(n={}),"Content-Type"in n||(n["Content-Type"]="application/json;charset=UTF-8"),"Accept"in n||(n.Accept="application/json");const l={method:t,url:s,resource:o.p.Instance.configuration.TokenFactoryIframeOrigin,body:JSON.stringify(a),headers:n,timeout:i||h.T.DefaultTimeoutHigh};return this.callEndpointWithOauthToken(l)}owaSessionStorageRequest(e){return new Promise(((t,n)=>{if(i.throwOnUndefined(e,"data"),this.shouldBlockCall(4))return void n(new s.W("SuiteService",-1011));const a={url:o.p.Instance.suiteServiceHostPageBaseUrl,requestObject:e,timeout:3e4,success:e=>t(e.responseObject),error:(e,t,a)=>n(new s.W(a,-2002))},r=m.b6.OwaInstance;null==r?n(new s.W("SuiteService",-1011)):r.executeStorageRequest(a)}))}callOwaIframeWithOrWithoutRetry(e,t,n,a,i=!0){const r={};if(null!=t)for(const e of Object.keys(t))r[e]=t[e];r.Accept="application/json",r["Content-Type"]="application/json; charset=utf-8";const l=o.p.Instance.MailboxGuid,u=o.p.Instance.configuration.ShellSID,p=l||u;let d=c.generateCorrelationId(p);r["X-OWA-CorrelationId"]=d;const h=JSON.stringify(n);return new Promise(((n,o)=>{if(null!=this.suiteServiceCallsBlockedReason){const e=new s.W(this.suiteServiceCallsBlockedReason,-1010);return o(e)}const l=m.b6.OwaInstance;if(null===l)return void this.executeErrorCallback(t,o,c.convertErrorToException(null,-1011,"OwaIframe"));let u=!1;this.firstDataRequestSent||(u=!0,this.firstDataRequestSent=!0);const g=e=>{null!=this.owaCallsInterceptor&&this.owaCallsInterceptor.afterSuiteServiceSuccess(e.headers),n(e.body)};this.owaHttpRequest(l,e,h,r,a).then(g).catch(i?n=>{449===n.HttpStatus?this.owaHttpRequest(l,e,h,r,a).then(g).catch((e=>this.executeErrorCallback(t,o,e))):null!=n[y.XSuiteError]&&n[y.XSuiteError]===y.WrongServerException?(d=c.generateCorrelationId(p),r["X-OWA-CorrelationId"]=d,this.owaHttpRequest(l,e,h,r,a).then((e=>{g(e)})).catch((e=>{this.executeErrorCallback(t,o,e)}))):o(n)}:()=>{o()})}))}owaHttpRequest(e,t,n,r,o){return new Promise(((s,u)=>{if(i.throwOnNullOrUndefined(t,"url"),this.shouldBlockCall(this.getExchangeServiceToCall(t)))return u(c.convertErrorToException(null,-1010,this.suiteServiceCallsBlockedReason));let p=null;const d={headers:r,url:t,method:o.toString(),body:o!==S.o.GET?n:void 0,success:e=>{const t=c.getOwaError(e.headers);if(null!=t)return this.checkAndHandleBlockingOwaErrors(t),void u(c.convertErrorToException(e,e.statusCode,t));try{s(e)}catch(e){}null!=p&&p()},error:(e,t,n)=>{const i=c.getOwaError(e.headers);null!=i&&this.checkAndHandleBlockingOwaErrors(i),e.statusCode!==y.HttpStatusCodeTokenExpired&&e.statusCode!==y.HttpStatusCodeUnauthorized||(this.blockSuiteServiceCalls(l.I.TokenExpired,t,n),(0,a.NP)().invoke("AuthenticationExpired")),u(c.convertErrorToException(e,t,n))}};if(this.ShouldQueueOwsCalls)if(this.isStartupAction(r))p=()=>{this.setStartupActionCompleted(),p=null};else if(2===this.getExchangeServiceToCall(d.url))return void this.queuedCalls.push(new f(e,d,u));e.executeAsync(d)}))}registerAuthenticationExpiredCallback(e){(0,a.NP)().subscribe("AuthenticationExpired",e,!0)}registerCultureNotSetCallback(e){(0,a.NP)().subscribe("CultureNotSet",e,!0)}guaranteeConnectionEstablished(e){this.ConnectionEstablished||o.p.Instance.configuration.IsOwa?e():this.startupCallbacks.push(e)}blockSuiteServiceCalls(e,...t){
// the more important blocking reasons are evaluated first e.g. NoExoLicense etc
null!=this.suiteServiceCallsBlockedReason&&e!==l.I.ShardNotDetected||(this.suiteServiceCallsBlockedReason=e.toString(),(0,a.tZ)().tag("RequestExecuter_SuiteServiceCallsBlocked",4,l.I[e],t))}stopBlockingCalls(){this.suiteServiceCallsBlockedReason=null}callStartupCallbacks(){for(const e of this.startupCallbacks)null!=e&&e();this.startupCallbacks=[]}checkAndHandleBlockingOwaErrors(e){e.indexOf("OwaInvalidUserLanguageException")>-1?(this.blockSuiteServiceCalls(l.I.LanguageNotSet,e),(0,a.NP)().invoke("CultureNotSet")):"InvalidMailbox"===e?this.blockSuiteServiceCalls(l.I.InvalidMailbox,e):"ShardMailbox"===e&&this.blockSuiteServiceCalls(l.I.ShardMailbox,e)}getExchangeServiceToCall(e){const t=null!=e?p.getUrlPath(e):null;if(t){const e=(e,t)=>e.substr(0,t.length)===t;if(e(t,p.SuiteServiceApiRelativePath))return 3;if(e(t,p.OwsRelativePath))return 2;if(e(t,p.DevFabricOwsRelativePath))return 2}const n=new Error("Cannot Acquire Exchange Service to Call");throw(0,a.tZ)().exception("Service_ExchangeServiceAcquireFail",6,n,t),n}shouldBlockCall(e){return null!=this.suiteServiceCallsBlockedReason&&!(2!==e&&y.callBlockingReasonsSpecificToOws.indexOf(this.suiteServiceCallsBlockedReason))}executeErrorCallback(e,t,n){try{t(n)}catch(e){}if(!this.owsStartupActionCompleted&&this.isStartupAction(e)){const e=n.errorCode||0,t=-1005===e?l.I.CallerOriginNotAllowed:l.I.InitFailed;this.blockSuiteServiceCalls(t,e,n.message);const a=c.convertErrorToException(null,-1010,"App initialization failed, call canceled",e,n.message);for(const e of this.queuedCalls)try{e.ErrorCallback(a)}catch(e){}this.queuedCalls=[]}}isUserInitiatedCall(e){return y.userInitiatedCalls.indexOf(e.toLowerCase())>=0}isStartupAction(e){const t=o.p.Instance.configuration.StartupActionName;return null!=t&&t===e[y.ActionHeaderKey]}}y.ActionHeaderKey="Action",y.UPNAnchorMailboxHeaderKey="X-UpnAnchorMailbox",y.XSuiteError=c.XSuiteError,y.HttpStatusCodeUnauthorized=401,y.HttpStatusCodeTokenExpired=440,y.WrongServerException="WrongServerException",y.instance=new y,y.callBlockingReasonsSpecificToOws=[l.I.LanguageNotSet.toString(),l.I.InitFailed.toString(),l.I.InvalidMailbox.toString(),l.I.ShardMailbox.toString()],y.userInitiatedCalls=["getowauserconfiguration"]},66873:function(e,t,n){"use strict";n.d(t,{p:function(){return a}});class a{constructor(e){this.suiteServiceHostPageBaseUrl=e.SuiteServiceUrl.substring(0,e.SuiteServiceUrl.lastIndexOf("/")),this.configuration=e}static Initialize(e){this.instance=new a(e)}static get Instance(){return this.instance}static assertInitialized(){if(null===a.Instance)throw new Error("SessionData not initialized.")}}a.isUnitTestMode=!1},88514:function(e,t,n){"use strict";n.d(t,{E:function(){return r}});var a=n(16968),i=n(66873);class r{static getToken(e){return new Promise(((t,n)=>{if((0,a.tZ)().tag("TokenProcessor_GetToken_Start",1,e.resource,`Resource: ${e.resource}, URL: ${e.url}`),i.p.Instance.configuration.GetTokenRequestDictionary){let r=i.p.Instance.configuration.GetTokenRequestDictionary();(0,a.tZ)().tag("TokenProcessor_GetToken_DictionaryFound",1,e.resource,`Dictionary keys: ${Object.keys(r).join(", ")}`);let o=i=>{i?((0,a.tZ)().tag("TokenProcessor_GetToken_Success",1,e.resource,`Token retrieved successfully for resource: ${e.resource}`),t({token:i,responseType:0})):((0,a.tZ)().tag("GetAccessToken_Empty",6),n({responseType:2}))},s=t=>{(0,a.tZ)().tag("TokenProcessor_GetToken_Error",6,e.resource,`Failed to get token for resource: ${e.resource}, Error: ${t.message||t}`),(0,a.tZ)().exception("GetAccessToken_Failed",6,t),n({responseType:2,exception:t})};if(r[e.resource]){let t=r[e.resource];(0,a.tZ)().tag("TokenProcessor_GetToken_ResourceFound",1,e.resource,"Resource found in dictionary, Type: "+typeof t),"function"==typeof t?((0,a.tZ)().tag("TokenProcessor_GetToken_ExecutingFunction",1,e.resource,`Executing token request function for resource: ${e.resource}`),t().then((e=>{o(e)})).catch((e=>{s(e)}))):((0,a.tZ)().tag("TokenProcessor_GetToken_ExecutingPromise",1,e.resource,`Executing token request promise for resource: ${e.resource}`),t.then((e=>{o(e)})).catch((e=>{s(e)})))}else(0,a.tZ)().tag("TokenProcessor_GetToken_ResourceNotFound",4,e.resource,`Resource not found in token dictionary: ${e.resource}`),n({responseType:1})}else(0,a.tZ)().tag("TokenProcessor_GetToken_NoDictionary",4,e.resource,"Token request dictionary not available in configuration"),n({responseType:1})}))}}},77441:function(e,t,n){"use strict";n.d(t,{V:function(){return c}});var a=n(16533),i=n(87948),r=n(9522);const o='{ "kty": "oct", "k": "{0}", "extractable": true }';let s;const l=void 0!==typeof btoa;class c{static loadCryptoModule(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return new Promise((e=>{void 0!==s?e():null!=window.crypto?(s=window.crypto,e()):n.e("msrcrypto").then(n.t.bind(n,67246,23)).then((t=>{s=t,e()}))}))}))}static computeSHA256(e){return(0,a.__awaiter)(this,arguments,void 0,(function*(e,t=!0){return yield this.loadCryptoModule(),new Promise(((n,a)=>{try{let i=c.textToUInt8Array(e,t),r={name:"SHA-256"},o=s.subtle.digest(r,i);const l=e=>{if(c.verifyResult(e,a)){let t=Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join("");n(c.toBase64(t))}},u=e=>{c.verifyResult(e,a)&&a(e.toString())};o.then(l,u)}catch(e){a(e.toString())}}))}))}static encryptAES(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return yield this.loadCryptoModule(),new Promise(((a,r)=>{try{let l=(0,i.JT)(o,c.base64ToBase64Url(e)),u={name:"AES-CBC"},p=s.subtle.importKey("jwk",JSON.parse(l),u,!0,["encrypt","decrypt"]);const d=e=>{try{let i=e,o=c.textToUInt8Array(c.base64ToString(t),!1),l=c.textToUInt8Array(n,!0),u={name:"AES-CBC",iv:o},p=s.subtle.encrypt(u,i,l);const d=e=>{try{c.verifyResult(e,r)&&a(c.toBase64(c.bytesToText(e,!1)))}catch(e){r(e.toString())}},h=e=>{c.verifyResult(e,r)&&r(e.toString())};p.then(d,h)}catch(e){r(e.toString())}},h=e=>{c.verifyResult(e,r)&&r(e)};p.then(d,h)}catch(e){r(e.toString())}}))}))}static decryptAES(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return yield this.loadCryptoModule(),new Promise(((a,r)=>{try{let l=(0,i.JT)(o,c.base64ToBase64Url(e)),u={name:"AES-CBC"},p=s.subtle.importKey("jwk",JSON.parse(l),u,!0,["encrypt","decrypt"]);const d=e=>{try{let i=e,o=c.textToUInt8Array(c.base64ToString(t),!1),l=c.textToUInt8Array(c.base64ToString(n),!1),u={name:"AES-CBC",iv:o},p=s.subtle.decrypt(u,i,l);const d=e=>{try{c.verifyResult(e,r)&&a(c.bytesToText(e,!0))}catch(e){r(e.toString())}},h=e=>{c.verifyResult(e,r)&&r(e.toString())};p.then(d,h)}catch(e){r(e.toString())}},h=e=>{c.verifyResult(e,r)&&r(e.toString())};p.then(d,h)}catch(e){r(e.toString())}}))}))}static textToUInt8Array(e,t){e=t?encodeURI(e):e;let n=[];for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return new Uint8Array(n)}static bytesToText(e,t){let n=(0,r.convertArrayBufferToBinaryString)(e);return t?decodeURI(n):n}static base64ToBase64Url(e){return e.replace(new RegExp("\\+","g"),"-").replace(new RegExp("/","g"),"_").replace(new RegExp("=","g"),"")}static verifyResult(e,t){return null!=e||(t("result undefined"),!1)}static base64ToString(e){if(!l)return s.base64ToString(e);for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4!=0;)e+="=";return atob(e)}static toBase64(e,t){if(!l)return s.toBase64(e);let n="";return t||(t=!1),n=btoa(e),t?n.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""):n}}},23653:function(e,t,n){"use strict";n.d(t,{K:function(){return i},W:function(){return a}});class a{constructor(e="",t,n){if(this.message=e,this.errorCode=t,this.errorInfo=n,this.name="ShellException",null!=n)for(let e of Object.keys(n))this[e]=n[e]}}class i extends a{constructor(e="",t,n){super(e,t,n),this.message=e,this.errorCode=t,this.errorInfo=n,this.name="RequestExecutorException"}}},44954:function(e,t,n){"use strict";n.d(t,{o:function(){return a}});class a{}a.GET="GET",a.POST="POST",a.PUT="PUT",a.PATCH="PATCH",a.DELETE="DELETE"},27501:function(e,t,n){"use strict";n.d(t,{D8:function(){return o},Ep:function(){return h},Kb:function(){return g},Kl:function(){return r},Kx:function(){return c},P8:function(){return s},Pr:function(){return a},Xs:function(){return p},fo:function(){return m},iZ:function(){return d},pc:function(){return l},s5:function(){return u},sP:function(){return S},wI:function(){return i}});const a="Request was aborted or timed out",i="Browser not supported",r="Invalid field or parameter {0}",o="Cannot access {0}",s="Binary data not supported",l="Invalid operation",c="Session storage error",u="Unable to parse json",p="Status:{0}, Content-type:{1}",d="Access denied",h="Timeout due to trusted sites",m="Could not find IFrame element.",g="Message listener is not attached.",S="User is offline and the request cannot be processed."},9522:function(e,t,n){"use strict";n.r(t),n.d(t,{BooleanTypeString:function(){return p},DevFabricOwsRelativePath:function(){return y},FunctionTypeString:function(){return d},NumberTypeString:function(){return h},OwaIFrameID:function(){return m},OwsRelativePath:function(){return f},PostMessageIdPrefix:function(){return C},StringTypeString:function(){return u},SuiteServiceApiRelativePath:function(){return S},TokenFactoryIFrameID:function(){return g},buildIframeResourceData:function(){return R},buildUrl:function(){return P},checkBrowserBinaryDataSupport:function(){return G},convertArrayBufferToBinaryString:function(){return N},convertBinaryStringToXmlHttpRequestBody:function(){return L},createInvalidParameterException:function(){return w},encodeUrlForXmlHttpRequest:function(){return Z},endsWith:function(){return _},ensureAttachMessageListener:function(){return B},getCurrentWindowLocation:function(){return b},getFrameElement:function(){return Y},getFrameID:function(){return ee},getUrlAuthorityPart:function(){return E},getUrlDomainPart:function(){return O},getUrlPath:function(){return k},getXMLHttpRequest:function(){return x},getXMLHttpResponseLength:function(){return te},isFullUrl:function(){return A},isNullOrEmptyString:function(){return D},parseQueryString:function(){return F},parseResponseHeaders:function(){return M},reportSimpleError:function(){return H},startsWith:function(){return W},urlEncodeCore:function(){return $},validateField:function(){return v},validateFullUrl:function(){return T},validateRequestInfo:function(){return U}});var a=n(16968),i=n(87948),r=n(45011),o=n(74107),s=n(917),l=n(23653),c=n(27501);const u="string",p="boolean",d="function",h="number",m="o365shellowaframe",g="o365shellwcssframe",S="O365SuiteService/api/",f="owa/service.svc",y="SuiteService.svc",C="SP.RequestExecutor",I="https://";function v(e,t,n,a){if(a){if(null==e||typeof e!==n)throw new l.K((0,i.JT)(c.Kl,t),-2001)}else if(null!=e&&typeof e!==n)throw new l.K((0,i.JT)(c.Kl,t),-2001)}function A(e){return e.substr(0,I.length).toLowerCase()===I}function T(e,t){if(!A(e))throw w(t)}function b(){return window.location.href}function w(e){return new l.K((0,i.JT)(c.Kl,e),-2001)}function D(e){return""===e||null==e}function P(e,t){if(T(e,"baseUrl"),A(t))return t;if("/"===t.charAt(0)){let n=e.indexOf("://");return n=e.indexOf("/",n+3),n>0&&(e=e.substr(0,n)),e+t}return"/"!==e.charAt(e.length-1)&&(e+="/"),e+t}function O(e,t=!1){t&&T(e,"url");let n=e.indexOf("://");return n=e.indexOf("/",n+3),n>0&&(e=e.substr(0,n)),e.substr(0,I.length).toLowerCase()===I&&":443"===e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),e}function k(e){let t="",n=O(e);const a=e.indexOf("?");return t=a>n.length+1?e.substring(n.length+1,a):e.substring(n.length+1,e.length),t}function E(e){return(e=O(e)).substr(0,I.length).toLowerCase()===I&&(e=e.substr(I.length)),e.toLowerCase()}function R(e,t){const n=(0,r.ZR)(t.ShellResources.crossdomainproxyiframe),a=(0,r.ZR)(t.ShellResources.msaltokenfactoryiframe);return{version:e,crossdomainproxyJsHash:n.hash,msaltokenfactoryJsHash:a.hash,resourceCatalogHostUrl:t.ResourceCatalogHostUrl}}function x(){if(!("XMLHttpRequest"in window))throw new l.K(c.wI,-2003);return new XMLHttpRequest}function U(e){if(null==e)throw w("requestInfo");if(v(e.url,"requestInfo.url",u,!0),v(e.body,"requestInfo.body",u,!1),v(e.success,"requestInfo.success",d,!1),v(e.error,"requestInfo.error",d,!1),v(e.timeout,"requestInfo.timeout",h,!1),v(e.method,"requestInfo.method",u,!1),v(e.binaryStringRequestBody,"requestInfo.BinaryRequestBody",p,!1),v(e.binaryStringResponseBody,"requestInfo.BinaryResponseBody",p,!1),D(e.method)?e.method="GET":e.method=e.method.toUpperCase(),null==e.timeout&&(e.timeout=s.T.DefaultTimeoutHigh),e.timeout<0)throw w("requestInfo.timeout");if(D(e.url))throw w("requestInfo.url")}function N(e){let t="";const n=new Uint8Array(e);for(let e=0;e<n.length;e++)t+=String.fromCharCode(n[e]);return t}function L(e){let t=null;if(typeof e===u){let n=new ArrayBuffer(e.length),a=new Uint8Array(n);for(let t=0;t<e.length;t++)a[t]=255&e.charCodeAt(t);let i=new Blob([n]);t=i||n}return t}function F(e){let t="";const n=e.indexOf("?");return n>0&&(t=e.substr(n+1,e.length)),t}function M(e){let t={};if(null!=e){let n=new RegExp("\r?\n"),a=e.split(n);for(let e of a)if(null!=e){let n=e.indexOf(":");if(n>0){let a=e.substr(0,n),i=e.substr(n+1);a=q(a),i=q(i),t[a.toUpperCase()]=i}}}return t}function q(e){return e.replace(/^\s+|\s+$/g,"")}function W(e,t){return 0===e.lastIndexOf(t,0)}function _(e,t){let n=e.lastIndexOf(t);return-1!==n&&n===e.length-t.length}function G(){if(!("ArrayBuffer"in window))throw(0,a.tZ)().tag("RequestExecutor_ArrayBufferNotSupported",6,-2003,c.P8),new l.K(c.P8,-2003);if(!("Uint8Array"in window))throw(0,a.tZ)().tag("RequestExecutor_Uint8ArrayNotSupported",6,-2003,c.P8),new l.K(c.P8,-2003);if(!("BlobBuilder"in window)&&!("MozBlobBuilder"in window)&&!("Blob"in window))throw(0,a.tZ)().tag("RequestExecutor_BlobBuilderNotSupported",6,-2003,c.P8),new l.K(c.P8,-2003)}function B(e){if(window.addEventListener)return window.addEventListener("message",e,!1),!0;throw new l.K(c.Kb,-2002)}function H(e,t,n,i){if(null!=e.error){let a={state:e.state,body:""};i&&(n=`${n} target: ${i}`),e.error(a,t,n)}else(0,a.tZ)().tag("RequestExecutor_NoErrorCallback",6,t.toString(),n)}function Z(e){return $(e,!0,!0)}const z=224,j=192,J=240,Q=128,V=55296,K=64512,X=65536;function $(e,t,n){let a,i="";if(D(e)||void 0===e||0===e.length)return"";for(let r=0;r<e.length;r++){let o=e.charCodeAt(r),s=e.charAt(r);if(t&&("#"===s||"?"===s)){i+=e.substr(r);break}if(o<=127)n||o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o>=32&&o<=95&&" \"%<>'&".indexOf(s)<0?i+=s:o<=15?i+="%0"+o.toString(16).toUpperCase():o<=127&&(i+="%"+o.toString(16).toUpperCase());else if(o<=2047)a=j|o>>6,i+="%"+a.toString(16).toUpperCase(),a=Q|63&o,i+="%"+a.toString(16).toUpperCase();else if((o&K)!==V)a=z|o>>12,i+="%"+a.toString(16).toUpperCase(),a=Q|(4032&o)>>6,i+="%"+a.toString(16).toUpperCase(),a=Q|63&o,i+="%"+a.toString(16).toUpperCase();else if(r<e.length-1){o=(1023&o)<<10,r++,o|=1023&e.charCodeAt(r),o+=X,a=J|o>>18,i+="%"+a.toString(16).toUpperCase(),a=Q|(258048&o)>>12,i+="%"+a.toString(16).toUpperCase(),a=Q|(4032&o)>>6,i+="%"+a.toString(16).toUpperCase(),a=Q|63&o,i+="%"+a.toString(16).toUpperCase()}}return i}function Y(e){return document.getElementById(ee(e))}function ee(e){switch(e){case o.J.OWA:return m;case o.J.TokenFactory:return g;default:return(0,a.tZ)().tag("RequestExecutor_UnsupportedFrameCodeSpecified",6),""}}function te(e){return"arraybuffer"===e.responseType?e.response?e.response.byteLength:0:e.responseText?e.responseText.length:0}},7668:function(e,t,n){"use strict";var a;n.d(t,{I:function(){return a}}),function(e){e[e.NoExoLicense=1]="NoExoLicense",e[e.Brs=2]="Brs",e[e.TokenExpired=3]="TokenExpired",e[e.LanguageNotSet=4]="LanguageNotSet",e[e.InitFailed=5]="InitFailed",e[e.SecurityZoneMismatched=6]="SecurityZoneMismatched",e[e.IframeLoadError=7]="IframeLoadError",e[e.CallerOriginNotAllowed=8]="CallerOriginNotAllowed",e[e.InvalidMailbox=9]="InvalidMailbox",e[e.ShardMailbox=10]="ShardMailbox",e[e.ShardNotDetected=11]="ShardNotDetected",e[e.Pwa=12]="Pwa"}(a||(a={}))},68105:function(e,t,n){"use strict";n.d(t,{B:function(){return r}});var a=n(73637),i=n(9522);n(48314);class r{static onBeforeSendRequestSuiteService(e,t,n){if(null!=n&&null!=n.userMailboxType&&null!=t&&-1!==i.parseQueryString(t.url.toLowerCase()).indexOf("getowauserconfiguration"))try{JSON.parse(n.userMailboxType)}catch(e){}{let t="X-OWA-CANARY",n="X-OWA-CANARY-DEBUG",i=(0,a.R)(t),r=(0,a.R)(n);return null!=i&&e.setRequestHeader(t,i),null!=r&&e.setRequestHeader(n,r),null}}static validateOriginWithAllowedEndpoints(e,t){let n=[];for(let e=0;e<t.length;e++)n[e]=t[e].host;return r.validateOrigin(i.getUrlAuthorityPart(e),n)}static validateOrigin(e,t){if(null==t||e.length>253)return!1;let n,a=!1;for(let i=0;i<t.length;i++)if(""!==t[i]&&(n=new RegExp(t[i],"i"),n.test(e))){a=!0;break}return a}static validatePathWithAllowedEndpoints(e,t){if(i.isNullOrEmptyString(e))return!1;let n,a=!1;const r=i.getUrlAuthorityPart(e),o=i.getUrlPath(e);for(let e of t)if(n=new RegExp(e.host,"i"),n.test(r)){if(null==e.paths)return!1;for(let t of e.paths)if(n=new RegExp(t,"i"),n.test(o)){a=!0;break}break}return a}static validatePathWithAllowedResources(e,t,n){if(null==e||i.isNullOrEmptyString(t)||null==n)return!1;let a,r=!1;const o=i.getUrlAuthorityPart(e),s=i.getUrlAuthorityPart(t);for(let e of n){let t=!1;if("^"===e.resource.charAt(0))a=new RegExp(e.resource,"i"),t=a.test(o);else{t=i.getUrlAuthorityPart(e.resource)===o}if(t){if(null==e.hosts)return!1;for(let t of e.hosts){let e=!1;if("^"===t.charAt(0))a=new RegExp(t,"i"),e=a.test(s);else{e=i.getUrlAuthorityPart(t)===s}if(e){r=!0;break}}break}}return r}static isAllowedApi(e){if(null==e)return!1;let t=i.getUrlPath(e);if(t in r.allowedPath){if(!r.allowedPath[t])return!0;if(i.parseQueryString(e).replace("&UA=0","")in r.allowedListOfApi)return!0}else if(i.startsWith(t,i.SuiteServiceApiRelativePath))return!0;return("owa/ev.owa2"===t||"ev.owa2"===t)&&r.checkAllowedPgmParameters(e)}static checkAllowedPgmParameters(e){if(i.isNullOrEmptyString(e)||""===e.trim())return!1;let t=e.split("?");if(2===t.length){let e=t[1];if(i.isNullOrEmptyString(e)||""===e.trim())return!1;let n=e.split("&");for(let e of n){let t=e.split("=");if(2!==t.length)return!1;if(!(t[0]in r.AllowedPgmQueryStringParametersList))return!1}return!0}return!1}static createAllowedPgmParamters(){return{ecnsq:!0,brwnm:!0,cid:!0,syncFnshRq:!0,ns:!0,ev:!0,Fn:!0,UA:!0,"UX-E4E-CANARY":!0,"X-OWA-CANARY":!0,"X-OWA-CANARY-DEBUG":!0,"X-E4E-CANARY-DEBUG":!0}}static createAllowedApiList(){return{"action=GetReminders":!0,"action=GetOwaUserConfiguration":!0,"action=SetNotificationSettings":!0,"action=FindItem":!0,"action=GetUserAvailabilityInternal":!0,"action=GetCalendarFolders":!0,"action=ProcessSuiteStorage":!0,"action=SubscribeToNotification":!0,"action=PerformReminderAction":!0,"action=GetOwaUserOofSettings":!0,"action=SetUserTheme":!0,"action=SetUserLocale":!0,"action=UnsubscribeToNotification":!0,"action=GetDaysUntilPasswordExpiration":!0,"action=GetModernGroups":!0,"action=GetModernGroup":!0,"action=GetModernGroupUnseenItems":!0,"action=GetCalendarFolderConfiguration":!0,"action=SubscribeToGroupUnseenNotification":!0,"action=SubscribeToGroupNotification":!0,"action=GetSocialActivityNotifications":!0,"action=GetSocialActivityNotifications2":!0,"action=MarkSocialActivityNotificationsAsSeen":!0,"action=MarkSocialActivityNotificationsAsSeen2":!0,"action=GetBingHelpSearchResults":!0,"action=GetMailboxRegionalConfiguration":!0,"action=SetMailboxRegionalConfiguration":!0,"format=json":!0,"api-version=1":!0,"action=TestAddReminders":!0,"action=TestDeleteAllReminders":!0,"action=TestAddItems":!0,"action=TestDeleteAllItems":!0,"action=TestAddCalendarFolders":!0,"action=TestAddCalendarGroups":!0,"action=TestDeleteAllCalendarFolders":!0,"action=TestDeleteAllCalendarGroups":!0,"action=TestAddUserAvailability":!0,"action=TestDeleteAllUserAvailability":!0,"action=TestAddOwaUserOofSettings":!0,"action=TestDeleteNotifications":!0,"action=TestAddNotifications":!0,"action=TestGetSettings":!0}}static createAllowedPath(){return{[i.OwsRelativePath]:!0,"SuiteService.svc/":!0,"SuiteService.svc":!0,"owa/ev.owa2":!0,"ev.owa2":!0,"Microsoft.Online.BOX.Admin.UI.SystemAlert.GetAlerts.model":!0,"Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetPrePinnedAppTiles.model":!0,"Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetAllAppTilesForAllCollectors.model":!0,"api/myapps/GetAllApps":!1,"api/myapps/GetAppDetails":!1,"api/myapps/GetCompleteAppData":!1,"api/myapps/ExecuteAppCustomAction":!1,"api/myapps/ActivatePendingProvisioningApps":!1,"owa/service.svc/s/GetPersonaPhoto":!1,"api/settings/cards":!1,"api/settings/cards/data":!1,"api/settings/theme":!1,"api/settings/darkmode":!1,"api/settings/language":!1,"api/settings/contactPreferences":!1,"api/NotificationsSettings/User":!1,"api/settings/SPO/MySiteUrl":!1,"api/settings/regiontimezone":!1,"api/profile/photo":!1,"v1.0/me/photo/$value":!1,"api/storage/CustomerContent/Tenant/CustomSupportData":!0}}}r.allowedPath=r.createAllowedPath(),r.allowedListOfApi=r.createAllowedApiList(),r.AllowedPgmQueryStringParametersList=r.createAllowedPgmParamters()},3709:function(e,t,n){"use strict";n.r(t),n.d(t,{XSuiteError:function(){return d},convertErrorToException:function(){return C},generateCorrelationId:function(){return g},genericServiceExceptionLog:function(){return v},genericServiceRejection:function(){return A},getOwaError:function(){return f},getOwaServerName:function(){return S},isCallsBlockedException:function(){return I}});var a=n(16968),i=n(87948),r=n(66873),o=n(23653);class s{constructor(e){this.value=e}static newSuid(){const e=(new Date).getTime();return s.disambiguationIndex=99===s.disambiguationIndex?0:s.disambiguationIndex+1,new s(100*e+s.disambiguationIndex)}}s.disambiguationIndex=-1;const l="X-OWA-ERROR",c="X-OWA-CORRELATIONID",u="X-FESERVER",p="X-BESERVER",d="X-SUITE-ERROR",h="FE_{0}_BE_{1}",m=[c,u,p,l,d];function g(e){return e+"_"+s.newSuid().value.toString()}function S(){return(0,i.JT)(h,r.p.Instance.OwaFrontEndServerName,r.p.Instance.OwaBackEndServerName)}function f(e){return null==e?null:(null!=e[u]&&(r.p.Instance.OwaFrontEndServerName=e[u]),null!=e[p]&&(r.p.Instance.OwaBackEndServerName=e[p]),e[l])}const y="errorCode";function C(e,t,n,...a){let i=function(e){let t={};if(null!=e&&(t.HttpStatus=e.statusCode,null!=e.headers))for(let n of m)null!=e.headers[n]&&(t[n]=e.headers[n]);return t}(e);i[y]=t;let r=0;for(let e of a)i["arg"+r]=e,r++;return new o.W(n,t,i)}function I(e){return-1010===e.errorCode||-1007===e.errorCode}function v(e,t,n){if(n){const r=n.errorCode||"",o=n.errorInfo&&n.errorInfo.HttpStatus?n.errorInfo.HttpStatus:"",s=n[l]||n[d]||"",m=null!=n[u]&&null!=n[p]?(0,i.JT)(h,n[u],n[p]):"",g=n[c]||"";(0,a.tZ)().exception(e,t,n,r,o,s,m,g)}else(0,a.tZ)().exception(e,t,n)}function A(e,t,n,a){I(n)&&v(e,t,n),a(n)}},83834:function(e,t,n){"use strict";n.d(t,{A:function(){return c}});var a=n(73637),i=n(77441),r=n(23653),o=n(27501),s=n(9522);const l="$";class c{static processRequest(e,t){let n={},l=(0,a.R)("SuiteServiceProxyKey"),u=null,p=null;if(s.isNullOrEmptyString(l)){if(l=(0,a.R)("ClientStorageCookie"),s.isNullOrEmptyString(l))throw new r.W(o.Kx,-2007);l=decodeURIComponent(l)}const d=l.split("&");if(2!==d.length)throw new r.W(o.Kx,-2007);if(u=d[0],p=d[1],s.isNullOrEmptyString(e.UserId))throw new r.W(o.Kx,-2004);let h=window.sessionStorage;if(null==h)throw new r.W(o.Kx,-2005);try{let a=e.UserId;const s=a=>{h.setItem("CurrentUserId",a),c.doClearAll(e,n,h),c.doDeletes(e,n,h),c.doWritesAndReads(e,u,p,h,n,t)},l=e=>{const a=null==e?o.Kx:e;n.ResetError=new r.W(a,-2008),t(n)};i.V.computeSHA256(a).then(s).catch(l)}catch(e){n.ResetError=e,t(n)}}static doClearAll(e,t,n){try{if(!0===e.ClearAll){const e=Object.keys(n);c.doDeletes({Deletes:e},t,n)}}catch(e){t.ClearError=e}}static doDeletes(e,t,n){try{if(null!=e.Deletes)for(let t of e.Deletes)n.removeItem(t)}catch(e){t.DeleteError=e}}static doWritesAndReads(e,t,n,a,i,r){try{null!=e.Writes?c.encryptWrites(t,n,e.Writes,0,a,(()=>{c.doReads(e,t,n,a,i,r)}),(o=>{i.WriteError=o,c.doReads(e,t,n,a,i,r)})):c.doReads(e,t,n,a,i,r)}catch(o){i.WriteError=o,c.doReads(e,t,n,a,i,r)}}static doReads(e,t,n,a,i,r){try{if(null!=e.Reads){let o={};c.decryptReads(t,n,e.Reads,0,o,a,(e=>{i.Reads=e,r(i)}),(e=>{i.ReadError=e,r(i)}))}}catch(e){i.ReadError=e,r(i)}}static encryptWrites(e,t,n,a,s,u,p){null!=n&&a<n.length?null==e?(s.setItem(n[a].Key,n[a].Value),c.encryptWrites(e,t,n,a+1,s,u,p)):i.V.encryptAES(e,t,l+n[a].Value+l).then((i=>{s.setItem(n[a].Key,i),c.encryptWrites(e,t,n,a+1,s,u,p)})).catch((e=>{let t=null==e?o.Kx:e;p(new r.W(t,-2009))})):u()}static decryptReads(e,t,n,a,o,u,p,d){if(null!=n&&a<n.length){let h=n[a],m=u.getItem(h);null===m?c.decryptReads(e,t,n,a+1,o,u,p,d):(null===e&&(o[h]=m,c.decryptReads(e,t,n,a+1,o,u,p,d)),i.V.decryptAES(e,t,m).then((i=>{null==i||!s.startsWith(i,l)||!s.endsWith(i,l)||i.length<2?c.doClearAll({ClearAll:!0},{},u):o[h]=i.substr(1,i.length-2),c.decryptReads(e,t,n,a+1,o,u,p,d)})).catch((i=>{"OperationError"===i?(c.doClearAll({ClearAll:!0},{},u),c.decryptReads(e,t,n,a+1,o,u,p,d)):d(new r.W(i))})))}else p(o)}}},24126:function(e,t,n){"use strict";n.d(t,{WJ:function(){return s.W},oZ:function(){return l.o},kN:function(){return m.k},b6:function(){return i.b6},OY:function(){return p},kl:function(){return r.k},IY:function(){return c.I},F2:function(){return h},pf:function(){return o.p},YM:function(){return d},xZ:function(){return f}});var a=n(917),i=n(37171),r=n(83251),o=n(66873),s=(n(77441),n(23653)),l=n(44954),c=n(7668),u=(n(68105),n(27501)),p=n(9522);class d{static checkScope(e,t){if(null!=e&&!(0,p.startsWith)(e,t+d.DictionaryStringPartsSeparator))throw new s.W(u.iZ,-2010)}}d.SuiteScope="O365S",d.DictionaryStringPartsSeparator="//";n(83834);var h=n(3709),m=n(48314);class g{}g.MSA="msa",g.AAD="aad",g.MSAFed="msaFed";let S=null;try{window.MSA&&window.MSA.MeControl&&(S=window.MSA.MeControl.UserStateModel)}catch(e){}function f(){"complete"===document.readyState?a.T.internalProcessWindowLoad():window.onload=a.T.internalProcessWindowLoad}n.nc=window.oneShellUxNonce},75511:function(e,t,n){"use strict";var a,i;n.d(t,{$:function(){return i},C:function(){return a}}),function(e){e.LifeCycle="LifeCycle",e.DataProviderResponseNotification="DataProviderResponseNotification",e.ChallengeToken="ChallengeToken"}(a||(a={})),function(e){e.GetConfig="GetConfig",e.RefreshToken="RefreshToken",e.PageReady="PageReady",e.Closed="Closed",e.FatalError="FatalError"}(i||(i={}))},48314:function(e,t,n){"use strict";var a;n.d(t,{k:function(){return a}}),function(e){e.Ping="Ping",e.Query="Query",e.OwaUserConfig="OwaUserConfig",e.TokenPrefetch="TokenPrefetch",e.Storage="Storage",e.Notification="Notification",e.UserState="UserState",e.SignalR="SignalR",e.IncomingOpxMessage="IncomingOpxMessage",e.OutgoingOpxMessage="OutgoingOpxMessage",e.RegisterOpxHost="RegisterOpxHost"}(a||(a={}))},47710:function(e,t,n){"use strict";n.d(t,{TR:function(){return a}});const a="cdn-url#oneshell"},50003:function(e,t,n){"use strict";n.d(t,{CR:function(){return s},Cg:function(){return c},O_:function(){return u},Rt:function(){return p},g2:function(){return d},vi:function(){return h}});var a=n(16968),i=n(99542),r=n(88128),o=n(68425);const s={IsVirtual:!0,ParallelView:!0,Style:"o365shell",CanCollapse:!0,SuppressBackgroundRinging:!0};let l;function c(e,t){!t&&swc&&(e?swc.API.triggerEvent(r.$D.ApiRecentsShown):swc.API.triggerEvent(r.$D.ApiRecentsHidden))}function u(e,t){!t&&swc&&swc.SDK.Recents.refreshDOM(e)}function p(e,t,n){!n&&swc?(swc.API.registerEvent(r.$D.ApiRecentsReady,t),swc.create(r.nR.Recents,{},e)):n&&(l=e)}function d(e,t){TeamsClient&&TeamsClient.client&&TeamsClient.client.conversations.get().then((n=>{n.render(l).then(e),n.subscribe((e=>{e.type===o.G.ConversationOpened&&t(!1,i.YZ)}))}))}function h(e,t){swc&&swc.getPresence().then((t=>{t.setMyStatus(e.key)})).catch((e=>{(0,a.tZ)().exception("UserPresence_SetMyStatus_Exception",6,e),t()}))}},88128:function(e,t,n){"use strict";var a,i,r;n.d(t,{$D:function(){return a},DP:function(){return i},nR:function(){return r}}),function(e){e.ChatCoreReady="swc:core:ready",e.ChatAPIReady="swc:ready",e.ApiRecentsReady="recentsReady",e.ApiRecentsShown="recentsShown",e.ApiRecentsHidden="recentsHidden",e.ApiUnreadConversationUpdate="unreadConversationsUpdate",e.ApiStartChat="startChat",e.ApiOnCallStart="onCallStart",e.ApiRecentItemsLoaded="recentItemsLoaded",e.ApiOnRecentItemSelected="onRecentItemSelected"}(a||(a={})),function(e){e.ChatRecents="skype-recents",e.ChatWrapper="chat-wrapper"}(i||(i={})),function(e){e.Calling="calling",e.Messaging="chat",e.Recents="recents"}(r||(r={}))},68425:function(e,t,n){"use strict";var a,i;n.d(t,{G:function(){return i},_:function(){return a}}),function(e){e[e.UnreadCounterUpdate=0]="UnreadCounterUpdate"}(a||(a={})),function(e){e.TeamsChatAPIReady="ms-teams-sdk-loaded",e.TeamsChatAuthFailed="ms-teams-sdk-auth-failed",e.ConversationOpened="conversationOpened",e.KeyPressed="keyPressed"}(i||(i={}))},29081:function(e,t,n){"use strict";n.d(t,{$6:function(){return s},FQ:function(){return r},I2:function(){return i},Kx:function(){return l},ij:function(){return c},q4:function(){return o},wW:function(){return a}});const a="suiteux-chat.UPDATE_IS_CHAT_RECENTS_INITIALIZED",i="suiteux-chat.UPDATE_IS_CHAT_API_INITIALIZED",r="suiteux-chat.UPDATE_IS_CHAT_API_PREAUTH_COMPLETED",o="suiteux-chat.UPDATE_UNREAD_CONVERSATION_COUNT",s="suiteux-chat.UPDATE_IS_TEAMS_CHAT_ACTIVATED",l="suiteux-chat.UPDATE_IS_TEAMS_CHAT_AUTH_FAILED",c="suiteux-chat.UPDATE_INIT_CHAT_IN_FIRST_CLICK"},28048:function(e,t,n){"use strict";n.d(t,{LO:function(){return o},ok:function(){return i},uW:function(){return r}});const a="https://latest-swc.cdn.skype.com/assets/personas/status/";function i(e){return a+e+".svg"}function r(e){return null!=e&&0!==e.length&&e.every((e=>e.key[0]===e.key[0].toUpperCase()))}function o(e,t){let n;return t&&(n=t.filter((t=>t.key===e))[0]),n}},20748:function(e,t,n){"use strict";n.d(t,{f:function(){return i}});var a=n(16968);function i(){return new Promise(((e,t)=>{(0,a.NP)().subscribe("SuiteAPILoaded",(n=>{let a=n.WebShellStorage.createWebShellStorageRequest();a.requestClearAll(),n.WebShellStorage.removeSessionStorage(a).then(e).catch(t)}),!0)}))}},44966:function(e,t,n){"use strict";n.d(t,{Tu:function(){return l},mf:function(){return r},nq:function(){return s},u0:function(){return o},zd:function(){return i}});var a=n(16968);const i="OPX",r="https://outlook.office.com",o=[r,"https://to-do.office.com","https://outlook-sdf.office.com"];function s(e){return{themeDarker:e.Darker,themeDark:e.Dark,themeDarkAlt:e.DarkAlt,themePrimary:e.Primary,themeSecondary:e.Secondary,themeTertiary:e.Tertiary,themeLight:e.Light,themeLighter:e.Lighter,themeLighterAlt:e.LighterAlt}}function l(){const e="hiddenOpxContainer";let t=document.getElementById(e);if(!t){let n=(0,a.GJ)();if(n){let a=document.getElementById(n.top);a&&(t=document.createElement("div"),t.id=e,t.style.display="none",a.appendChild(t))}}return t}},66639:function(e,t,n){"use strict";n.d(t,{k:function(){return i}});var a=n(59609);function i(e){return{type:a.l,dttProps:e}}},59609:function(e,t,n){"use strict";n.d(t,{l:function(){return a}});const a="suiteux-dtt.UPDATE_PROPS"},50585:function(e,t,n){"use strict";n.d(t,{d:function(){return q},Tg:function(){return F},ty:function(){return L},yd:function(){return M}});var a=n(90872),i=n(9028),r=n(91112),o=n(95978),s=n(82453),l=n(16968),c=n(8428),u=n(95422),p=n(57530),d=n(5232),h=n(40141),m=n(93884),g=n(46340),S=n(22461),f=n(87948),y=n(28370),C=n(18435),I=n(39038),v=n(79649),A=n(40412),T=n(25462),b=n(17750);const w="presenceStatusMenuButton";class D extends a.Component{constructor(e){super(e),this.setPresenceStatus=(e,t)=>{t.preventDefault(),t.stopPropagation(),(0,l.NP)().invoke("PresenceStatusChanged",e.key),this.setState({isContextMenuOpen:!1}),this.props.updatePresenceStatus(e),(0,l.tZ)().click("PresenceItem","UserPresence",null,null,e.key)},this.hideContextMenu=()=>{this.setState({isContextMenuOpen:!1})},this.onPresenceButtonClick=e=>{e.preventDefault(),e.stopPropagation(),this.toggleContextMenu(),(0,l.tZ)().click("PresenceButton","UserPresence")},this.toggleContextMenu=()=>{this.setState({isContextMenuOpen:!this.state.isContextMenuOpen})},this.setPresenceButton=e=>{this.presenceButton=e},this.state={isContextMenuOpen:!1}}render(){let e=this.props.presenceStatus,t=(0,h.e)();return a.createElement("button",{type:"button",id:w,className:(0,S.A)(b.presenceButton,t.neutral.tertiary.font),onClick:this.onPresenceButtonClick,ref:this.setPresenceButton,"aria-haspopup":!0},a.createElement("span",null,e.description,a.createElement(g.r,{fontIconCss:"ms-Icon--ChevronDownMed",fontSize:"11"})),this.state.isContextMenuOpen&&this.props.userPresenceStatusItems&&a.createElement(I.t,{className:b.presenceContextMenu,target:this.presenceButton,onDismiss:this.hideContextMenu,skipDismissForElement:this.presenceButton,id:"presenceContextMenu",skipAdjustPostion:!0},this.props.userPresenceStatusItems.map((e=>a.createElement(v.k,{key:e.key,itemId:e.key,displayText:e.description,onclick:t=>this.setPresenceStatus(e,t),customIcon:a.createElement(A.P,{presenceStatus:e,iconFontSize:16,iconFontClassName:T.contextMenuIconStyle,iconContainerClassName:T.statusIconContainer}),className:b.presenceContextMenuItem})))))}componentDidMount(){window.addEventListener(C.B.RESIZE,this.hideContextMenu)}componentWillUnmount(){window.removeEventListener(C.B.RESIZE,this.hideContextMenu)}}var P=n(61304),O=n(73948),k=n(10682),E=n(49985);const R="meControlSignoutLink",x="meControlEditPhotoButton";class U extends y.qs{constructor(e){super(e),this.onMouseChange=e=>this.setState({isHovered:e}),this.changePhotoCommand=e=>{(0,l.tZ)().click("EditPhoto","MeControlPane"),this.props.setChangePhoto(!0)},this.onSignOutClicked=e=>{(0,l.tZ)().click("SignOut","MeControlPane"),null!=this.props.signoutLink.Action&&this.props.signoutLink.Action();const t={triggerEvent:e.nativeEvent};(0,l.NP)().invoke("SignOut",t)},this.state={isHovered:!1}}render(){let e=[];const t=(0,h.e)();this.props.links&&(e=this.props.links.map((e=>a.createElement("div",{key:e.Id},a.createElement(m.z,{link:e,className:t.neutral.accent.link,onClick:()=>(0,l.tZ)().click("MeControl_"+e.Id,"MeControlPane")})))));let n=null;this.props.signoutLink&&(n=a.createElement("div",null,a.createElement("a",{id:R,href:this.props.signoutLink.Url,title:this.props.signoutLink.Title,target:this.props.signoutLink.TargetWindow,"aria-label":this.props.signoutLink.Title,onClick:this.onSignOutClicked,className:(0,S.A)(t.neutral.accent.link)},this.props.signoutLink.Text)));const i=(0,f.JT)(P.D.ChangePhotoAriaLabel,this.props.displayName,this.props.upn),r=(0,f.JT)(P.D.MePhotoAriaLabel,this.props.displayName,this.props.upn);return a.createElement(y.eb,{isActive:this.props.isActive,title:P.D.Me_Header,flexPaneProviderID:this.props.flexPaneProviderID,className:(0,S.A)(T.container,t.neutral.foreground.background)},a.createElement("span",{tabIndex:-1,className:(0,S.A)(T.companyDisplayName,t.neutral.dark.font),title:this.props.companyDisplayName,"aria-label":this.props.companyDisplayName},this.props.companyDisplayName),a.createElement("div",{className:T.personaView,role:"presentation"},a.createElement("div",{className:T.photoWrapper},a.createElement("button",{id:x,tabIndex:this.props.canSetPhoto?0:-1,ref:e=>this.initialFocusElement=this.props.canSetPhoto?e:null,title:this.props.canSetPhoto?P.D.ChangePhotoTitle:P.D.MePhotoTitle,"aria-label":this.props.canSetPhoto?i:r,role:this.props.canSetPhoto?"button":"presentation",onClick:this.props.canSetPhoto?this.changePhotoCommand:void 0,onMouseEnter:this.onMouseChange.bind(this,!0),onMouseLeave:this.onMouseChange.bind(this,!1),className:T.personaPhotoContainer},a.createElement("div",{className:(0,S.A)(T.personaPhoto,t.neutral.dark.font)},a.createElement(O.A,{photoSize:88,iconFontSize:16,backGroundIconFontSize:24,iconFontClassName:T.statusIconCommonStyle,backGroundIconClassName:T.backGroundIconStyle,presenceIconDivClassName:T.presenceStatusDiv,presenceIconDivId:"PresenceStatusIcon",isFlexPane:!0}),this.props.canSetPhoto&&this.state.isHovered?a.createElement(g.r,{className:T.cameraOverlay,fontIconCss:"ms-Icon--Camera"}):null))),a.createElement("div",{className:T.personaDetails},a.createElement("span",{tabIndex:-1,className:(0,S.A)(T.userDisplayName,t.neutral.dark.font),title:this.props.displayName,"aria-label":this.props.displayName},this.props.displayName),a.createElement("span",{tabIndex:-1,className:(0,S.A)(T.userEmail,t.neutral.dark.font),title:this.props.memberName,"aria-label":this.props.memberName},this.props.memberName),this.props.presenceStatus&&this.props.userPresenceStatusItems&&a.createElement(D,{presenceStatus:this.props.presenceStatus,userPresenceStatusItems:this.props.userPresenceStatusItems,updatePresenceStatus:this.props.updatePresenceStatus}),a.createElement("div",{className:(0,S.A)(T.linkList,t.neutral.accent.link),id:"meControlLinks"},e,n))),this.props.enableChangePhoto&&a.createElement(E.D,{upn:this.props.upn,userDisplayName:this.props.displayName,editPhotoPopupUrl:this.props.editPhotoPopupUrl,refreshPhoto:this.props.refreshPhoto,setChangePhoto:this.props.setChangePhoto}))}componentDidMount(){const e=(0,s.O)();let t;(0,l.NP)().subscribe("SuiteAPILoaded",(t=>{!1===t.Configuration.IsPwa&&!1===t.Configuration.IsConsumer&&t.Configuration.ExchangeDataOpxEnabled&&t.User.getOwaUserConfiguration().then((t=>{e.dispatch((0,k.My)(t.SegmentationSettings.SetPhoto))})).catch((()=>{}))}),!0),t=this.initialFocusElement?x:this.props.presenceStatus&&this.props.userPresenceStatusItems?w:this.props.links&&this.props.links.length>0?this.props.links[0].Id:this.props.signoutLink?R:"O365fp_firstFocusable",window.setTimeout((()=>{const e=document.getElementById(t);e&&e.focus()}),300)}}const N=(0,r.connect)(((e,t)=>{const n=e.meControlState;let a=[];null!=n&&(a=a.concat(n.aboutMeLink||[],n.myAccountLink||[],...n.customMenuItems||[]));let i="";null!=e.userState&&(i=e.userState.userDisplayName,i=null==i?e.userState.notManagedEmailAddress||e.userState.upn:e.userState.truncatedUserDisplayName||e.userState.userDisplayName||e.userState.upn);let r=e.userState.upn;return!r&&e.shellInitDataState.clientData.IsGuestMode&&(r=e.userState.emailAddress),{isActive:t.isActive,displayName:i,editPhotoPopupUrl:n.editPhotoPopupUrl,upn:null!=e.userState?e.userState.upn:"",memberName:r,canSetPhoto:n.canSetPhoto,links:a,signoutLink:(0,l.GJ)().disableSignout?null:n.signoutLink,flexPaneProviderID:t.flexPaneProviderID,enableChangePhoto:e.meControlState.enableChangePhoto,presenceStatus:e.meControlState.userPresenceStatus,userPresenceStatusItems:e.meControlState.userPresenceStatusItems,companyDisplayName:e.shellInitDataState.navBarData.CompanyDisplayName}}),(e=>({setChangePhoto:t=>{e((0,k.tG)(t))},refreshPhoto:(t,n)=>{e((0,k.yO)(t,n))},updatePresenceStatus:t=>{e((0,k.cX)(t))}})))(U);function L(){let e=(0,s.O)();let t=document.getElementById(d.qg);i.render(a.createElement(r.Provider,{store:e},a.createElement("div",null,a.createElement(O.A,{photoSize:32,iconFontSize:8,backGroundIconFontSize:12,iconFontClassName:T.headerPresenceIconCommonStyle,backGroundIconClassName:T.headerBackGroundIconStyle,presenceIconDivClassName:T.headerPresenceIconDiv,presenceIconDivId:"HeaderPresenceStatusIcon",onError:W,isHeaderMeControl:!0}))),t)}function F(e){let t=(0,s.O)();t.dispatch((0,u.ZM)({component:N,btnId:d.kT,key:"MeControl",width:c.x})),e&&t.dispatch((0,u.IZ)("MeControl"))}function M(){(0,s.O)().dispatch((0,u.Ig)("MeControl"))}function q(){let e=document.getElementById(d.kT);e&&(0,p.Fb)(e,`${o.hidden}`,!0)}function W(){(0,l.tZ)().tag("MePhoto_LoadError",4)}},49985:function(e,t,n){"use strict";n.d(t,{D:function(){return l}});var a=n(90872);const i=(0,n(53512)._)((()=>n.e("changephoto").then(n.bind(n,54102)).then((e=>e.ChangePhotoControl))));var r=n(16968),o=n(5232),s=n(755);class l extends a.Component{constructor(){super(...arguments),this.onChangePhotoComponentDismiss=()=>{this.props.setChangePhoto(!1);let e=document.getElementById(o.i1);e&&e.focus()},this.onChangePhotoComponentSuccess=()=>{let e="";e=s.h.Instance?s.h.Instance.getNewPhotoToken():(new Date).getTime().toString(),s.h.getPhotoUrl(this.props.upn,e).then((t=>{this.props.refreshPhoto(e,t)})).catch((e=>{(0,r.tZ)().exception("PhotoUpdateControl_GetPhotoUrl_Failed",6,e)}))},this.onChangePhotoLoadError=()=>{(0,r.tZ)().tag("MeControl_ChangePhotoControl_OnError",6)},this.onChangePhotoRenderError=()=>{(0,r.tZ)().tag("MeControl_ChangePhotoControl_RenderError",6)}}render(){return a.createElement(i,{onDismiss:this.onChangePhotoComponentDismiss,onSuccess:this.onChangePhotoComponentSuccess,onError:this.onChangePhotoLoadError,personDisplayName:this.props.userDisplayName,upn:this.props.upn,onRenderError:this.onChangePhotoRenderError,onLazyFailure:this.onChangePhotoRenderError})}}},40412:function(e,t,n){"use strict";n.d(t,{P:function(){return l}});var a=n(90872),i=n(28048),r=n(46340),o=n(22461),s=n(25462);class l extends a.Component{render(){let e,t;return null!=this.props&&null!=this.props.presenceStatus?(e=a.createElement("img",{className:(0,o.A)(this.props.iconFontClassName),src:this.props.presenceStatus.url||(0,i.ok)(this.props.presenceStatus.key),alt:this.props.presenceStatus.key}),t=this.props.backGroundIconClassName&&a.createElement(r.r,{className:(0,o.A)(this.props.backGroundIconClassName),fontIconCss:"ms-Icon--FullCircleMask",fontSize:this.props.backGroundIconFontSize.toString()})):(e=a.createElement(r.r,{className:(0,o.A)(s.chatUnknownSolid,s.statusIconCommonStyle),fontIconCss:"ms-Icon--UnknownSolid",fontSize:16..toString()}),t=a.createElement(r.r,{className:(0,o.A)(s.backGroundIconStyle),fontIconCss:"ms-Icon--FullCircleMask",fontSize:24..toString()})),a.createElement("div",{className:this.props.iconContainerClassName},e,t)}}},85273:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var a=n(69215),i=n(90872),r=n(40141),o=n(10806),s=n(46340),l=n(22461),c=n(5232),u=n(40412),p=n(13943);class d extends i.PureComponent{constructor(e){super(e),this.onError=()=>{this.setState({imgError:!0}),this.props.onError&&this.props.onError()},this.onLoad=()=>{this.setState({imgError:!1}),this.props.onLoad&&this.props.onLoad()},this.state={imgError:!0}}componentDidUpdate(e){this.props.isHeaderMeControl&&this.props.flexPaneDisplayed!==e.flexPaneDisplayed&&document.getElementById(c.kT).setAttribute("aria-expanded",this.props.flexPaneDisplayed.toString())}render(){let e={},t={};if(this.props.photoSize){let n=this.props.isHeaderMeControl?32:this.props.photoSize;e={width:n+"px",height:n+"px"},t.fontSize=this.props.photoSize/2+"px"}let n=this.props.firstName&&this.props.lastName?(0,a.I)(this.props.firstName.concat(" ",this.props.lastName),this.props.isRtl):(0,a.I)(this.props.displayName,this.props.isRtl),d=(0,r.e)(),h=i.createElement("div",null,i.createElement("div",{className:(0,l.A)(p.mePhotoContainer,this.props.className),style:e},null!=n&&n.length?i.createElement("div",{id:"meInitialsButton",style:t,className:this.props.isHeaderMeControl?(0,l.A)(p.meInitials,p.meInitialsThemed,d.headerButton,d.highContrastButton):this.props.isFlexPane?(0,l.A)(p.meInitials,p.meFlexPane):(0,l.A)(p.meInitials),"aria-hidden":null!==this.props.photoUrl},this.props.isHeaderMeControl?n:i.createElement("span",null,n)):i.createElement(s.r,{fontIconCss:"ms-Icon--Contact",className:this.props.isHeaderMeControl?(0,l.A)(p.headerDoughboy):this.props.isFlexPane?(0,l.A)(p.doughboy,p.meFlexPane):(0,l.A)(p.doughboy)}),i.createElement("div",{className:(0,l.A)(p.mePhoto)},i.createElement("img",{style:{display:this.state.imgError?"none":""},src:this.props.photoUrl,onLoad:this.onLoad,onError:this.onError,alt:n||""}))),this.props.presenceStatus&&i.createElement("div",{id:this.props.presenceIconDivId,className:this.props.presenceIconDivClassName},i.createElement(u.P,{presenceStatus:this.props.presenceStatus,iconFontSize:this.props.iconFontSize,backGroundIconFontSize:this.props.backGroundIconFontSize,iconFontClassName:this.props.iconFontClassName,backGroundIconClassName:this.props.backGroundIconClassName})));if(this.props.isHeaderMeControl){let e=document.getElementById(c.kT);return i.createElement(o.e,{controlID:c.kT,isActive:this.props.flexPaneDisplayed,controlElement:e},h)}return h}}},755:function(e,t,n){"use strict";n.d(t,{h:function(){return u}});var a=n(16968);class i{constructor(e,t){this.userPhotoSessionStorageTokenName=e,this.cachingEnabled=t,(0,a.NP)().subscribe("SignOut",(()=>this.removeCachedPhotoToken())),(0,a.NP)().subscribe("ClearUserCache",(()=>this.removeCachedPhotoToken()))}getCachedPhotoToken(){if(this.cachingEnabled&&null!=sessionStorage)try{return sessionStorage.getItem(this.userPhotoSessionStorageTokenName)}catch(e){}return null}getNewPhotoToken(){const e=(new Date).getTime().toString();return this.alwaysReload()||this.cachePhotoToken(e),e}cachePhotoToken(e){if(this.cachingEnabled&&null!=sessionStorage)try{sessionStorage.setItem(this.userPhotoSessionStorageTokenName,e)}catch(e){}}removeCachedPhotoToken(){if(this.cachingEnabled&&null!=sessionStorage)try{sessionStorage.removeItem(this.userPhotoSessionStorageTokenName)}catch(e){}}}var r=n(87948);function o(e,t){return new Promise(((n,i)=>{e.Configuration.GraphOauthResourceUrl&&e.User.getPhotoFromGraph(t).then((e=>{let t=(0,r.vQ)(e)?"":"data:image/jpeg;base64,"+e;n(t)})).catch((e=>{(0,a.tZ)().exception("GetPhotoFromGraphAPI_Failed",6,e),i(e)}))}))}class s extends i{constructor(e,t){super(s.UserPhotoSessionStorageTokenName,t),this.suiteApiInstance=e,this.cachingEnabled=t}alwaysReload(){return!0}getUserPhotoUrl(e,t){return new Promise(((t,n)=>{o(this.suiteApiInstance,e).then((e=>{t(e)})).catch((e=>{(0,a.tZ)().exception("GraphPhotoLoader_GetPhotoUrl_Failed",6,e),n(e)}))}))}}s.UserPhotoSessionStorageTokenName="UserPhotoToken";class l extends i{constructor(e,t){super(l.UserPhotoSessionStorageTokenName,!0),this.width=e,this.height=t,this.ConsumerPhotoWin8StaticSizeParams="Win8Static,UserTileMedium,UserTileStatic,UserTileSmall",this.ConsumerPhotUserTileMediumSizeParams="UserTileMedium,UserTileStatic,UserTileSmall",this.ConsumerPhotoUserTileStaticSizeParams="UserTileStatic,UserTileSmall",this.ConsumerPhotoUserTileSmallSizeParams="UserTileSmall",this.ConsumerUserTileSmallSize=21,this.ConsumerUserTileStaticSize=96,this.ConsumerUserTileMediumSize=180}alwaysReload(){return!0}getUserPhotoUrl(e,t=""){return new Promise((e=>{let n=this.getConsumerPictureSize(this.width,this.height);e((0,r.JT)("https://storage.live.com/mydata/myprofile/expressionprofile/profilephoto:{0}/MeControlMediumUserTile?ck=1&ex=24&fofoff=1&sc={1}",n,t))}))}getConsumerPictureSize(e,t){let n=Math.max(e,t);return n<this.ConsumerUserTileSmallSize?this.ConsumerPhotoUserTileSmallSizeParams:n<this.ConsumerUserTileStaticSize?this.ConsumerPhotoUserTileStaticSizeParams:n<this.ConsumerUserTileMediumSize?this.ConsumerPhotUserTileMediumSizeParams:this.ConsumerPhotoWin8StaticSizeParams}}l.UserPhotoSessionStorageTokenName="UserPhotoToken";class c extends i{constructor(e,t){super(c.UserPhotoSessionStorageTokenName,t),this.suiteApiInstance=e,this.cachingEnabled=t}alwaysReload(){return!0}getUserPhotoUrl(e,t){return new Promise(((e,t)=>{let n=(0,a.GJ)();n.mePhotoSource&&""!==n.mePhotoSource?e(n.mePhotoSource):this.suiteApiInstance.Configuration.GraphOauthResourceUrl?o(this.suiteApiInstance,"").then((t=>{e(t)})).catch((e=>{(0,a.tZ)().exception("PWAUserPhotoLoader_GetGraphPhotoUrl_Failed",6,e),t(e)})):t("PWAUserPhotoLoader_GetPhotoUrl_Failed")}))}}c.UserPhotoSessionStorageTokenName="UserPhotoToken";class u{static Initialize(e,t){return new Promise((n=>{null==u.Instance&&(0,a.NP)().subscribe("SuiteAPILoaded",(a=>{a.Configuration.IsPwa?this.Instance=new c(a,t):this.Instance=e?new l(70,70):new s(a,t),n(null)}),!0)}))}static getPhotoUrl(e,t=""){return new Promise(((n,a)=>{u.Instance?n(u.Instance.getUserPhotoUrl(e,t)):a("PhotoUrlLoader_GetPhotoUrl_Failed")}))}}},73948:function(e,t,n){"use strict";n.d(t,{A:function(){return o}});var a=n(91112),i=n(87948),r=n(85273);const o=(0,a.connect)(((e,t)=>({displayName:t.displayName||e.meControlState.displayName,firstName:e.meControlState.firstName,lastName:e.meControlState.lastName,upn:e.userState.upn,photoCacheToken:e.meControlState.photoCacheToken,className:t.className||"",onError:(0,i.vQ)(e.meControlState.photoUrl)?null:t.onError,onLoad:t.onLoad,photoUrl:e.meControlState.photoUrl,photoSize:t.photoSize,isConsumerShell:e.userState.isConsumer,isRtl:null!=e.userState&&e.userState.isRtl,mePhotoCachingDisabled:e.meControlState.mePhotoCachingDisabled,suiteServiceUrl:e.meControlState.suiteServiceUrl,presenceStatus:e.meControlState.userPresenceStatus,flexPaneDisplayed:e.flexPaneState&&"MeControl"===e.flexPaneState.activeProviderKey||!1})),{})(r.a)},10682:function(e,t,n){"use strict";n.d(t,{My:function(){return o},Zi:function(){return s},c1:function(){return p},cX:function(){return u},e4:function(){return r},jX:function(){return d},oZ:function(){return l},tG:function(){return c},yO:function(){return i}});var a=n(54386);function i(e,t){return{cacheToken:e,mePhotoUrl:t,type:a.HI}}function r(e){return{url:e,type:a.t8}}function o(e){return{setPhoto:e,type:a.zm}}function s(e){return{displayName:e,type:a.Lb}}function l(e,t){return{firstName:e,lastName:t,type:a.SX}}function c(e){return{enablePhotoChange:e,type:a.Rj}}function u(e){return{type:a.XB,presenceStatus:e}}function p(e){return{type:a.gI,presenceStatusList:e}}function d(e){return{type:a.Fx,isMeControlAPIInitialized:e}}},54386:function(e,t,n){"use strict";n.d(t,{Fx:function(){return p},HI:function(){return a},Lb:function(){return o},Rj:function(){return i},SX:function(){return s},XB:function(){return c},gI:function(){return u},t8:function(){return l},zm:function(){return r}});const a="suiteux-mecontrol.REFRESH_PHOTO",i="suiteux-mecontrol.CHANGEPHOTO",r="suiteux-mecontrol.UPDATE_POLICIES",o="suiteux-mecontrol.UPDATE_DISPLAY_NAME",s="suiteux-mecontrol.UPDATE_FIRST_AND_LAST_NAME",l="suiteux-mecontrol.SET_ME_PHOTO_URL",c="suiteux-mecontrol.UPDATE_USER_PRESENCE_STATUS",u="suiteux-mecontrol.UPDATE_USER_PRESENCE_STATUS_LIST",p="suiteux-mecontrol.UPDATE_IS_MECONTROL_API_INITIALIZED"},64386:function(e,t,n){"use strict";var a;n.d(t,{c:function(){return a}}),function(e){e[e.SystemAlert=0]="SystemAlert",e[e.ReminderNotification=1]="ReminderNotification"}(a||(a={}))},70796:function(e,t,n){"use strict";var a=n(24126),i=n(16968),r=n(87948),o=n(66164);let s=!1;class l{Init(e,t,n,a,r){s||(s=!0,this.Timeout=e,this.SigninState=t,this.Controls=n,this.SessionId=a,this.DisableTrackEvents=r,(0,i.NP)().subscribe("ShellDataUpdated",c,!0))}}function c(e,t){t.PUID?(t.AuthAbtEnabled&&(s=!0,window.LoadAbtPromptJs={Download:u},n.e("abt").then(n.bind(n,84760)).then((n=>{let a=null==n?void 0:n.Environment.WorldWide;(0,r.d5)(t.Environment.toLowerCase(),"tbprod")?a=null==n?void 0:n.Environment.Trailblazer:(0,r.d5)(t.Environment.toLowerCase(),"pfprod")&&(a=null==n?void 0:n.Environment.Pathfinder),null==n||n.AbtMainOperations.initializeAbt({market:e.CultureName||"en-US",workloadName:(0,o.ic)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL),environment:a,userId:t.PUID,authType:t.IsConsumerShell?null==n?void 0:n.AuthType.Msa:null==n?void 0:n.AuthType.Aad,timeout:window.O365Shell.Abt.Timeout,trackEvents:!window.O365Shell.Abt.DisableTrackEvents,enableLogging:!0,sessionId:window.O365Shell.Abt.SessionId,tenantId:t.TID,signInState:window.O365Shell.Abt.SigninState,controls:window.O365Shell.Abt.Controls,allowedCookieFailureTimes:2})}))),(0,i.NP)().unsubscribe("ShellDataUpdated",c)):(0,i.tZ)().tag("ABT_NoPUIDFound",4,null,null)}function u(e){n.e("abtprompt").then(n.t.bind(n,30802,23)).then((t=>{e&&e()}))}var p=n(90872),d=n(9028),h=n(91112),m=n(95144),g=n(22331),S=n(93814),f=n(16533),y=n(3709),C=n(79627),I=n(7667),v=n(50954),A=n(89682),T=n(61304),b=n(55797),w=n(95797),D=n(65599);function P(e){return new Promise(((t,n)=>{let r=(0,m.JT)("/api/myapps/GetIcon?appDataJson={0}",encodeURIComponent(JSON.stringify({Id:e.Id,CollectorId:e.CollectorId,Properties:e.Properties})));b.F.Instance.Service.callWebClientShellServiceFunction(r,"GET",null,null).then((e=>{t(e)})).catch((e=>{a.F2.isCallsBlockedException(e)||(0,i.tZ)().exception("AppsManager_GetAppIcon_Failed",6,e),n(e)}))}))}const O="AppsPinnedData",k=["FirstParty","SharePoint","Graph","LineOfBusiness","Dynamics"];class E extends p.Component{constructor(){super(...arguments),this.lastAppsPinnedDataWriteTimestampKey=new D.Zg("User","Suite","LastAppsPinnedDataWriteTimestamp"),this.cachedAppsDataKey=new D.Zg("User","Suite","CachedAppsData")}componentDidMount(){window.O365Shell.OnSuiteAPILoaded((()=>{this.initializeEcsConfig(),this.renderSettings=(0,i.GJ)(),this.initializeInternal()}))}initializeEcsConfig(){try{(0,v.l)().getConfig().then((e=>{e&&(this.oneShellECSConfig=e,e.CopilotBannerLoaderEnabled||this.loadCopilotBannerConfiguration())}))}catch(e){(0,i.tZ)().exception("AppsManager_InitializeEcsConfig_Failed",6,e)}}componentDidUpdate(e){if(this.props.appsPinnedData&&e.appsPinnedData&&this.props.appsPinnedData!==e.appsPinnedData&&(!this.props.appsPinnedData.timestamp||!e.appsPinnedData.timestamp||this.props.appsPinnedData.timestamp>=e.appsPinnedData.timestamp)){this.hasAppsPinnedDataChanged(e.appsPinnedData)&&this.saveCustomization()}}render(){return null}initializeInternal(){var e;const{appsPinnedData:t}=this.props,n=(0,i.GJ)(),a=n&&n.m365CopilotRebrandingEnabled?null===T.D||void 0===T.D?void 0:T.D.M365AppTileDetailsM365Copilot:null===T.D||void 0===T.D?void 0:T.D.M365AppTileDetails;this.props.disableSessionStorageCache&&!(null===(e=this.renderSettings)||void 0===e?void 0:e.enableSessionStorageForPWA)?this.updateAppsFromStorage():null!=t?Date.now()-this.props.timestamp<6e4?this.readLastAppsPinnedDataWriteTimestampFromSessionStorageAsync().then((e=>{e&&t.timestamp<e?this.readAppsPinnedData(1):this.updateApps(t,!0)})).catch((()=>{this.readAppsPinnedData(3)})):this.readAppsPinnedData(2):this.readAppsPinnedData(0);const r=(0,i.NP)();r.subscribe("AppIconRequested",(e=>{P(e).then((t=>{this.props.onSetImageDataUrl(e.CollectorId,e.Id,`data:${t.MimeType};base64,${t.Base64EncodedImage}`)})).catch((()=>{}))})),r.subscribe("AppDataDetailsRequested",(e=>{e.Id===A.Rh?this.props.onSetAppDataDetails({CollectorId:"none",Details:a,EulaUrl:null,HomepageUrl:null,PrivacyUrl:null,SupportUrl:null,Publisher:null,Permissions:null,Id:A.Rh}):this.getAppDataDetailsAsync(e).then((t=>{t.CollectorId=e.CollectorId,this.props.onSetAppDataDetails(t)})).catch((()=>{}))}),!0),r.subscribe("AppsReset",(()=>{this.props.onSetAppsPinnedData({apps:[]})})),r.subscribe("AppsUpdate",(()=>{this.updateAppsFromCollectors()}))}loadCopilotBannerConfiguration(){return(0,f.__awaiter)(this,void 0,void 0,(function*(){var e,t;try{const n=this.props.cultureName.split("-"),a=this.props.cultureName,i=n.length>1?n[1]:"US";let r=null;if((null===(e=this.oneShellECSConfig)||void 0===e?void 0:e.M365CopilotBannerEnabled)?r=A.C$:(null===(t=this.oneShellECSConfig)||void 0===t?void 0:t.M365CopilotBannerSelfHostInternalEnabled)&&(r=A.G4),!r)return;const o=yield w.D.getCopilotCreative(r,a,i),s={designOption:o.designOption,rowStart:o.rowStart,title:o.title,description:o.description,buttonText:o.buttonText,impressionUrl:o.impressionUrl,actionUrl:o.buildTrackingUrl("Click"),buttonURL:o.buttonURL};this.props.onSetM365CopilotBannerData(s)}catch(e){(0,i.tZ)().exception("AppsManager_LoadCopilotBannerConfiguration_Failed",6,e)}}))}readAppsPinnedData(e){var t;const n=(null===(t=this.renderSettings)||void 0===t?void 0:t.GetAppState)instanceof Function?this.renderSettings.GetAppState():"Unknown";this.readAppsPinnedDataFromStorageAsync().then((e=>{this.updateApps(e,!0)})).catch((()=>{this.updateApps(this.props.appsPinnedData,!1),(0,i.tZ)().tag("AppsManager_ReadAppsPinnedDataFromStorageReason",1,e,`APP_STATE: ${n}`)}))}handleAppCollectorError(e){switch(e.errorCode){case-1005:this.invokeAppsUpdatedEventWithFailure(6);break;case-1007:this.invokeAppsUpdatedEventWithFailure(7);break;case-1013:this.invokeAppsUpdatedEventWithFailure(8);break;case-1014:this.invokeAppsUpdatedEventWithFailure(9);break;case-1015:this.invokeAppsUpdatedEventWithFailure(10);break;case-1019:this.invokeAppsUpdatedEventWithFailure(11);break;case-1003:const t=Number(e.HttpStatus);if(!isNaN(t)){if(t>=500){this.invokeAppsUpdatedEventWithFailure(5);break}if(t>=400){this.invokeAppsUpdatedEventWithFailure(4);break}}default:this.invokeAppsUpdatedEventWithFailure(3)}}updateApps(e,t){e&&e!==this.props.appsPinnedData&&void 0!==e.apps&&this.props.onSetAppsPinnedData(e),t&&this.props.onEnableCustomization(),this.readCachedAppsFromSessionStorageAsync().then((e=>{if(e){if(Date.now()-e.timestamp>this.props.appsUpdateTimeSpan||e.cultureName!==this.props.cultureName)this.updateAppsFromStorage();else{let t=!0;this.props.appDataCache&&!this.props.moreAppDataAvailable&&this.props.timestamp>=e.timestamp&&(t=!1),t&&this.updateMyApps(e.apps,1)}}else this.updateAppsFromStorage()})).catch((()=>{this.updateAppsFromStorage()}))}updateAppsFromStorage(){this.props.appDataCache&&!this.props.moreAppDataAvailable?this.updateAppsFromCollectors():this.readAppDataCacheFromStorageAsync().then((e=>{this.onReadAppDataCacheSucceeded(e)})).catch((()=>{this.updateAppsFromCollectors()}))}onReadAppDataCacheSucceeded(e){const t={};for(const n of k){const a=e[n];if(a&&a.Apps)t[n]=a.Apps;else{const e=this.props.appsData.filter((e=>e.CollectorId===n));e.length>0&&(t[n]=e)}}this.onAppDataDictionaryFetched(t,2),this.updateAppsFromCollectors()}updateAppsFromCollectors(){this.props.doNotCallGetAllAppsUntil&&this.props.doNotCallGetAllAppsUntil>Date.now()||(this.props.ShowConditionalAccessError?this.getAllApplicationsWithErrorDetailsAsync().then((e=>{const{appDataDictionary:t,ConditionalAccessErrors:n}=e;this.onGetAllAppsSucceeded(t),n&&n.length>0&&n.forEach((e=>{var t;let n=["ConditionalAccessErrorDetails:",e.errorCode?`  ErrorCode: ${e.errorCode}`:"",e.policyIds&&e.policyIds.length>0?`  PolicyIds: ${e.policyIds.join(", ")}`:"",e.requirementValues&&e.requirementValues.length>0?`  RequirementValues: ${e.requirementValues.join(", ")}`:"",e.affectedApp?`  AffectedApp: ${e.affectedApp}`:""].filter(Boolean).join("\n");n=n.replace(/\n/g," ");const a=(null===(t=this.renderSettings)||void 0===t?void 0:t.GetAppState)instanceof Function?this.renderSettings.GetAppState():"Unknown";(0,i.tZ)().tag("AppsManager_SavingConditionalAccessErrorDetails",6,n,`APP_STATE: ${a}`)}))})).catch((e=>{this.handleAppCollectorError(e)})):this.getAllAppsFromCollectorsAsync().then((e=>{this.onGetAllAppsSucceeded(e)})).catch((e=>{this.handleAppCollectorError(e)})))}invokeAppsUpdatedEventWithFailure(e){this.invokeAppsUpdatedEvent(null,0,e)}onGetAllAppsSucceeded(e){if(0!==Object.keys(e).length){for(const t of k){if(!e[t]){const n=this.props.appsData.filter((e=>e.CollectorId===t));n.length>0&&(e[t]=n)}}this.onAppDataDictionaryFetched(e,3)}}onAppDataDictionaryFetched(e,t){e.FirstParty&&(e.FirstParty=this.getFirstPartyAppsFromAppsData(this.props.appsData,e.FirstParty)),this.updateMyApps(e,t),this.writeCachedAppsToSessionStorageAsync({timestamp:Date.now(),apps:e,cultureName:this.props.cultureName}).catch((()=>{}))}getFirstPartyAppsFromAppsData(e,t){const n=[];for(const a of e.filter((e=>"FirstParty"===e.CollectorId))){const e=(0,C.J0)(t,"FirstParty",a.Id);null!=e&&(a.AlternateNames=e.AlternateNames,a.DateInstalled=e.DateInstalled),n.push(a)}if(!n.some((e=>"Partner"===e.Id))){const e=(0,C.J0)(t,"FirstParty","Partner");null!=e&&n.push(e)}return n}updateMyApps(e,t){const n=this.aggregateAppDatas(e);this.props.onSetAppsData(n,t)}invokeAppsUpdatedEvent(e,t,n){const a={Apps:e,DataSource:t,FailureReason:n},r=null!=e?"AppsRetrievalSucceeded":"AppsRetrievalFailed";(0,i.NP)().invoke(r,a)}hasAppsPinnedDataChanged(e){if(void 0===this.props.appsPinnedData.apps)return!1;const t=this.props.appsPinnedData.apps,n=e.apps;if(t.length!==n.length)return!0;for(let e=0;e<t.length;e++)if(t[e].CollectorId!==n[e].CollectorId||t[e].Id!==n[e].Id)return!0;return!1}saveCustomization(){var e,t;const n=this.props.appsPinnedData.apps.map((e=>e.Id)),a=(null===(e=this.renderSettings)||void 0===e?void 0:e.GetAppState)instanceof Function?this.renderSettings.GetAppState():"Unknown";(0,i.tZ)().tag("AppsManager_SavingAppsCustomizationData",1,n.join(),`APP_STATE: ${a}`);const r=Date.now();if("number"==typeof r)this.props.appsPinnedData.timestamp=r,this.props.appsPinnedData.cultureName=this.props.cultureName,this.writeAppsPinnedDataToStorageAsync(this.props.appsPinnedData).then((()=>{this.writeLastAppsPinnedDataWriteTimestampToSessionStorageAsync(this.props.appsPinnedData.timestamp).catch((()=>{}))})).catch((()=>{}));else{let e=null;try{e=Date.now.toString()}catch(e){}const n=(null===(t=this.renderSettings)||void 0===t?void 0:t.GetAppState)instanceof Function?this.renderSettings.GetAppState():"Unknown";(0,i.tZ)().tag("AppsManager_InvalidDateNowFunction",6,r,e,`APP_STATE: ${n}`)}}aggregateAppDatas(e){const t=[];for(const n of Object.keys(e))e[n]&&t.push(...e[n]);return t}readLastAppsPinnedDataWriteTimestampFromSessionStorageAsync(){return new Promise(((e,t)=>{const n=b.F.Instance.WebShellStorage.createWebShellStorageRequest();n.requestRead(this.lastAppsPinnedDataWriteTimestampKey),b.F.Instance.WebShellStorage.readSessionStorage(n).then((t=>{t.hasValue(this.lastAppsPinnedDataWriteTimestampKey)?e(t.getValue(this.lastAppsPinnedDataWriteTimestampKey)):e(null)})).catch((e=>{var n;const a=(null===(n=this.renderSettings)||void 0===n?void 0:n.GetAppState)instanceof Function?this.renderSettings.GetAppState():"Unknown";(0,i.tZ)().exception("AppsManager_ReadLastAppsPinnedDataWriteTimestamp_Failed",6,e,`APP_STATE: ${a}`),t(e)}))}))}writeLastAppsPinnedDataWriteTimestampToSessionStorageAsync(e){return new Promise(((t,n)=>{const a=b.F.Instance.WebShellStorage.createWebShellStorageRequest();a.requestWrite(e,this.lastAppsPinnedDataWriteTimestampKey),b.F.Instance.WebShellStorage.writeSessionStorage(a).then((()=>{t(void 0)})).catch((e=>{(0,y.genericServiceRejection)("AppsManager_WriteLastAppsPinnedDataWriteTimestamp_Failed",6,e,n)}))}))}readAppsPinnedDataFromStorageAsync(){return new Promise(((e,t)=>{b.F.Instance.WebShellStorage.readStorage(D.ir.User,D.bQ.SystemMetadata,O).then((t=>{const n=t.value;n&&"string"==typeof n.timestamp&&(n.timestamp=(0,I._)(n.timestamp).getTime()),e(n)})).catch((e=>{(0,y.genericServiceRejection)("AppsManager_ReadPinnedAppsData_Failed",6,e,t)}))}))}writeAppsPinnedDataToStorageAsync(e){var t;if(e&&e.apps){const n=e.apps.length;if(e.apps=(0,C.Wb)(e.apps),n>e.apps.length){const a=(null===(t=this.renderSettings)||void 0===t?void 0:t.GetAppState)instanceof Function?this.renderSettings.GetAppState():"Unknown";(0,i.tZ)().tag("AppsManager_WriteAppsPinnedData_Deduped",4,n,e.apps.length,`APP_STATE: ${a}`)}}return new Promise(((t,n)=>{b.F.Instance.WebShellStorage.writeStorage(D.ir.User,D.bQ.SystemMetadata,O,e).then((()=>{t(void 0)})).catch((e=>{var t;if(!(0,y.isCallsBlockedException)(e)){const n=(null===(t=this.renderSettings)||void 0===t?void 0:t.GetAppState)instanceof Function?this.renderSettings.GetAppState():"Unknown";(0,i.tZ)().exception("AppsManager_WriteAppsPinnedData_Failed",6,e,`APP_STATE: ${n}`)}n(e)}))}))}readAppDataCacheFromStorageAsync(){return new Promise(((e,t)=>{const n=(0,r.JT)("/api/myapps/GetAppDataCache?hasMailboxInCloud={0}&culture={1}",this.props.hasMailboxInCloud.toString(),this.props.cultureName);b.F.Instance.Service.callWebClientShellServiceFunction(n,"GET",null,null).then((t=>{e(t)})).catch((e=>{var n;if(!(0,y.isCallsBlockedException)(e)){const t=(null===(n=this.renderSettings)||void 0===n?void 0:n.GetAppState)instanceof Function?this.renderSettings.GetAppState():"Unknown";(0,i.tZ)().exception("AppsManager_ReadAppDataCacheFromWCSS_Failed",6,e,`ErrorCode: ${e.errorCode}`,`ErrorMessage: ${e.message}`,`APP_STATE: ${t}`)}t(e)}))}))}getAllAppsFromCollectorsAsync(){return new Promise(((e,t)=>{var n;const a=(0,r.JT)("/api/myapps/GetAllApps?culture={0}",this.props.cultureName);b.F.Instance.Service.callWebClientShellServiceFunction(a,"GET",null,null,null===(n=this.oneShellECSConfig)||void 0===n?void 0:n.TimeOutForAppsRequest).then((t=>{e(t)})).catch((e=>{var n;if(!(0,y.isCallsBlockedException)(e)){const t=(null===(n=this.renderSettings)||void 0===n?void 0:n.GetAppState)instanceof Function?this.renderSettings.GetAppState():"Unknown";(0,i.tZ)().exception("AppsManager_AppCollectorFetch_Failed",6,e,`ErrorCode: ${e.errorCode}`,`ErrorMessage: ${e.message}`,`APP_STATE: ${t}`)}t(e)}))}))}getAllApplicationsWithErrorDetailsAsync(){return new Promise(((e,t)=>{var n;const a=(0,r.JT)("/api/myapps/GetAllApplications?culture={0}",this.props.cultureName);b.F.Instance.Service.callWebClientShellServiceFunction(a,"GET",null,null,null===(n=this.oneShellECSConfig)||void 0===n?void 0:n.TimeOutForAppsRequest).then((n=>{n?(Array.isArray(n.ConditionalAccessErrors)||(n.ConditionalAccessErrors=n.ConditionalAccessErrors?[n.ConditionalAccessErrors]:[]),n.ConditionalAccessErrors=n.ConditionalAccessErrors.map((e=>Object.assign(Object.assign({},e),{policyIds:Array.isArray(e.policyIds)?e.policyIds:e.policyIds?[e.policyIds]:[],requirementValues:Array.isArray(e.requirementValues)?e.requirementValues:e.requirementValues?[e.requirementValues]:[]}))),e(n)):t(new Error("GetAllApplications API response is null or undefined"))})).catch((e=>{var n;if(!(0,y.isCallsBlockedException)(e)){const t=(null===(n=this.renderSettings)||void 0===n?void 0:n.GetAppState)instanceof Function?this.renderSettings.GetAppState():"Unknown";(0,i.tZ)().exception("AppsManager_AppCollectorFetch_Failed",6,e,`ErrorCode: ${e.errorCode}`,`ErrorMessage: ${e.message}`,`APP_STATE: ${t}`)}t(e)}))}))}readCachedAppsFromSessionStorageAsync(){return new Promise(((e,t)=>{const n=b.F.Instance.WebShellStorage.createWebShellStorageRequest();n.requestRead(this.cachedAppsDataKey),b.F.Instance.WebShellStorage.readSessionStorage(n).then((t=>{t.hasValue(this.cachedAppsDataKey)?e(t.getValue(this.cachedAppsDataKey)):e(void 0)})).catch((e=>{var n;if(!(0,y.isCallsBlockedException)(e)){const t=(null===(n=this.renderSettings)||void 0===n?void 0:n.GetAppState)instanceof Function?this.renderSettings.GetAppState():"Unknown";(0,i.tZ)().exception("AppsManager_ReadCacheAppsData_Failed",6,e,e.errorCode,`APP_STATE: ${t}`)}t(e)}))}))}writeCachedAppsToSessionStorageAsync(e){return new Promise(((t,n)=>{const a=b.F.Instance.WebShellStorage.createWebShellStorageRequest();a.requestWrite(e,this.cachedAppsDataKey),b.F.Instance.WebShellStorage.writeSessionStorage(a).then((()=>{t(void 0)})).catch((e=>{(0,y.genericServiceRejection)("AppsManager_WriteCacheAppsData_Failed",6,e,n)}))}))}getAppDataDetailsAsync(e){return new Promise(((t,n)=>{const a=(0,r.JT)("/api/myapps/GetAppDetails?culture={0}",this.props.cultureName),o={CollectorId:e.CollectorId,Id:e.Id,Title:e.Title,Properties:e.Properties};b.F.Instance.Service.callWebClientShellServiceFunction(a,"POST",null,o).then((e=>{t(e)})).catch((e=>{var t;if(!(0,y.isCallsBlockedException)(e)){const n=(null===(t=this.renderSettings)||void 0===t?void 0:t.GetAppState)instanceof Function?this.renderSettings.GetAppState():"Unknown";(0,i.tZ)().exception("Apps_FetchDetailsForCollector_Failed",6,e,`APP_STATE: ${n}`)}n(e)}))}))}}const R=(0,h.connect)((e=>({appsData:e.appsDataState.apps,appsPinnedData:e.appLauncherState.appsPinnedData,cultureName:e.userState.cultureName,timestamp:e.appsManagerState.timestamp,appsUpdateTimeSpan:e.appsManagerState.appsUpdateTimeSpan,hasMailboxInCloud:e.userState.hasMailboxInCloud,appDataCache:e.appsManagerState.appDataCache,moreAppDataAvailable:e.appsManagerState.moreAppDataAvailable,doNotCallGetAllAppsUntil:e.appsManagerState.doNotCallGetAllAppsUntil,ShowConditionalAccessError:e.appsManagerState.ShowConditionalAccessError,disableSessionStorageCache:(0,o.bi)(e.shellInitDataState.clientData.WorkloadId,e.shellInitDataState.navBarData.CurrentMainLinkElementID)})),(e=>({onSetAppsData:(t,n)=>{e((0,S.Zd)(t,n))},onSetAppsPinnedData:t=>{e((0,g.J8)(t))},onEnableCustomization:()=>{e((0,g.J9)())},onSetImageDataUrl:(t,n,a)=>{e((0,S.Rm)(t,n,a))},onSetAppDataDetails:t=>{e((0,g.ic)(t))},onSetM365CopilotBannerData:t=>{e((0,S.zh)(t))}})))(E);function x(e,t){return t?Object.assign(Object.assign({},e),{appsUpdateTimeSpan:t.AppsUpdateTimeSpan,timestamp:t.Timestamp,appDataCache:t.AppDataCache,moreAppDataAvailable:t.MoreAppDataAvailable,doNotCallGetAllAppsUntil:t.DoNotCallGetAllAppsUntil,ShowConditionalAccessError:t.ShowConditionalAccessError}):e}let U={appsManagerState:function(e,t){if(!e){let n=t.shellInitData.shellInitDataState;e=x(m.Rz,n.clientData)}if(t.type===m.l5){return x(e,t.shellClientData)}return e}};var N=n(26335),L=n(54888);let F=(0,m.OU)();class M{constructor(){this.callbackPairings=[]}IsCustomizationEnabled(){return F.getState().appLauncherState.isCustomizable}IsPinned(e,t){return null!=L.Ro(F.getState().appLauncherState.pinnedAppTiles,e,t)}Pin(e,t){let n;"string"==typeof e?n=C.J0(F.getState().appsDataState.apps,e,t):((0,i.tZ)().tag("AppLauncher_PinnedCalledWithAppData",1),n=C.J0(F.getState().appsDataState.apps,e.CollectorId,e.Id)),n&&F.dispatch((0,N.L4)(n))}Unpin(e,t){F.dispatch((0,N.Ud)(e,t))}Reset(){(0,i.NP)().invoke("AppsReset")}Update(){(0,i.NP)().invoke("AppsUpdate")}OnAppsUpdated(e){let t=t=>{e(this.deepCloneAppsUpdatedEventArgs(t))},n=(0,i.NP)(),a=n.subscribe("AppsRetrievalSucceeded",t,!0),r=n.subscribe("AppsRetrievalFailed",t,!0);return this.callbackPairings.push({successCallbackToken:a,failureCallbackToken:r}),a}RemoveOnAppsUpdated(e){let t=0,n=(0,i.NP)();for(let a of this.callbackPairings){if(a.successCallbackToken===e){n.unsubscribe("AppsRetrievalSucceeded",a.successCallbackToken),n.unsubscribe("AppsRetrievalFailed",a.failureCallbackToken);break}t++}t<this.callbackPairings.length&&this.callbackPairings.splice(t,1)}GetAuthenticatedAppIcon(e,t){null==e.FontIconCss&&null==e.IconAnonymousUrl?P(e).then(t).catch((()=>{t(null)})):t(null)}deepCloneAppsUpdatedEventArgs(e){let t=JSON.parse(JSON.stringify(e));if(t.Apps)for(let e of t.Apps)"FirstParty"===e.CollectorId&&(e.Id=C.w(e.Id,"add"));return t}}function q(e,t){if(e.IsAuthenticated&&t.Timestamp>0){(0,i.NP)().unsubscribe("ShellDataUpdated",q);let e=(0,m.OU)();d.render(p.createElement(h.Provider,{store:e},p.createElement(R,null)),document.createElement("div"))}}var W=n(99542),_=n(89959),G=n(50003),B=n(29081);function H(e,t,n){return Object.assign(Object.assign({},e),{webChatSDKUrl:t.WebChatSDKUrl||null,chatWebLink:t.ChatWebLink||null,chatEnabled:!!t.ChatEnabled&&!m.B3.isMobileClient(),isConsumerShell:t.IsConsumerShell,chatButtonRenderedCallback:n.chatButtonRenderedCallback})}const Z={chatState:function(e,t){if(!e){const n=t.shellInitData.shellInitDataState;e=H(m.P3,n.clientData||{},n.renderSettings||{})}switch(t.type){case m.l5:const n=t;return H(e,n.shellClientData,n.renderSettings);case m.ui:return function(e,t){const n=t;e.isConsumerShell&&(0,G.Cg)(n.isRecentsOpen,e.isTeamsChatActivated);return Object.assign(Object.assign({},e),{isChatRecentsPaneOpen:n.isRecentsOpen})}(e,t);case B.wW:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{isChatRecentsPaneInitialized:n.isRecentsInitialized})}(e,t);case B.I2:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{isChatAPIInitialized:n.isChatAPIInitialized})}(e,t);case B.q4:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{unreadBadgeValue:n.unreadBadgeValue})}(e,t);case B.$6:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{isTeamsChatActivated:n.isTeamsChatActivated})}(e,t);case B.ij:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{initChatOnFirstClick:n.initChatOnFirstClick})}(e,t);case B.Kx:return function(e){return Object.assign(Object.assign({},e),{isTeamsChatAuthFailed:!0})}(e);case B.FQ:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{isChatAPIPreAuthCompleted:n.isChatAPIPreAuthCompleted})}(e,t);default:return e}}};let z=!1;function j(e,t){if(t.ChatEnabled&&!z){z=!0;let e=(0,m.OU)(),t=(0,i.GJ)()&&(0,i.GJ)().layout;if(t)t.centerCustomizationRegion&&(0,m.mD)("ChatIcon",t.centerCustomizationRegion.children)&&n.e("chat").then(n.bind(n,3924)).then((e=>{const t=e.ChatHeaderButtonConnector;(0,i.NP)().invoke("LazyComponentLoaded",_.Y,t),e.initializeChatComponent()}));else{let t=document.getElementById(W.dK);t&&n.e("chat").then(n.bind(n,3924)).then((n=>{n.initializeChatComponent();const a=n.ChatIconConnector;d.render(p.createElement(h.Provider,{store:e},p.createElement(a,null)),t)}))}}}var J=n(66639),Q=n(28569);const V="LazyDocumentTitleComponentName";(0,Q.E)(V);let K=!1;class X{SetProps(e){(K?Promise.resolve():n.e("dtt").then(n.bind(n,60166)).then((e=>{K=!0,(0,i.NP)().invoke("LazyComponentLoaded",V,e.DocumentTitleConnector)}))).then((()=>(0,m.OU)().dispatch((0,J.k)(e))))}}var $=n(63348),Y=n(88212),ee=n(47710);let te=!1;function ne(e,t){if(!te&&t&&t.FootprintTelemetryEnabled){if(te=!0,!m.B3.isMobileClient()&&!(0,m.x_)(t.WorkloadId,t.FootprintWorkloadExcludeList)){let a="https://r4.res.office365.com/footprint/v3.2/scripts/fp-min.js";window.O365ShellContext.TrustedResources.add(a),(n=a,new Promise(((e,t)=>{let a=encodeURI(n),i=document.createElement("script");i.src=window.O365ShellContext.TrustedTypesPolicies[ee.TR].createScriptURL(a),i.type="text/javascript",i.crossOrigin="anonymous",i.onerror=e=>{t({ResourceName:n,Details:e.message})},i.onload=()=>{e(null)},document.body.appendChild(i)}))).then((()=>{var n;let a="";const s=(0,o.ic)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL),l="gallatin",c=(0,r.d5)((null===(n=t.Environment)||void 0===n?void 0:n.toLowerCase())||"",l)?l:"";t.IsConsumerShell?a="84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa":t.TID&&(a=t.TID);try{const e=[`config.fp.measure.office.com/conf/v2/o365se${c}/fpconfig.min.json`,"r4.res.office365.com/footprint/v3.2/scripts/fpconfig.json"];Footprint.start("O365se"+c,e,1e4,JSON.stringify([{TenantId:a,AppId:s}]))}catch(e){(0,i.tZ)().tag("Footprint_StartFailed",6,e||"")}})).catch((e=>{(0,i.tZ)().tag("Footprint_LoadFailed",4,e.ResourceName,e.Details)}))}(0,i.NP)().unsubscribe("ShellDataUpdated",ne)}var n}var ae=n(20748);let ie,re;class oe{UpdateAccount(e,t,n){if(window.MastInteraction)try{window.MastInteraction.UpdateAccount(e,t,n)}catch(e){(0,i.tZ)().exception("MAST_UpdateAccount_Failed",6,e)}}SetActiveAccount(e){if(window.MastInteraction)try{window.MastInteraction.SetActiveAccount(e)}catch(e){(0,i.tZ)().exception("MAST_SetActiveAccount_Failed",6,e)}}UpdateMastConfiguration(e){if(window.MastInteraction)try{window.MastInteraction.UpdateConfiguration(e)}catch(e){(0,i.tZ)().exception("MAST_UpdateConfiguration_Failed",6,e)}}Init(){(0,i.NP)().subscribe("ShellDataUpdated",se,!0)}}function se(e,t){var a;let r=(0,i.GJ)();if(!t.DisableAccountSwitchingGlobally&&t.AccountSwitchingEnabled&&r.shellAuthProviderConfig){ie=null===(a=null==e?void 0:e.SignOutLink)||void 0===a?void 0:a.Url;let o,s=r.shellAuthProviderConfig.login_Hint,l={authenticatedState:1,upn:s||t.UPN,idp:t.IsConsumerShell?"msa":"aad"},c={isMSAAccount:t.IsConsumerShell,puid:t.PUID,upn:t.UPN},u=he(t.AppHeaderLinkText);void 0===u.postAccountSwitchRedirectUri&&(o={modifySwitchAccountRedirectUriFunction:ue}),void 0===u.postLogoutRedirectUri&&(o=Object.assign(Object.assign({},o),{modifySignoutRedirectUriFunction:pe})),o=Object.assign(Object.assign({},o),{afterSwitchAccountPromptCallbackFunction:le,afterSignOutPromptCallbackFunction:ce}),window.LoadMastPromptJs={Download:de},n.e("mast").then(n.bind(n,32254)).then((n=>{new n.MultiAccountSessionTracker(u,o),re.UpdateAccount(t.PUID,l,!0),window.addEventListener("message",me.bind(self,c,e.SignOutLink),!1),(0,i.NP)().subscribe("AppNameChanged",ge,!0)})).catch((e=>(0,i.tZ)().exception("MASTPackage_DownLoad_Failed",6,e))),(0,i.NP)().unsubscribe("ShellDataUpdated",se)}}function le(){(0,i.tZ)().click("SwitchPopup","Mast"),(0,ae.f)().catch((e=>{(0,i.tZ)().exception("MAST_Switch_ClearSessionStorage_Failed",6,e)}))}function ce(){(0,i.tZ)().click("SignOutPopup","Mast"),(0,ae.f)().catch((e=>{(0,i.tZ)().exception("MAST_Signout_ClearSessionStorage_Failed",6,e)}))}function ue(e,t,n){let a=(0,i.GJ)().shellAuthProviderConfig;if(a&&a.appSwitchToUrl&&"function"==typeof a.appSwitchToUrl){let n={currentAccount:{type:"msa"===e.idp?"msa":"aad",login_hint:e.upn,memberName:e.upn,authenticatedState:"signedIn",cid:void 0},nextAccount:{type:"msa"===t.idp?"msa":"aad",login_hint:t.upn,memberName:t.upn,authenticatedState:"signedIn",cid:void 0}};return a.appSwitchToUrl(n)}return n||void 0}function pe(e,t){let n=(0,i.GJ)().shellAuthProviderConfig;if(n&&"function"==typeof n.appSignOutUrl){let t={currentAccount:{type:"msa"===e.idp?"msa":"aad",login_hint:e.upn,memberName:e.upn,authenticatedState:"signedIn",cid:void 0}};return n.appSignOutUrl(t)}}function de(e){n.e("mastprompt").then(n.t.bind(n,13808,23)).then((()=>{e&&e()})).catch((e=>(0,i.tZ)().exception("MASTPromptPackage_DownLoad_Failed",6,e)))}function he(e){let t,n=(0,i.GJ)(),a=!0,r=n.shellAuthProviderConfig,o=r.appSwitchToUrl||r.appSignInUrl;o&&"string"==typeof o?t=o:a=!1;let s=r.appSignOutUrl;return{appFriendlyName:e,enablePageRedirect:!0,postLogoutRedirectUri:s&&"string"==typeof s?s:ie,postAccountSwitchRedirectUri:t,mastPromptLocalizedStrings:{appFriendlyName:e,switchAccountTitle:T.D.SwitchAccountTitle,switchAccountDescriptionWithUpn:T.D.SwitchAccountDescriptionWithUpn,switchAccountDescriptionWithoutUpn:T.D.SwitchAccountDescriptionWithoutUpn,switchAccountSubDescription:"",switchAccountButtonText:T.D.SwitchAccountButtonText,signOutTitle:T.D.SignOutTitle,signOutDescriptionWithUpn:T.D.SignOutDescriptionWithUpn,signOutDescriptionWithoutUpn:T.D.SignOutDescriptionWithoutUpn,signOutSubDescription:"",signOutButtonText:T.D.SignOutButtonText},appendLoginHint:a,enableConsoleLogging:!1,enableAutomaticPopup:!n.shellDataOverrides.DisableMASTPopup}}function me(e,t,n){var a,r,o,s;if("SwitchAccountRedirect"===(null===(a=null==n?void 0:n.data)||void 0===a?void 0:a.request))(null===(r=null==n?void 0:n.data)||void 0===r?void 0:r.url)?((0,i.tZ)().click("Switch","Mast"),window.removeEventListener("message",me.bind(n,e,t),!1),(0,i.NP)().invoke("AccountSwitchInitiated",e)):(0,i.tZ)().tag("MAST_MissingSwitchUrl",4);else if("SignOutBackToLanding"===(null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.request))if(null===(s=null==n?void 0:n.data)||void 0===s?void 0:s.url){(0,i.tZ)().click("SignOut","Mast"),window.removeEventListener("message",me.bind(n,e,t),!1),null!=t.Action&&t.Action();let a={triggerEvent:n};(0,i.NP)().invoke("SignOut",a)}else(0,i.tZ)().tag("MAST_MissingSignOutUrl",4)}function ge(e){let t=he(e);re.UpdateMastConfiguration(t)}var Se=n(3234),fe=n(222),ye=n(94361);n(64386);let Ce;var Ie=n(58059);function ve(e,t){const a=()=>n.e("otellogging").then(n.bind(n,90476));t.AriaTelemetryEnabled&&(!t.IsConsumerShell&&t.PUID?(0,Ie.n)(t)&&t.TID&&a().then((n=>{n.initializeLogging(e,t),(0,i.NP)().unsubscribe("ShellDataUpdated",ve)})):a().then((n=>{n.initializeLogging(e,t),(0,i.NP)().unsubscribe("ShellDataUpdated",ve)})))}var Ae=n(66432),Te=n(49152),be=n(18435);function we(){(0,i.NP)().invoke("FlexPane400ZoomActivated",(0,Te.g)())}var De=n(40141),Pe=n(57530),Oe=n(71173),ke=n(20002);let Ee,Re,xe,Ue,Ne,Le,Fe,Me,qe,We,_e,Ge,Be,He;function Ze(e,t,n){Ee=(0,i.NP)(),Re=window.matchMedia(`(max-height: ${t}px)`),Me=0,qe=0,Be=n,We=e,window.addEventListener(be.B.RESIZE,ze),We.addEventListener(be.B.MOUSEENTER,Ve),We.addEventListener(be.B.MOUSELEAVE,Ke),We.addEventListener(be.B.FOCUS,Xe,!0),We.addEventListener(be.B.BLUR,$e,!0),Ee.subscribe("ContextMenuPopup",Ye),Ee.subscribe("ShyHeaderActivated",et,!0),ze()}function ze(){tt()?(0!==Me&&window.clearTimeout(Me),Me=window.setTimeout((()=>{tt()&&null!=We&&null!=Be&&(He||function(){if(null!=Be&&null!=We){let e=(0,De.e)();_e=(0,Pe.Ux)(`${ke.shyHeader} o365cs-base ${e.navbar}`,"O365_ShyHeader"),_e.setAttribute("tabindex","0"),Ge=(0,Pe.Ux)(ke.shyHeaderOverlay);let t=(0,Pe.Ux)(`${ke.shyHeaderGripper} ${e.shyHeader}`);_e.appendChild(Ge),_e.appendChild(t),Be.appendChild(_e),_e.addEventListener(be.B.MOUSEDOWN,Je),_e.addEventListener(be.B.FOCUS,Qe),(0,Pe.YV)(We,ke.headerAnimations),(0,Pe.YV)(Be,ke.workloadDivAnimations),He=!0}}(),(0,Pe.Lu)(We,ke.headerSlideIn),(0,Pe.Lu)(Be,ke.workloadDivSlideIn),(0,Pe.YV)(We,ke.headerSlideOut),(0,Pe.YV)(Be,ke.workloadDivSlideOut),We.onanimationend=e=>{"headerSlideOutFrames"===e.animationName&&(Ee.invoke("ShyHeaderActivated",!0),xe=!0)})}),2e3)):Re.matches&&!Fe||je()}function je(e){xe&&null!=_e&&null!=We&&null!=Be&&(_e.style.visibility="hidden",_e.style.display="none",Ge.style.visibility="hidden",Ge.style.display="none",We.style.display="flex",(0,Pe.Lu)(We,ke.headerSlideOut),(0,Pe.Lu)(Be,ke.workloadDivSlideOut),(0,Pe.YV)(We,ke.headerSlideIn),(0,Pe.YV)(Be,ke.workloadDivSlideIn),We.onanimationend=t=>{"headerSlideInFrames"===t.animationName&&(Ee.invoke("ShyHeaderActivated",!1),xe=!1,e&&document.getElementById(Oe.ng).focus())})}function Je(e){Ne=!0}function Qe(e){je(!Ne),Ne=!1}function Ve(e){Ue=!0}function Ke(e){Ue=!1,ze()}function Xe(e){Le=!0}function $e(e){Le=!1,0!==qe&&window.clearTimeout(qe),qe=window.setTimeout((()=>{Le||ze()}),50)}function Ye(e){Fe=e,e||ze()}function et(e){e&&null!=_e&&null!=We&&(_e.style.visibility="visible",_e.style.display="flex",Ge.style.visibility="visible",Ge.style.display="flex",We.style.display="none")}function tt(){return Re.matches&&!xe&&!Ue&&!Le&&!Fe}let nt=!1,at=!1;function it(e,t){if(!nt){let e=(0,i.GJ)();if(e&&e.supportShyHeaderMode){let t=document.getElementById(e.top);Ze(document.getElementById(W.yG),e.shyHeaderActivationHeight?e.shyHeaderActivationHeight:Te.C,t),nt=!0}}at||(window.addEventListener(be.B.RESIZE,we),at=!0)}const rt=(0,h.connect)((e=>{var t,n;return{cultureName:null===(t=e.userState)||void 0===t?void 0:t.cultureName,isConsumer:null===(n=e.userState)||void 0===n?void 0:n.isConsumer}}),(e=>({onSetM365CopilotBannerData:t=>{e((0,S.zh)(t))}})))((e=>{(0,p.useEffect)((()=>{e.cultureName&&!e.isConsumer&&t()}),[]);const t=()=>(0,f.__awaiter)(void 0,void 0,void 0,(function*(){try{const t=yield(0,v.l)().getConfig();if(!t)return;if(!t.CopilotBannerLoaderEnabled)return;let n=null;if(t.M365CopilotBannerEnabled?n=A.C$:t.M365CopilotBannerSelfHostInternalEnabled&&(n=A.G4),!n)return;const a=e.cultureName.split("-"),i=e.cultureName,r=a.length>1?a[1]:"US",o=yield w.D.getCopilotCreative(n,i,r),s={designOption:o.designOption,rowStart:o.rowStart,title:o.title,description:o.description,buttonText:o.buttonText,impressionUrl:o.impressionUrl,actionUrl:o.buildTrackingUrl("Click"),buttonURL:o.buttonURL};e.onSetM365CopilotBannerData(s)}catch(e){(0,i.tZ)().exception("CopilotBannerLoader_LoadCopilotBannerConfiguration_Failed",6,e)}}));return null}));var ot=n(53512),st=n(25793),lt=n(82453),ct=n(33680),ut=n(5232),pt=n(66309),dt=n(50585),ht=n(755),mt=(n(73948),n(10682)),gt=n(7102),St=n(94190),ft=n(54386);function yt(e,t,n,a){return Object.assign(Object.assign({},e),{editPhotoPopupUrl:n.EditPhotoPopupUrl,myAccountLink:n.MyAccountEnabled&&!n.HideMyAccountLink?{Id:"ShellSettings",Text:T.D.AccountSettings,Url:Ct(n),TargetWindow:(0,o.bi)(n.WorkloadId,t.CurrentMainLinkElementID)?"_blank":"_top"}:null,aboutMeLink:n.HideMyProfileLink?null:t.AboutMeLink||e.aboutMeLink,customMenuItems:[...t.CurrentWorkloadUserSubLinks||[],...a&&a.workloadMeSubLinks||[]].filter((e=>null!=e)),signoutLink:t.SignOutLink||e.signoutLink,suiteServiceUrl:n.SuiteServiceUrl,upn:n.UPN,showDisplayName:null!=n.MeControlSetting&&(JSON.parse(n.MeControlSetting).UseFullName&&!(0,St.isMobileClient)()),universalMeControlEnabled:n.UniversalMeControlEnabled||"OfficePWA"===n.WorkloadId&&t.CurrentMainLinkElementID&&"ShellOfficeDotCom"===t.CurrentMainLinkElementID,promoteMeCustomLink:n.PromoteMeCustomLink,accountSwitchingEnabled:!n.DisableAccountSwitchingGlobally&&n.AccountSwitchingEnabled,npmMeControlEnabled:n.NpmMeControlEnabled,shellAuthProviderConfig:a&&a.shellAuthProviderConfig,aadSignOutUrl:n.AADSignOutUrl,aadSignOutAndForgetUrl:n.AADSignOutAndForgetUrl,aadForgetUrl:n.AADForgetUrl,aadRememberedAccountsUrl:n.AADRememberedAccountsUrl,msaRememberedAccountsUrl:n.MSARememberedAccountsUrl,msaSignOutAndForgetUrl:n.MSASignOutAndForgetUrl})}function Ct(e){return e.IsConsumerShell?e.MyAccountUrl:e.MyAccountFullUrl?(0,r.JT)("{0}/?tenant={1}&upn={2}",e.MyAccountFullUrl,encodeURIComponent(e.TID),encodeURIComponent(e.UPN)):e.PortalUrl+e.MyAccountUrl}const It={meControlState:function(e,t){var n,a,i,r;if(!e){const i=t.shellInitData.shellInitDataState,r=i.clientData&&i.clientData.IsConsumerShell,s=r?"https://login.live.com/logout.srf":"https://login.microsoftonline.com/logout.srf",l={defaultSignOutUrl:s,signoutLink:{Id:"ShellSignout",Text:null!==(n=T.D.SignOut)&&void 0!==n?n:"Sign out",Url:s,TargetWindow:"_top"},photoCacheToken:"",canSetPhoto:!1,enableChangePhoto:!1,universalMeControlEnabled:!1,accountSwitchingEnabled:!1,npmMeControlEnabled:!1,isUniversalMeControAPIInitialized:!1,promoteMeCustomLink:!1};r&&(l.aboutMeLink={Id:"ShellAboutMe",Text:null!==(a=T.D.EditProfile)&&void 0!==a?a:"My profile",Url:"https://account.microsoft.com/profile/",TargetWindow:(0,o.bi)(i.clientData.WorkloadId,i.navBarData.CurrentMainLinkElementID)?"_blank":"_top"}),e=yt(l,i.navBarData||{},i.clientData||{},i.renderSettings||{})}switch(t.type){case ft.HI:return function(e,t){return Object.assign(Object.assign({},e),{photoCacheToken:(t.cacheToken||"").toString(),photoUrl:t.mePhotoUrl})}(e,t);case ft.zm:return function(e,t){return Object.assign(Object.assign({},e),{canSetPhoto:t.setPhoto})}(e,t);case ft.Lb:return Object.assign(Object.assign({},e),{displayName:t.displayName});case ft.SX:return Object.assign(Object.assign({},e),{firstName:t.firstName,lastName:t.lastName});case ft.t8:return Object.assign(Object.assign({},e),{photoUrl:t.url});case ft.Rj:return Object.assign(Object.assign({},e),{enableChangePhoto:t.enablePhotoChange});case gt.l5:const n=t;return yt(e,n.navBarData,n.shellClientData,n.renderSettings);case gt.uU:return i=e,r=t.shellStrings,Object.assign(Object.assign({},i),{signoutLink:Object.assign(Object.assign({},i.signoutLink),{Text:r.SignOut}),myAccountLink:Object.assign(Object.assign({},i.myAccountLink),{Text:r.AccountSettings})});case ft.XB:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{userPresenceStatus:n.presenceStatus})}(e,t);case ft.gI:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{userPresenceStatusItems:n.presenceStatusList})}(e,t);case ft.Fx:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{isUniversalMeControAPIInitialized:n.isMeControlAPIInitialized})}(e,t);default:return e}}};class vt{constructor(){this.validatePresenceStatusList=e=>{let t=e.every((e=>this.validatePresenceStatus(e)));return t||(0,i.tZ)().tag("SetPresenceStatus_Shim_PresenceStatusList_Param_Invalid",6),t},this.validatePresenceStatus=e=>null!=e&&("string"==typeof e.key&&"string"==typeof e.description&&"string"==typeof e.url)}SetPresenceStatus(e,t){this.validatePresenceStatus(e)?(t&&this.validatePresenceStatusList(t)&&(0,lt.O)().dispatch((0,mt.c1)(t)),(0,lt.O)().dispatch((0,mt.cX)(e))):(0,i.tZ)().tag("SetPresenceStatus_Shim_PresenceStatus_Param_Invalid",6)}SubscribeToPresenceStatus(e){return(0,i.NP)().subscribe("PresenceStatusChanged",e,!1)}UnsubscribeToPresenceStatus(e){return(0,i.NP)().unsubscribe("PresenceStatusChanged",e)}OnAccountSwitchInitiated(e,t=!1){return(0,i.NP)().subscribe("AccountSwitchInitiated",e,t)}OnSwitchInitiated(e,t){return(0,i.NP)().subscribe("SwitchInitiated",e,t)}OnSwitchToInitiated(e,t){return(0,i.NP)().subscribe("SwitchToInitiated",e,t)}OnSignOutFromIDPInitiated(e,t){return(0,i.NP)().subscribe("SignOutFromIDPInitiated",e,t)}OnSignOutAndForgetFromIDPInitiated(e,t){return(0,i.NP)().subscribe("SignOutAndForgetFromIDPInitiated",e,t)}OnMeControlInitialized(e,t=!1){return(0,i.NP)().subscribe("UniversalMeControlInitialized",e,t)}RemoveOnAccountSwitchInitiated(e){(0,i.NP)().unsubscribe("AccountSwitchInitiated",e)}RemoveOnSwitchInitiated(e){(0,i.NP)().unsubscribe("SwitchInitiated",e)}RemoveOnSwitchToInitiated(e){(0,i.NP)().unsubscribe("SwitchToInitiated",e)}RemoveOnSignOutFromIDPInitiated(e){(0,i.NP)().unsubscribe("SignOutFromIDPInitiated",e)}RemoveOnSignOutAndForgetFromIDPInitiated(e){(0,i.NP)().unsubscribe("SignOutAndForgetFromIDPInitiated",e)}RemoveOnMeControlInitialized(e){(0,i.NP)().unsubscribe("UniversalMeControlInitialized",e)}}n(85273);n.nc=window.oneShellUxNonce;const At=(0,ot._)((()=>n.e("npm_mecontrol").then(n.bind(n,10021)).then((e=>e.NpmMeControlConnector)))),Tt=(0,ot._)((()=>n.e("umc_mecontrol").then(n.bind(n,50641)).then((e=>e.UniversalMeControlConnector))));function bt(e,t){var n;const a=(0,lt.O)(),r=a.getState(),s=(0,pt.om)(e,t);if(a.dispatch((0,mt.Zi)(s)),a.dispatch((0,mt.oZ)(e.FirstName,e.LastName)),(0,o.bi)(t.WorkloadId,e.CurrentMainLinkElementID)||null==ht.h.Instance&&ht.h.Initialize(r.userState.isConsumer,r.meControlState.mePhotoCachingDisabled).then((()=>{let e=r.meControlState.photoCacheToken;e&&""!==e||(e=ht.h.Instance.getNewPhotoToken(),ht.h.getPhotoUrl(r.userState.upn,e).then((t=>{a.dispatch((0,mt.yO)(e,t))})).catch((e=>{(0,i.tZ)().exception("MeControl_GetPhotoUrl_Failed",6,e)})))})),r.meControlState.universalMeControlEnabled&&r.headerState.isAuthenticated){(0,dt.yd)(),(0,i.NP)().unsubscribe("ShellDataUpdated",bt);const e=r.shellInitDataState.layout?W.On:"O365_MeControlContainer",t=document.getElementById(e),o=(0,De.e)();(0,ct.Fb)(t,o.headerButton,!0);const s=document.createElement("div");s.id=ut.zA,t.appendChild(s),d.render(p.createElement(h.Provider,{store:a},(null===(n=r.meControlState)||void 0===n?void 0:n.npmMeControlEnabled)?p.createElement(At,null):p.createElement(Tt,null)),s)}else(0,dt.Tg)(!1)}!function(){if(st.h.register(It),function(){let e=new vt,t=window.O365Shell.MeControl;window.O365Shell.MeControl=e,t.applyCalls(e)}(),document.getElementById(ut.qg)){(0,dt.ty)();const e=(0,lt.O)(),t=e.getState();(0,i.NP)().subscribe("ShellDataUpdated",bt,!0),(0,i.NP)().subscribe("SuiteAPILoaded",(n=>{if((!1===t.userState.isConsumer||n.Configuration.IsPwa)&&(n.Configuration.IsPwa||n.Configuration.ExchangeDataOpxEnabled||n.User.getOwaUserConfiguration().then((t=>{e.dispatch((0,mt.My)(t.SegmentationSettings.SetPhoto))})).catch((()=>{})),n.User.prefetchGraphToken().catch((e=>{(0,i.tZ)().exception("MeControl_PrefetchGraphToken_Failed",6,e)})),n.Configuration.IsPwa)){const t=e.getState();null==ht.h.Instance&&ht.h.Initialize(t.userState.isConsumer,t.meControlState.mePhotoCachingDisabled).then((()=>{ht.h.getPhotoUrl(t.userState.upn).then((t=>{e.dispatch((0,mt.e4)(t))})).catch((e=>{(0,i.tZ)().exception("MeControl_PWA_GetPhotoUrl_Failed",6,e)})),e.dispatch((0,mt.My)(!1))}))}}),!0)}}(),function(){let e=(0,m.OU)().getState();e.userState.isConsumer||m.h5.register(U),function(){let e=new M,t=window.O365Shell.Apps;window.O365Shell.Apps=e,t.applyCalls(e)}(),e.userState.isConsumer||(0,i.NP)().subscribe("ShellDataUpdated",q,!0)}(),Ce=(0,i.NP)().subscribe("ShellDataUpdated",((e,t)=>{if(t.NotificationsEnabled){(0,i.NP)().unsubscribe("ShellDataUpdated",Ce);const e=()=>n.e("notifications").then(n.bind(n,12033)).catch((e=>(0,i.tZ)().exception("NotificationsPackage_LoadFail",6,e)));let t=(0,i.GJ)();t&&t.layout?t.layout.centerCustomizationRegion&&(0,ye.mD)("NotificationBellIcon",t.layout.centerCustomizationRegion.children)&&e():e()}}),!0),(0,i.NP)().subscribe("ShellDataUpdated",ve,!0),(0,i.NP)().subscribe("ShellDataUpdated",ne,!0),m.h5.register(Z),(0,i.NP)().subscribe("ShellDataUpdated",j,!0),(0,a.xZ)(),function(){const e=()=>n.e("diagnostics").then(n.bind(n,90406));let t=window.O365Shell.Diagnostics;t.registerShimCallback&&t.registerShimCallback((()=>{e()}),["GetServiceDiagnostics","GetClientDiagnostics"]),window.O365ShellContext.DiagnosticsEnabled&&e()}(),function(){const e=new l,t=window.O365Shell.Abt;window.O365Shell.Abt=e,t.applyCalls(e);const n=(0,i.GJ)();n.abtTimeout&&window.O365Shell.Abt.Init(n.abtTimeout,n.abtSigninState,n.abtControls,n.abtSessionId,n.abtDisableTrackEvents)}(),(0,i.NP)().subscribe("ShellDataUpdated",it,!0),function(){let e=new X,t=window.O365Shell.DTT;window.O365Shell.DTT=e,t&&t.applyCalls(e)}(),(0,i.GJ)().shellAuthProviderConfig&&(re=new oe,re.Init()),function(){const e=(0,m.OU)();d.render(p.createElement(h.Provider,{store:e},p.createElement(rt,null)),document.createElement("div"))}(),(0,v.l)().getConfig().then((e=>{(null==e?void 0:e.LoadingIconsInCoreBundle)||((0,fe.N)(),(0,Ae.U)(),(0,Y.A)(),(0,Se.b)(),(0,$.I)())})).catch((e=>{})),(0,i.NP)().invoke("PlusLoaded"),(0,i.tZ)().perfMarker("shell_plus_executioncomplete")},91336:function(e,t,n){"use strict";n.d(t,{F:function(){return q}});var a=n(24126),i=n(16968),r=n(87894),o=n(95144),s=n(30086);class l extends s.y{initializeComponent(){}getMruDocuments(e,t){return new Promise(((n,r)=>{let s=(0,o.JT)("{0}?rs={1}&show={2}&sort=date",this.SuiteApi.Configuration.MruOauthEndpointUrl,this.SuiteApi.Configuration.CultureName,e.toString());null!=t&&(s+="&apps="+t);const l={method:a.oZ.GET,resource:this.SuiteApi.Configuration.MruOauthResourceUrl,url:s};this.SuiteApi.Service.callEndpointWithOauthToken(l).then((e=>{(0,i.tZ)().perfMarker("shell_mru_fetch_complete"),n(e)})).catch((e=>{a.F2.genericServiceRejection("Documents_GetMRUDocuments_Failed",6,e,r)}))}))}prefetchMruAccessToken(){null!=this.SuiteApi.Configuration.MruOauthResourceUrl&&this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.MruOauthEndpointUrl,this.SuiteApi.Configuration.MruOauthResourceUrl)}initializeGraphApi(){null!=this.SuiteApi.Configuration.GraphOauthResourceUrl&&this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.GraphOauthEndpointUrl,this.SuiteApi.Configuration.GraphOauthResourceUrl)}createNewDocument(e){const t={name:e,file:{},"@microsoft.graph.conflictBehavior":"rename"},n={method:a.oZ.POST,resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthEndpointUrl,headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(t)};return new Promise(((e,t)=>{this.SuiteApi.Service.callEndpointWithOauthToken(n).then(e).catch((e=>{a.F2.genericServiceRejection("Documents_CreateNewDocument_Failed",4,e,t)}))}))}getDocumentUrl(e,t){let n;return new Promise(((a,i)=>{null!=e?this.createNewDocument(e).then((e=>{null!=e&&null!=e.webUrl?(n=e.webUrl.replace(new RegExp("([?&])action[^&]*"),"$1action=editnew"),-1===n.lastIndexOf("action=editnew")&&(n=(0,o.wk)(n,"action","editnew"))):n=t,a(n)})).catch((e=>i(e))):(n=t,a(n))}))}}var c,u=n(9522),p=n(75511);!function(e){e.UpdateConfig="UpdateConfig",e.UpdateToken="UpdateToken",e.ChangeTheme="ChangeTheme",e.UpdateData="UpdateData"}(c||(c={}));var d=n(44966),h=n(50954),m=n(62853);class g extends s.y{constructor(){super(),this.opxFrameToComponentMap={},this.opxComponentData={},this.opxTimers={},this.opxOutstandingOpxQueries={},this.currentOpxQueryID=0,this.handleIncomingOpxMessage=e=>{var t;let n=!1;const a=this.opxFrameToComponentMap[e.instanceId];if(null!=a)switch(e.notificationType){case p.C.LifeCycle:switch(e.asyncContext){case p.$.GetConfig:const i=null===(t=this.opxComponentData[a])||void 0===t?void 0:t.opxComponentConfiguration;null!=i&&(n=this.onGetConfigRequest(e.instanceId,i));break;case p.$.RefreshToken:n=this.onRefreshTokenRequest(e.instanceId);break;case p.$.Closed:n=this.onOpxClosedRequest(a);break;case p.$.PageReady:case p.$.FatalError:n=this.onReadyOrError(a,e)}break;case p.C.ChallengeToken:n=this.onRefreshTokenRequest(e.instanceId);break;case p.C.DataProviderResponseNotification:const i=e.asyncContext;if(i.success){const t=this.opxOutstandingOpxQueries[e.instanceId];if(t){Object.keys(t).filter((e=>t[e].queryType===i.type)).forEach((e=>{t[e].onQueryComplete(i.response)}))}}}return n},this.validateIncomingOpxMessage=e=>e.apiName===d.zd,this.validateIncomingOpxMessageOrigin=e=>e.toLowerCase()===this.SuiteApi.Configuration.TokenFactoryIframeOrigin,this.onGetConfigRequest=(e,t)=>(this.SuiteApi.Service.callOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:e,message:{eventType:c.UpdateConfig,asyncResult:t}}),!0),this.onRefreshTokenRequest=e=>(this.SuiteApi.Service.callOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:e,message:{eventType:c.UpdateToken,asyncResult:null}}),!0),this.onOpxClosedRequest=e=>{let t=null;if(e===m.G.MyDay)t="MyDay";return null!=t&&window.O365Shell.FlexPane.CloseFlexPaneForProvider(t),!0},this.onReadyOrError=(e,t)=>{const n=this.opxComponentData[e];if(!n)throw new Error("Message received for an OPX component that no longer exists.");if(n.initCompleteCallback&&!n.initializationResult){const e=t.asyncContext===p.$.PageReady?0:5;n.initCompleteCallback(e)}else n.messageListener&&n.messageListener(t);return!0};let e=15e3;try{(0,h.l)().getConfig().then((t=>{t&&t.IncreaseOPXInitTimeout&&(e=6e4)}))}catch(e){}this.OpxInitializationTimeout=e}initializeComponent(){this.opxHostUrl=this.SuiteApi.Configuration.OpxHostUrl,this.opxResourceUrl=this.SuiteApi.Configuration.OpxResourceUrl,this.upn=this.SuiteApi.Configuration.CurrentUserUpn,this.opxSystemConfigurationPromise=this.initializeOpxOrchestrator()}prefetchOpxAccessToken(e){this.opxSystemConfigurationPromise.then((t=>{null==this.opxSystemConfiguration&&(this.opxSystemConfiguration=t);const n=this.opxSystemConfiguration.OpxEndpoints[e];void 0!==n&&this.SuiteApi.Service.prefetchAccessToken(n.OpxOAuthResourceUrl,n.OpxOAuthResourceUrl)})).catch((e=>{(0,i.tZ)().tag("OwaPoweredExperiences_PrefetchAccessTokenFailed",1,e)}))}initializeOpx(e,t,n,a){let r=document.getElementById(t);if(!r)return Promise.resolve(2);this.prefetchOpxAccessToken(m.G.MyDay);const o=new Promise((o=>{this.opxSystemConfigurationPromise.then((s=>{null==this.opxSystemConfiguration&&(this.opxSystemConfiguration=s),this.opxFrameToComponentMap[t]=e,this.opxComponentData[e]={frameID:t,opxComponentConfiguration:n,initCompleteCallback:t=>{switch(t){case 0:case 5:this.opxComponentData[e].initializationResult=t}o(t)},messageListener:a},r.onerror=(e,t,n,a,r)=>{const s=JSON.stringify(null!=e?e:"Script error");(0,i.tZ)().exception(s,6,r,t,n,a),o(3)},r.src=this.createOpxFrameUrl(e,t)})).catch((()=>{o(1)}))}));return Promise.race([new Promise((t=>{o.then((n=>{clearTimeout(this.opxTimers[e]),t(n)}))})),new Promise((t=>{clearTimeout(this.opxTimers[e]),this.opxTimers[e]=window.setTimeout((()=>{clearTimeout(this.opxTimers[e]),t(4)}),this.OpxInitializationTimeout)}))])}changeTheme(e,t,n){const a=this.opxComponentData[e];if(0!==a.initializationResult)throw new Error("Theme cannot be changed before OPX is in the operational state.");const i=a.frameID,r={UseDarkMode:n};n?r.DarkPalette=t:r.LightPalette=t,this.SuiteApi.Service.callOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:i,message:{eventType:c.ChangeTheme,asyncResult:r}})}updateData(e,t,n){const a=this.opxComponentData[e];if(!a||0!==a.initializationResult)return Promise.reject(new Error("UpdateData cannot be called before OPX is in the operational state."));const i={type:t,request:n};return this.queryOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:a.frameID,message:{eventType:c.UpdateData,asyncResult:i}})}createOpxFrameUrl(e,t){if(null==this.opxSystemConfiguration||null==this.opxSystemConfiguration.OpxRootUrlLowerCase||null==this.opxSystemConfiguration.OpxEndpoints[e]||null==this.opxSystemConfiguration.OpxEndpoints[e].OpxEndpointUrl)throw new Error("OPX system configuration incomplete.");return`${this.opxSystemConfiguration.OpxRootUrlLowerCase}${this.opxSystemConfiguration.OpxEndpoints[e].OpxEndpointUrl}?hostApp=o365shell&frameName=${u.TokenFactoryIFrameID}&opxInstanceId=${t}&OpxHostOrigin=${this.SuiteApi.Configuration.TokenFactoryIframeOrigin}`}initializeOpxOrchestrator(){return new Promise(((e,t)=>{this.fetchSystemConfiguration().then((n=>{this.SuiteApi.Service.registerOpxHost(this.opxResourceUrl,this.opxHostUrl,this.OpxInitializationTimeout).then((()=>{this.registerOpxMessageListener(),e(n)})).catch((e=>{(0,i.tZ)().exception("OPX_RegisterOpxHost_Failure",6,e),t(e)}))})).catch((e=>{(0,i.tZ)().exception("OPX_FetchSystemConfiguration_Failure",6,e),t(e)}))}))}fetchSystemConfiguration(){return Promise.resolve({OpxEndpoints:{MyDay:{OpxEndpointUrl:this.upn?`/opx/${this.upn}/myday`:"/opx/myday",OpxOAuthResourceUrl:this.opxResourceUrl},ExchangeData:{OpxEndpointUrl:this.upn?`/opx/${this.upn}/dataprovider`:"/opx/dataprovider",OpxOAuthResourceUrl:this.opxResourceUrl}},OpxRootUrlLowerCase:this.opxHostUrl.toLowerCase(),OpxSupported:!0})}registerOpxMessageListener(){this.SuiteApi.Service.registerPostMessageHandler({handleMessage:this.handleIncomingOpxMessage,validateMessage:this.validateIncomingOpxMessage,validateOrigin:this.validateIncomingOpxMessageOrigin})}queryOpxIframe(e,t=5e3){const n=e.message.asyncResult;return new Promise(((a,i)=>{this.SuiteApi.Service.callOpxIframe(e),null==this.opxOutstandingOpxQueries[e.targetOpxInstance]&&(this.opxOutstandingOpxQueries[e.targetOpxInstance]={});const r=this.currentOpxQueryID++,o=this.opxOutstandingOpxQueries[e.targetOpxInstance],s=setTimeout((()=>{delete o[r],i(new Error("Query timeout."))}),t);o[r]={id:r,opxFrameID:e.targetOpxInstance,queryType:n.type,onQueryComplete:e=>{clearTimeout(s),delete o[r],a(e)}}}))}}var S=n(16533);function f(e){return(0,S.__assign)({__type:"JsonRequestHeaders:#Exchange"},e)}function y(e){return(0,S.__assign)({__type:"TimeZoneContext:#Exchange"},e)}var C={baseUrl:"/owa",isFeatureEnabled:function(){return!1},prefetchTaskQueue:new(function(){function e(e){void 0===e&&(e={maxParallelTasks:1,taskQuanta:0}),this.config=e,this.taskList={},this.numberOfTasksRunning=0}return e.prototype.add=function(e,t){var n=this;return void 0===t&&(t=0),this.taskList[t]||(this.taskList[t]=[]),new Promise((function(a,i){n.taskList[t].unshift({func:e,resolve:a,reject:i}),n.scheduleTask()}))},e.prototype.clear=function(){this.taskList={}},e.prototype.scheduleTask=function(){var e=this;this.config.taskQuanta<0?this.tryRunTask():setTimeout((function(){e.tryRunTask()}),this.config.taskQuanta||0)},e.prototype.tryRunTask=function(){var e=this,t=Object.keys(this.taskList);if(this.numberOfTasksRunning<(this.config.maxParallelTasks||1)&&t.length>0){var n=Math.min.apply(null,t.map((function(e){return parseInt(e)}))),a=this.taskList[n].pop();this.taskList[n]&&0!=this.taskList[n].length||delete this.taskList[n],this.numberOfTasksRunning++,a.func().then((function(t){a.resolve(t),e.onTaskComplete()})).catch((function(t){a.reject(t),e.onTaskComplete()})),this.scheduleTask()}},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e}())({taskQuanta:-1}),timeoutMS:9e4,disableAllRequests:!1},I=C;function v(e){return e||(e=I.timezone),f(e?{RequestServerVersion:"V2018_01_08",TimeZoneContext:y({TimeZoneDefinition:(t={Id:e},(0,S.__assign)({__type:"TimeZoneDefinitionType:#Exchange"},t))})}:{RequestServerVersion:"V2018_01_08"});var t}var A=n(53464);let T=n(47562),b=null;const w=a.OY.SuiteServiceApiRelativePath+"LanguageTimezone";let D=null,P=null;class O extends s.y{initializeComponent(){b=this.SuiteApi.Configuration.GraphOauthResourceUrl,null!=b&&(b=(0,o.JT)("{0}/{1}",b,"v1.0/me"),D=(0,o.JT)("{0}/{1}",b,"outlook/supportedLanguages"),P=(0,o.JT)("{0}/{1}",b,"outlook/supportedTimeZones"))}getLanguageAndTimeZone(){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.getOwaLanguageAndTimeZone():this.getSuiteLanguage()}getLanguageChoices(){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.getOwaLanguageChoices():this.getSuiteLanguageChoices()}getTimeZoneChoices(){return new Promise(((e,t)=>{let n={url:P,method:a.oZ.GET};this.SuiteApi.Service.callEndpointWithOauthToken(n).then((t=>{e(t.value)})).catch((e=>{a.F2.genericServiceRejection("Settings_GetTimeZoneChoices_Failed",6,e,t)}))}))}getDateTimeFormats(e){return new Promise(((t,n)=>{const i={url:(0,o.JT)("{0}/api/settings/datetimeformats?cultureName={1}",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e),resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:a.oZ.GET,headers:A.n};this.SuiteApi.Service.callEndpointWithOauthToken(i).then(t).catch((e=>{a.F2.genericServiceRejection("Settings_GetDateTimeFormats_Failed",6,e,n)}))}))}setLanguageAndTimeZone(e){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.setOwaLanguageAndTimeZone(e):this.setSuiteLanguage(e.CurrentCultureName)}setSuiteLanguage(e){return new Promise(((t,n)=>{let i={url:b,method:a.oZ.PATCH,headers:A.w,body:JSON.stringify({preferredLanguage:e})};this.SuiteApi.Service.callEndpointWithOauthToken(i).then((e=>{t()})).catch((e=>{a.F2.genericServiceRejection("Settings_SetSuiteLanguage_Failed",6,e,n)}))}))}setOwaLanguageAndTimeZone(e){return this.SuiteApi.Configuration.IsOwsLanguageTimezoneCallEnabled?new Promise(((t,n)=>{e.CurrentCultureLcid=null;let i={Language:e.CurrentCultureName,TimeZone:e.CurrentTimeZone,DateFormat:e.CurrentDateFormat,TimeFormat:e.CurrentTimeFormat},r=(o={Header:v(),Options:i},(0,S.__assign)({__type:"SetMailboxRegionalConfigurationRequest:#Exchange"},o));var o;this.SuiteApi.Service.callOwaIframeActionWithAdditionalHeaders("SetMailboxRegionalConfiguration",r,null).then((n=>{this.setSuiteLanguage(e.CurrentCultureName),t()})).catch((e=>{a.F2.genericServiceRejection("Settings_SetOwsOwaLanguageAndTimeZone_Failed",6,e,n)}))})):new Promise(((t,n)=>{e.CurrentCultureLcid=null,this.SuiteApi.Service.callOwaIframeResourceUrl(w,e,a.oZ.PUT).then(t).catch((e=>{a.F2.genericServiceRejection("Settings_SetLanguageAndTimeZoneViaOwa_Failed",6,e,n)}))}))}getSuiteLanguageChoices(){return new Promise(((e,t)=>{T?e(T):t(new Error("Supported languages not found"))}))}getOwaLanguageChoices(){return new Promise(((e,t)=>{let n={url:D,method:a.oZ.GET};this.SuiteApi.Service.callEndpointWithOauthToken(n).then((t=>{let n=t.value.map((e=>({Locale:e.locale,DisplayName:e.displayName})));e(n)})).catch((e=>{a.F2.genericServiceRejection("Settings_GetOwaLanguageChoices_Failed",6,e,t)}))}))}getSuiteLanguage(){return new Promise(((e,t)=>{let n={url:b,method:a.oZ.GET};this.SuiteApi.Service.callEndpointWithOauthToken(n).then((t=>{let n={CurrentCultureName:t.preferredLanguage};e(n)})).catch((e=>{a.F2.genericServiceRejection("Settings_GetSuiteLanguage_Failed",6,e,t)}))}))}getOwaLanguageAndTimeZone(){return this.SuiteApi.Configuration.IsOwsLanguageTimezoneCallEnabled?new Promise(((e,t)=>{let n=(i={Header:v(),VerifyDefaultFolderNameLanguage:!1},(0,S.__assign)({__type:"GetMailboxRegionalConfigurationRequest:#Exchange"},i));var i;this.SuiteApi.Service.callOwaIframeActionWithAdditionalHeaders("GetMailboxRegionalConfiguration",n,null).then((t=>{let n=t.Options,a={CurrentCultureLcid:0,CurrentCultureName:n.Language,CurrentTimeZone:n.TimeZone,CurrentDateFormat:n.DateFormat,CurrentTimeFormat:n.TimeFormat};e(a)})).catch((e=>{a.F2.genericServiceRejection("Settings_GetOwsOwaLanguageAndTimeZone_Failed",6,e,t)}))})):new Promise(((e,t)=>{this.SuiteApi.Service.callOwaIframeResourceUrl(w,null,a.oZ.GET).then((t=>{let n=t.Body.Configuration;e(n)})).catch((e=>{a.F2.genericServiceRejection("Settings_GetOwaLanguageAndTimeZone_Failed",6,e,t)}))}))}}var k=n(88242),E=n(87948),R=n(1742);class x{constructor(e){this.userTheme=e}GetUserThemeId(){return(0,i.Vz)().getCurrentThemeId()}ChangeTheme(e){}SaveTheme(e,t){return new Promise(((n,a)=>{this.userTheme.setUserTheme(e,t).then((e=>{e.O365Success||e.OwaSuccess?n():a(new Error("SaveThemeFailure"))})).catch(a)}))}SaveDarkTheme(e){return new Promise(((t,n)=>{this.userTheme.setUserThemeSettingsInWCSS(e).then((e=>{e.O365Success||e.OwaSuccess?t():n(new Error("SaveThemeFailure"))})).catch(n)}))}GetModeLogo(e){return new Promise(((t,n)=>{this.userTheme.getModeLogo(e).then((e=>{if(e){let n="";e.HasTenantLogo&&(e.LogoUrl?n=e.LogoUrl:e.LogoData&&(n=e.LogoData));const a={isLogoVisible:!0,logoUrl:n,logoNavigationUrl:e.HomePageUrl?e.HomePageUrl:""};return t(a)}return n(new Error("GetModeLogoFailure"))})).catch(n)}))}SetUserThemesData(e){(0,o.OU)().dispatch((0,o.qd)(e))}}class U extends s.y{initializeComponent(){(0,i.Vz)().setUserThemesHandler(new x(this))}loadUserThemeChoices(){return this.checkInitialized(),(0,i.Vz)().loadAllThemeJson()}setUserTheme(e,t){this.checkInitialized(),this.clearUserThemeCache();let n,a=e=e.replace(/^\w/,(e=>e.toUpperCase()));return e.toLowerCase()===R.ux&&t&&(a=R.Fx),n=k.L((()=>this.setUserThemeInWCSS(e,e.toLowerCase()===R.ux&&t)),2),this.SuiteApi.Configuration.IsPwa?n:n.then((()=>k.L((()=>this.setUserThemeInExchange(a,!0)),2)))}setUserThemeInWCSS(e,t){return new Promise(((n,r)=>{const o={url:(0,E.JT)("{0}/api/settings/theme",this.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:a.oZ.PUT,headers:A.n,body:JSON.stringify({ThemeID:e,PreferOfficeTheme:t})};(0,i.tZ)().tag("SetUserThemeStart",1,"WCSS",e),this.SuiteApi.Service.callEndpointWithOauthToken(o).then((t=>{(0,i.tZ)().tag("SetUserThemeSuccess",1,"WCSS",e),n({OwaSuccess:void 0,O365Success:!0})})).catch((e=>{a.F2.genericServiceRejection("Settings_SetUserThemeInWCSS_Failed",6,e,r)}))}))}setUserThemeSettingsInWCSS(e){return new Promise(((t,n)=>{const r={url:(0,E.JT)("{0}/api/settings/darkmode",this.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:a.oZ.PUT,headers:A.n,body:JSON.stringify({IsDarkmode:e})};this.SuiteApi.Service.callEndpointWithOauthToken(r).then((n=>{(0,i.tZ)().tag("SetUserThemeSettingsSuccess",1,e.toString()),t({O365Success:!0})})).catch((e=>{a.F2.genericServiceRejection("Settings_SetUserThemeSettingsInWCSS_Failed",6,e,n)}))}))}getModeLogo(e){return new Promise(((t,n)=>{const i={url:(0,E.JT)(`{0}/api/theme/tenant?useDarkMode=${e}`,this.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:a.oZ.GET,headers:A.n};this.SuiteApi.Service.callEndpointWithOauthToken(i).then((e=>{t(e)})).catch((e=>{a.F2.genericServiceRejection("Settings_GetModeLogoFromWCSS_Failed",6,e,n)}))}))}setUserThemeInExchange(e,t){return new Promise(((n,r)=>{(0,i.Vz)().getUserThemeByID(e).then((i=>{let o;o=this.SuiteApi.Configuration.OpxEnabled&&this.SuiteApi.Configuration.ExchangeDataOpxEnabled&&!this.SuiteApi.Configuration.IsOwa?this.setUserThemeViaOpx(e,t):this.setUserThemeViaSuiteServiceProxy(e,t,i),o.then((e=>{n({OwaSuccess:e.OwaSuccess,O365Success:e.O365Success||t})})).catch((e=>{a.F2.genericServiceRejection("Settings_SetUserThemeInExchange_Failed",6,e,r)}))}))}))}setUserThemeViaOpx(e,t){return n.e("exchangedata").then(n.bind(n,49861)).then((n=>n.setUserTheme(e,t)))}setUserThemeViaSuiteServiceProxy(e,t,n){const a={ThemeId:e,SkipO365Call:t};n&&e!==R.Fx&&(a.UserThemeJson=JSON.stringify(n));var i;const r={request:(i=a,(0,S.__assign)({__type:"SetUserThemeRequest:#Exchange"},i))};return new Promise(((e,t)=>{this.SuiteApi.User.getOwaUserConfiguration().then((t=>{let n=this.SuiteApi.Service.callOwaIframeAction("SetUserTheme",r);e(n)})).catch((e=>{t(e)}))}))}clearUserThemeCache(){this.SuiteApi.Configuration.ClearThemeCacheData&&0!==this.SuiteApi.Configuration.ClearThemeCacheData.length&&this.SuiteApi.Configuration.ClearThemeCacheData.map((e=>{if(null!=e.WorkloadUrl&&e.WorkloadUrl.length>0&&(!e.NoRequestInSameWorkload||this.SuiteApi.Configuration.WorkloadId.toLowerCase()!==e.WorkloadId.toLowerCase())&&null!=e.RequestType&&e.RequestType.length>0&&("img"===e.RequestType.toLowerCase()||"iframe"===e.RequestType.toLowerCase())){let t=document.createElement(e.RequestType);t.setAttribute("src",e.WorkloadUrl),t.setAttribute("style","display:none"),"iframe"===e.RequestType.toLowerCase()&&(t.addEventListener("load",(()=>document.body.removeChild(t))),document.body.appendChild(t))}}))}}class N extends s.y{initializeComponent(){this.userTheme=null==this.SuiteApi.Configuration.IUserThemeOverride?new U:this.SuiteApi.Configuration.IUserThemeOverride,this.languageAndTimeZone=null==this.SuiteApi.Configuration.ILanguageAndTimeZoneOverride?new O:this.SuiteApi.Configuration.ILanguageAndTimeZoneOverride,this.userTheme.initialize(this.SuiteApi),this.languageAndTimeZone.initialize(this.SuiteApi)}loadUserThemeChoices(){return this.userTheme.loadUserThemeChoices()}setUserTheme(e,t){return this.userTheme.setUserTheme(e,t)}getLanguageAndTimeZone(){return this.languageAndTimeZone.getLanguageAndTimeZone()}getLanguageChoices(){return this.languageAndTimeZone.getLanguageChoices()}getTimeZoneChoices(){return this.languageAndTimeZone.getTimeZoneChoices()}getDateTimeFormats(e){return this.languageAndTimeZone.getDateTimeFormats(e)}setLanguageAndTimeZone(e){return this.languageAndTimeZone.setLanguageAndTimeZone(e)}}var L=n(65599);const F="/v1.0/me/photo/$value";class M extends s.y{initializeComponent(){}get OwaUserConfig(){return this.userConfig}getOwaUserConfiguration(){null==this.userConfigPromise&&(this.userConfigPromise=this.getOwaUserConfigurationViaOpx());const e=window.setTimeout((()=>(0,i.tZ)().tag("User_GetOwaUserConfiguration_MessageTimeout",6)),15e3);return this.userConfigPromise.then((()=>window.clearTimeout(e))).catch((()=>window.clearTimeout(e))),this.userConfigPromise}getOwaUserConfigurationViaOpx(){return n.e("exchangedata").then(n.bind(n,49861)).then((e=>e.getOwaUserConfig())).catch((e=>{throw(0,i.tZ)().exception("User_GetOwaUserConfigurationViaOpx_Failed",4,e),e}))}getOwaUserConfigurationViaSuiteServiceProxy(){return new Promise(((e,t)=>{let n={command:a.kN.OwaUserConfig,timeout:1e4};const r=()=>{this.SuiteApi.Service.callOwaIframeAction("GetOwaUserConfiguration",{}).then((n=>{if(this.userConfig=n,null!=this.userConfig&&""!==this.userConfig)this.onOwaUserConfigSucceeded(e);else{const e=new a.WJ("null OwaUserConfiguration received from server");(0,i.tZ)().exception("User_GetOwaUserConfiguration_NullConfig",4,e),t(e)}})).catch((e=>{a.F2.genericServiceRejection("User_GetOwaUserConfiguration_Failed",4,e,t)}))};if(this.SuiteApi.Configuration.IsOwa)r();else{n.success=t=>{this.userConfig=t.responseObject,"GetOwaUserConfiguration"===a.pf.Instance.configuration.StartupActionName&&this.SuiteApi.Service.setStartupActionCompleted(),this.onOwaUserConfigSucceeded(e)},n.error=(e,t,n)=>{(0,i.tZ)().exception("GetOwaUserConfiguration_ContextUnavailable",4,new a.WJ(n,t)),r()};let o=a.b6.OwaInstance;null==o?t(new a.WJ("OwaIframe",-1011)):o.getOwaUserConfiguration(n)}}))}getPhotoFromGraph(e){let t=(0,E.vQ)(e)?F:(0,E.JT)("/v1.0/users/{0}/photo/$value",e),n={method:a.oZ.GET,resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthResourceUrl+t,binaryStringResponseBody:!0};return new Promise(((e,t)=>{this.SuiteApi.Service.callEndpointWithOauthToken(n).then((t=>{e(window.btoa(t))})).catch((n=>{404===n.errorInfo.HttpStatus?e(""):a.F2.genericServiceRejection("User_GetPhotoFromGraph_Failed",4,n,t)}))}))}prefetchGraphToken(){return new Promise(((e,t)=>{null!=this.SuiteApi.Configuration.GraphOauthResourceUrl?this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.GraphOauthResourceUrl+F,this.SuiteApi.Configuration.GraphOauthResourceUrl).then(e).catch(t):t()}))}uploadPhotoToGraph(e){let t=e.split(","),n=t[0].split(":")[1].split(";")[0],i=t[1],r={method:a.oZ.PUT,headers:{"Content-Type":n},timeout:7e3,body:window.atob(i),resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthResourceUrl+F,binaryStringRequestBody:!0};return new Promise(((e,t)=>{this.SuiteApi.Service.callEndpointWithOauthToken(r).then(e).catch((e=>{a.F2.genericServiceRejection("User_UploadPhotoToGraph_Failed",6,e,t)}))}))}onOwaUserConfigSucceeded(e){null!=this.userConfig.SessionSettings?a.pf.Instance.MailboxGuid=this.userConfig.SessionSettings.MailboxGuid:(0,i.tZ)().tag("User_GetOwaUserConfiguration_SessionSettingsNull",4),e(this.userConfig)}getOCPSUserPolicies(e,t){let n=this.SuiteApi.Configuration.OcpsOauthResourceUrl,i=e?n+"?PoliciesHash="+e:n,r={body:"",method:a.oZ.GET,headers:{Accept:"application/json","x-Cid":t},resource:i,url:this.SuiteApi.Configuration.OcpsOauthEndpointUrl};return new Promise(((e,t)=>{this.SuiteApi.Service.callEndpointWithOauthToken(r,!0).then((t=>{e(t)})).catch((e=>{a.F2.genericServiceRejection("getOCPSPolicies_Failed",6,e,t)}))}))}}class q{constructor(e){this.configuration=e,this.StartupActionName="GetOwaUserConfiguration",this.validateConfiguration(e),this.owaUrlSpecialHandling(e),a.pf.Initialize(Object.assign(Object.assign({},e),{StartupActionName:this.StartupActionName})),this.service=a.kl.Instance,this.storage=null==e.IStorageOverride?new L.wc:e.IStorageOverride,this.webShellStorage=null==e.IWebShellStorageOverride?new L._H:e.IWebShellStorageOverride,this.user=null==e.IUserOverride?new M:e.IUserOverride,this.settings=null==e.ISettingsOverride?new N:e.ISettingsOverride,this.documentsModule=null==e.IDocumentsOverride?new l:e.IDocumentsOverride,this.owaPoweredExperiences=null==e.IOwaPoweredExperiencesOverride?new g:e.IOwaPoweredExperiencesOverride,this.service=a.kl.Instance,e.UserHasExchangeLicense?e.SuiteServiceCallsDisabled?this.service.blockSuiteServiceCalls(a.IY.Brs):e.IsPwa&&!e.EnableSessionStorageForPWA&&this.service.blockSuiteServiceCalls(a.IY.Pwa):this.service.blockSuiteServiceCalls(a.IY.NoExoLicense),this.storage.initialize(this),this.webShellStorage.initialize(this),this.user.initialize(this),this.documentsModule.initialize(this),this.settings.initialize(this),e.OpxEnabled&&this.owaPoweredExperiences.initialize(this)}get Configuration(){return this.configuration}get Service(){return this.service}get User(){return this.user}get Storage(){return this.storage}get WebShellStorage(){return this.webShellStorage}get DocumentsModule(){return this.documentsModule}get OwaPoweredExperiences(){return this.owaPoweredExperiences}get Settings(){return this.settings}static CreateInstance(e){if(null!=this.instance){const e=new Error("Instance already exists.");throw(0,i.tZ)().exception("SuiteApi_InstanceAlreadyExists",6,e),e}return this.instance=new q(e),this.instance}static isInitialized(){return null!=this.instance}static get Instance(){if(null==q.instance)throw new Error("Instance not yet created.");return q.instance}static clearInstanceForTesting(){a.pf.isUnitTestMode&&(q.instance=null,a.b6.resetAllInstancesForTesting())}validateConfiguration(e){r.throwOnNullOrUndefined(e,"configuration"),r.throwOnNullOrUndefined(e.SuiteServiceUrl,"SuiteApiConfiguration.SuiteServiceUrl")}owaUrlSpecialHandling(e){if(e.IsOwa){const t=e.SuiteServiceUrl.toLowerCase(),n=a.OY.getUrlDomainPart(t),i=a.OY.getUrlDomainPart(window.location.href).toLowerCase();n!==i&&(e.SuiteServiceUrl=t.replace(n,i))}}}},30086:function(e,t,n){"use strict";n.d(t,{y:function(){return r}});var a=n(24126),i=n(87894);class r{constructor(){this.isInitialized=!1}get SuiteApi(){return this.suiteApi}get IsInitialized(){return this.isInitialized}initialize(e){i.throwOnNullOrUndefined(e,"suiteApi"),this.IsInitialized||(this.suiteApi=e,this.initializeComponent(),this.isInitialized=!0)}checkInitialized(){if(!this.isInitialized)throw new a.WJ("SuiteApiComponent_InvalidInitializationCheck",-2002)}}},53464:function(e,t,n){"use strict";n.d(t,{n:function(){return a},w:function(){return i}});const a={Accept:"application/json","Content-Type":"application/json; charset=utf-8"},i={Accept:"application/json","Content-Type":"application/json; charset=utf-8"}},68392:function(e,t,n){"use strict";n.d(t,{E:function(){return r},h:function(){return i}});var a=n(24126);function i(e){return new a.WJ(`Argument Exception: ${e}`,-2001)}function r(e){return new a.WJ(`Invalid Operation: ${e}`,-2002)}},55797:function(e,t,n){"use strict";n.d(t,{F:function(){return o.F}});var a=n(16968),i=n(44966),r=n(66164),o=n(91336);n(68392);function s(e,t){var n,a;let r=null!==(n=t.OpxDefaultHostUrl)&&void 0!==n?n:i.mf;const o=null!==(a=t.OpxAlternateHostUrls)&&void 0!==a?a:i.u0;return null!=e.opxHostUrlOverride&&o.indexOf(e.opxHostUrlOverride)>=0&&(r=e.opxHostUrlOverride),r}(0,a.NP)().subscribe("ShellDataUpdated",(function e(t,n){var l,c;if(n.SuiteServiceUrl&&(n.IsConsumerShell||n.TokenFactoryIframeOrigin)&&!o.F.isInitialized()){const u=(0,a.GJ)(),p={SuiteServiceUrl:n.SuiteServiceUrl,AdminServiceUrl:n.PortalUrl,CurrentUserUpn:n.UPN,CurrentUserPuid:n.PUID,UserHasExchangeLicense:n.HasEXOLicense,SuiteServiceCallsDisabled:n.SuiteServiceCallsDisabled,TokenFactoryIframeOrigin:n.TokenFactoryIframeOrigin,IsOwa:(0,r.Uc)(n.WorkloadId),ShellSID:n.SHSID,HintUserName:null!=n.EnableUsernameHinting&&n.EnableUsernameHinting,CultureName:t.CultureName,MruOauthEndpointUrl:n.MruOauthEndpointUrl,MruOauthResourceUrl:n.MruOauthResourceUrl,GraphOauthEndpointUrl:n.GraphOauthEndpointUrl,GraphOauthResourceUrl:n.GraphOauthResourceUrl,OcpsOauthEndpointUrl:n.OcpsOauthEndpointUrl,OcpsOauthResourceUrl:n.OcpsOauthResourceUrl,NotificationsEnabled:n.NotificationsEnabled&&n.HasEXOLicense,WorkloadId:n.WorkloadId,ClientShellVersion:window.O365ShellVerStr,IsPwa:(0,r.bi)(n.WorkloadId,t.CurrentMainLinkElementID),IsOwsLanguageTimezoneCallEnabled:n.OwsLanguageTimezoneCallEnabled,GetTokenRequestDictionary:u.GetTokenRequestDictionary,ServiceWorkerCacheId:u.serviceWorkerCacheId,ServiceWorkerFetchStrategy:u.serviceWorkerFetchStrategy,ClearThemeCacheData:null!=n.ClearUserThemeCacheUrls&&n.ClearUserThemeCacheUrls.length>0?JSON.parse(n.ClearUserThemeCacheUrls):[],EnableTokenDictionary:n.EnableTokenDictionary||(null==u?void 0:u.enableTokenDictionary),IsConsumer:n.IsConsumerShell,CSSExperiencesEnabled:n.CSSExperiencesEnabled,OpxEnabled:n.OpxEnabled&&!(0,r.bi)(n.WorkloadId,t.CurrentMainLinkElementID),OpxHostUrl:s(u,n),OpxResourceUrl:null!==(l=n.OpxDefaultHostUrl)&&void 0!==l?l:i.mf,ExchangeDataOpxEnabled:n.ExchangeDataOpxEnabled,EnableSessionStorageForPWA:null!==(c=u.enableSessionStorageForPWA)&&void 0!==c&&c};o.F.CreateInstance(p);const d=(0,a.NP)();d.invoke("SuiteAPILoaded",o.F.Instance),d.unsubscribe("ShellDataUpdated",e)}}),!0)},95797:function(e,t,n){"use strict";n.d(t,{D:function(){return l}});var a=n(16533),i=n(44954),r=n(16968),o=n(1742),s=n(55797);const l=new class{callExternalGet(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t={url:e,method:i.o.GET,resource:s.F.Instance.Configuration.TokenFactoryIframeOrigin,headers:{Accept:"application/json"}};return s.F.Instance.Service.callEndpointWithOauthToken(t)}))}getCopilotCreative(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function*(){var a,i;const s=`https://arc.msn.com/v4/api/selection?placement=${e}&locale=${t}&country=${n}&nct=1`;try{const e=yield this.callExternalGet(s);if(null==e?void 0:e.error){const t=e.error.code,n=e.error.msg;throw(0,r.tZ)().tag("IrisApiService_GetCopilotCreative_ErrorResponse",4,t,n,s),new Error(`IRIS creative error: ${n||t}`)}if(!(null==e?void 0:e.ad))throw new Error("IRIS creative response missing 'ad' block.");const t=Number(e.ad.rowStart),n=isFinite(t)&&t>=0?t:0,l=null===(a=e.prm)||void 0===a?void 0:a._imp,c=(null===(i=e.tracking)||void 0===i?void 0:i.baseUri)||"";return{title:e.ad.title,description:e.ad.description,buttonText:e.ad.buttonText,designOption:(0,o.I_)(e.ad.designOption),rowStart:n,cmmId:e.ad.cmmId,buttonURL:e.ad.buttonURL,actionUrl:c,buildTrackingUrl:e=>c.replace("{ACTION}",e),impressionUrl:l}}catch(e){throw(0,r.tZ)().exception("IrisApiService_GetCopilotCreative_Failed",6,e,null==e?void 0:e.errorCode,null==e?void 0:e.message),e}}))}postCopilotAction(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){try{yield this.callExternalGet(e)}catch(e){(0,r.tZ)().exception("IrisApiService_PostCopilotAction_Failed",6,e,null==e?void 0:e.errorCode,null==e?void 0:e.message)}}))}postCopilotImpression(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){try{yield this.callExternalGet(e)}catch(e){(0,r.tZ)().exception("IrisApiService_PostCopilotImpression_Failed",6,e,null==e?void 0:e.errorCode,null==e?void 0:e.message)}}))}}},62853:function(e,t,n){"use strict";var a;n.d(t,{G:function(){return a}}),function(e){e.MyDay="MyDay",e.ExchangeData="ExchangeData"}(a||(a={}))},14274:function(e,t,n){"use strict";var a,i;n.d(t,{b:function(){return a},i:function(){return i}}),function(e){e.SystemMetadata="SystemMetadata",e.CustomerContent="CustomerContent"}(a||(a={})),function(e){e.User="User",e.Tenant="Tenant"}(i||(i={}))},65599:function(e,t,n){"use strict";n.d(t,{wc:function(){return f},bQ:function(){return y.b},Zg:function(){return u},_H:function(){return b},ir:function(){return y.i}});var a=n(24126),i=n(16968),r=n(30086),o=n(68392);const s=a.OY.SuiteServiceApiRelativePath+"NotificationsSettings/User";class l{constructor(e){this.suiteApi=e}readNotificationSettings(){return new Promise(((e,t)=>{this.suiteApi.Service.callOwaIframeResourceUrl(s,null,a.oZ.GET).then((t=>{e(t)})).catch((e=>{a.F2.genericServiceRejection("ReadNotificationSettings",6,e,t)}))}))}writeNotificationSettings(e){return new Promise(((t,n)=>{if(null==e)throw(0,o.h)("settingValue");this.suiteApi.Service.callOwaIframeResourceUrl(s,e,a.oZ.PUT).then((()=>{t()})).catch((e=>{a.F2.genericServiceRejection("WriteNotificationSettings",6,e,n)}))}))}}var c=n(87894);class u{constructor(e,t,n){this.Scope=e,this.Namespace=t,this.Name=n,(0,c.throwOnNullOrEmpty)(e,"keyScope"),(0,c.throwOnNullOrEmpty)(t,"keyNamespace"),(0,c.throwOnNullOrEmpty)(n,"keyName")}toString(){return this.Scope+a.YM.DictionaryStringPartsSeparator+this.Namespace+a.YM.DictionaryStringPartsSeparator+this.Name}static fromDictionaryKey(e){(0,c.throwOnNullOrEmpty)(e,"keyString");const t=e.split(a.YM.DictionaryStringPartsSeparator);if(t.length<3)throw(0,o.E)("Malformed keyString: Expected format <Scope>//<Namespace>//<Name>");return new u(t[0],t[1],t[2])}}class p{constructor(e,t){this.Key=e,this.Value=t,(0,c.throwOnNull)(e,"key"),(0,c.throwOnNull)(t,"value")}}class d{constructor(e){this.Header=e}}class h extends d{constructor(e,t){super(e),this.Header=e,this.Body=t}}const m="Cannot remove a key needed for read or write.";class g{constructor(e=!1,t=[],n={},a=[]){this.clearAll=e,this.writes=n,this.reads={},this.removes={},t.forEach((e=>this.reads[e.toString()]=e)),a.forEach((e=>this.removes[e.toString()]=e))}getReadStorageKeys(){return Object.keys(this.reads).map((e=>this.reads[e]))}getWriteStorageKeyValues(){return Object.keys(this.writes).map((e=>this.writes[e]))}getRemoveStorageKeys(){return Object.keys(this.removes).map((e=>this.removes[e]))}requestRead(...e){(0,c.throwOnNullOrEmptyArray)(e,"keys");for(let t of e){if((0,c.throwOnNull)(t,"key"),this.isRemoveRequested(t))throw new a.WJ(m,-2002);this.reads[t.toString()]=t}}requestWrite(e,...t){(0,c.throwOnUndefined)(e,"value"),(0,c.throwOnNullOrEmptyArray)(t,"keys");for(let n of t){if((0,c.throwOnNull)(n,"key"),this.isRemoveRequested(n))throw new a.WJ(m,-2002);this.writes[n.toString()]=new p(n,e)}}requestRemove(...e){(0,c.throwOnNullOrEmptyArray)(e,"keys");for(let t of e){if((0,c.throwOnNull)(t,"key"),t.toString()in this.reads||t.toString()in this.writes)throw new a.WJ(m,-2002);this.removes[t.toString()]=t}}requestClearAll(){this.clearAll=!0}combine(...e){(0,c.throwOnNullOrEmptyArray)(e,"requests");let t=new g(this.clearAll);for(let n of e.concat(this)){n.getReadStorageKeys().length&&t.requestRead(...n.getReadStorageKeys());for(let e of Object.keys(n.writes))t.requestWrite(n.writes[e].Value,n.writes[e].Key);n.getRemoveStorageKeys().length&&t.requestRemove(...n.getRemoveStorageKeys())}return t}valueToBeWritten(e){(0,c.throwOnNullOrUndefined)(e,"key");const t=this.writes[e.toString()];if(null==t)throw new a.WJ("Cannot read key without value.",-2002);return t.Value}isRemoveRequested(e){return(0,c.throwOnNullOrUndefined)(e,"key"),e.toString()in this.removes}isClearAllRequested(){return this.clearAll}toStorageServerJsonRequest(){const e={ReadSettings:this.getReadStorageKeys().slice(),WriteSettings:this.getWriteStorageKeyValues().map((e=>new p(e.Key,JSON.stringify(e.Value))))};return new h({},e)}toStorageDataRequest(e){return{UserId:e,ClearAll:this.clearAll,Reads:this.getReadStorageKeys().map((e=>e.toString())),Writes:this.getWriteStorageKeyValues().map((e=>({Key:e.Key.toString(),Value:JSON.stringify(e.Value)}))),Deletes:this.getRemoveStorageKeys().map((e=>e.toString())),RequestType:0}}}class S{constructor(e={}){this.values=e}static fromStorageSessionResponseData(e){c.throwOnNullOrUndefined(e,"data");let t=new S({});for(let n of Object.keys(e.Reads)){const a=new p(u.fromDictionaryKey(n),JSON.parse(e.Reads[n]));t.values[a.Key.toString()]=a.Value}return t}static fromStorageServerResponseData(e){c.throwOnNullOrUndefined(e,"data");let t=new S({});for(let n of e.Settings){const e=new p(n.Key,JSON.parse(n.Value));t.values[e.Key.toString()]=e.Value}return t}hasKey(e){return c.throwOnNullOrUndefined(e,"key"),e.toString()in this.values}value(e){if(c.throwOnNullOrUndefined(e,"key"),!(e.toString()in this.values))throw new a.WJ("Key value missing.",-2002);return this.values[e.toString()]}getStorageKeyValues(){return Object.keys(this.values).map((e=>this.values[e]))}}class f extends r.y{initializeComponent(){this.NotificationsStorage=new l(this.SuiteApi)}createStorageRequest(){return this.checkInitialized(),new g}submitStorageRequestToOwaSessionStorage(e,t){return this.checkInitialized(),new Promise(((n,r)=>{if(null==e)return r(o.h("request"));this.SuiteApi.Service.owaSessionStorageRequest(e.toStorageDataRequest(this.SuiteApi.Configuration.CurrentUserUpn)).then((e=>{this.checkStorageResponseErrors(e,r)||n(S.fromStorageSessionResponseData(e))})).catch((e=>{a.F2.isCallsBlockedException(e)||(0,i.tZ)().exception("SubmitStorageRequestToSessionStorage_Failed",4,e,e.errorCode),r(e)})),null!=t&&window.setTimeout((()=>{const e=new Error("Session Storage Request Timeout");(0,i.tZ)().exception("SubmitStorageRequestToSessionStorage_Failed",4,e,-1001),r(e)}),t)}))}isServerStorageEnabled(e){return a.pf.Instance.configuration.UserHasExchangeLicense||e}readNotificationSettings(){return this.checkInitialized(),this.NotificationsStorage.readNotificationSettings()}writeNotificationSettings(e){return this.checkInitialized(),this.NotificationsStorage.writeNotificationSettings(e)}checkStorageResponseErrors(e,t){let n=e;return n.ClearError,n.WriteError,n.ReadError,null!=n.ResetError&&(t(n.ResetError),!0)}}var y=n(14274),C=n(95144),I=n(45011),v=n(53464);class A{constructor(e=new g){this.storageRequest=e}requestRead(...e){this.storageRequest.requestRead(...e)}requestWrite(e,...t){this.storageRequest.requestWrite(e,...t)}toStorageDataRequest(e){return this.storageRequest.toStorageDataRequest(e)}requestClearAll(){this.storageRequest.requestClearAll()}}class T{constructor(e=void 0){this.value=e}fromStorageSessionResponseData(e){this.storageResponse=S.fromStorageSessionResponseData(e)}hasValue(e){return C.nQ.throwOnNullOrUndefined(this.storageResponse,"storageResponse"),this.storageResponse.hasKey(e)&&null!=this.storageResponse.value(e)}getValue(e){return C.nQ.throwOnNullOrUndefined(this.storageResponse,"storageResponse"),this.storageResponse.value(e)}}class b extends r.y{initializeComponent(){}createWebShellStorageRequest(){return this.checkInitialized(),new A}readStorage(e,t,n){this.checkInitialized();const i=this.createTokenFactoryRequest(t,e,n,a.oZ.GET);return this.useStorage(i)}batchReadStorage(e,t,n){this.checkInitialized();const i=this.createTokenFactoryBatchRequest(t,e,n,a.oZ.GET);return this.useStorage(i)}writeStorage(e,t,n,i){this.checkInitialized();const r=this.createTokenFactoryRequest(t,e,n,a.oZ.PUT);return r.body=JSON.stringify(i),this.useStorage(r)}removeStorage(e,t,n){this.checkInitialized();const i=this.createTokenFactoryRequest(t,e,n,a.oZ.DELETE);return this.useStorage(i)}readSessionStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}writeSessionStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}removeSessionStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}readLocalStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}writeLocalStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}removeLocalStorage(e){return Promise.reject(new Error("not implemented"))}createTokenFactoryRequest(e,t,n,a){C.nQ.throwOnNullOrEmpty(n,"keyName");const i=(0,C.JT)("{0}/api/storage/{1}/{2}/{3}?api-version={4}&shellType=OneShell",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e,t,encodeURIComponent(n),b.ApiVersion);return this.createTokenFactoryRequestHelper(i,a)}createTokenFactoryBatchRequest(e,t,n,a){C.nQ.throwOnNullOrEmptyArray(n,"keyNames");const i=(0,C.JT)("{0}/api/storage/{1}/{2}/{3}?api-version={4}",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e,t,encodeURIComponent(n.join(",")),b.ApiVersion);return this.createTokenFactoryRequestHelper(i,a)}createTokenFactoryRequestHelper(e,t){return{url:e,resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:t,headers:v.n}}useStorage(e){return new Promise(((t,n)=>{this.SuiteApi.Service.callEndpointWithOauthToken(e).then((e=>{t(new T(e))})).catch(n)}))}useBrowserStorage(e){return new Promise(((t,n)=>{C.nQ.throwOnNull(e,"StorageRequest");let r=!1,s=e.toStorageDataRequest(this.SuiteApi.Configuration.CurrentUserUpn),l={url:a.pf.Instance.configuration.TokenFactoryIframeOrigin,requestObject:s,timeout:3e4,success:e=>{r=!0;let a=e.responseObject;if(!this.checkStorageResponseErrors(a,n)){let e=new T;e.fromStorageSessionResponseData(a),t(e)}},error:(e,t,a)=>{r=!0;let s=I.Ru(a);(0,i.tZ)().tag("StorageApi_RequestError",6,t,s),n((0,o.E)(s))}},c=null;this.SuiteApi.Service.AreSuiteServiceCallsBlocked||(c=a.b6.OauthTokenFactoryInstance),null!=c?(setTimeout((()=>{if(!r){r=!0;const e=new Error("StorageTimeout");(0,i.tZ)().exception("StorageApi_TimeoutError",6,e),n(e)}}),l.timeout),c.executeStorageRequest(l)):n(new a.WJ("OauthTokenFactoryIframe",-1011))}))}checkStorageResponseErrors(e,t){let n=e;if(!n){let e=new Error("Empty response received.");(0,i.tZ)().exception("StorageApi_NoResponse",6,e),t(e)}if(null!=n.ClearError)t(n.ClearError);else if(null!=n.WriteError)t(n.WriteError);else if(null!=n.ReadError)t(n.ReadError);else{if(null==n.ResetError)return!1;t(n.ResetError)}return!0}}b.ApiVersion="1"},47562:function(e){"use strict";e.exports=JSON.parse('[{"Locale":"af-NA","DisplayName":"Afrikaans (Namibi)"},{"Locale":"af-ZA","DisplayName":"Afrikaans (Suid-Afrika)"},{"Locale":"am-ET","DisplayName":" ()"},{"Locale":"ar-AE","DisplayName":" (  )"},{"Locale":"ar-BH","DisplayName":" ()"},{"Locale":"ar-DJ","DisplayName":" ()"},{"Locale":"ar-DZ","DisplayName":" ()"},{"Locale":"ar-EG","DisplayName":" ()"},{"Locale":"ar-ER","DisplayName":" ()"},{"Locale":"ar-IL","DisplayName":" ()"},{"Locale":"ar-IQ","DisplayName":" ()"},{"Locale":"ar-JO","DisplayName":" ()"},{"Locale":"ar-KM","DisplayName":" ( )"},{"Locale":"ar-KW","DisplayName":" ()"},{"Locale":"ar-LB","DisplayName":" ()"},{"Locale":"ar-LY","DisplayName":" ()"},{"Locale":"ar-MA","DisplayName":" ( )"},{"Locale":"ar-MR","DisplayName":" ()"},{"Locale":"ar-OM","DisplayName":" ()"},{"Locale":"ar-PS","DisplayName":" ( )"},{"Locale":"ar-QA","DisplayName":" ()"},{"Locale":"ar-SA","DisplayName":" (  )"},{"Locale":"ar-SO","DisplayName":" ()"},{"Locale":"ar-SS","DisplayName":" ( )"},{"Locale":"ar-TD","DisplayName":" ()"},{"Locale":"ar-TN","DisplayName":" ()"},{"Locale":"as-IN","DisplayName":" ()"},{"Locale":"az-Latn-AZ","DisplayName":"azrbaycan (Azrbaycan)"},{"Locale":"be-BY","DisplayName":" ()"},{"Locale":"bg-BG","DisplayName":" ()"},{"Locale":"bn-BD","DisplayName":" ()"},{"Locale":"bn-IN","DisplayName":" ()"},{"Locale":"bs-Latn-BA","DisplayName":"bosanski (Bosna i Hercegovina)"},{"Locale":"ca-AD","DisplayName":"catal (Andorra)"},{"Locale":"ca-ES","DisplayName":"catal (catal)"},{"Locale":"ca-FR","DisplayName":"catal (Frana)"},{"Locale":"ca-IT","DisplayName":"catal (Itlia)"},{"Locale":"cs-CZ","DisplayName":"etina (esko)"},{"Locale":"cy-GB","DisplayName":"Cymraeg (Y Deyrnas Unedig)"},{"Locale":"da-DK","DisplayName":"dansk (Danmark)"},{"Locale":"da-GL","DisplayName":"dansk (Grnland)"},{"Locale":"de-AT","DisplayName":"Deutsch (sterreich)"},{"Locale":"de-BE","DisplayName":"Deutsch (Belgien)"},{"Locale":"de-CH","DisplayName":"Deutsch (Schweiz)"},{"Locale":"de-DE","DisplayName":"Deutsch (Deutschland)"},{"Locale":"de-IT","DisplayName":"Deutsch (Italien)"},{"Locale":"de-LI","DisplayName":"Deutsch (Liechtenstein)"},{"Locale":"de-LU","DisplayName":"Deutsch (Luxemburg)"},{"Locale":"el-CY","DisplayName":" ()"},{"Locale":"el-GR","DisplayName":" ()"},{"Locale":"en-GB","DisplayName":"English (United Kingdom)"},{"Locale":"es-AR","DisplayName":"espaol (Argentina)"},{"Locale":"es-BO","DisplayName":"espaol (Bolivia)"},{"Locale":"es-BR","DisplayName":"espaol (Brasil)"},{"Locale":"es-BZ","DisplayName":"espaol (Belice)"},{"Locale":"es-CL","DisplayName":"espaol (Chile)"},{"Locale":"es-CO","DisplayName":"espaol (Colombia)"},{"Locale":"es-CR","DisplayName":"espaol (Costa Rica)"},{"Locale":"es-CU","DisplayName":"espaol (Cuba)"},{"Locale":"es-DO","DisplayName":"espaol (Repblica Dominicana)"},{"Locale":"es-EC","DisplayName":"espaol (Ecuador)"},{"Locale":"es-ES","DisplayName":"espaol (Espaa, alfabetizacin internacional)"},{"Locale":"es-GQ","DisplayName":"espaol (Guinea Ecuatorial)"},{"Locale":"es-GT","DisplayName":"espaol (Guatemala)"},{"Locale":"es-HN","DisplayName":"espaol (Honduras)"},{"Locale":"es-MX","DisplayName":"espaol (Mxico)"},{"Locale":"es-NI","DisplayName":"espaol (Nicaragua)"},{"Locale":"es-PA","DisplayName":"espaol (Panam)"},{"Locale":"es-PE","DisplayName":"espaol (Per)"},{"Locale":"es-PH","DisplayName":"espaol (Filipinas)"},{"Locale":"es-PR","DisplayName":"espaol (Puerto Rico)"},{"Locale":"es-PY","DisplayName":"espaol (Paraguay)"},{"Locale":"es-SV","DisplayName":"espaol (El Salvador)"},{"Locale":"es-US","DisplayName":"espaol (Estados Unidos)"},{"Locale":"es-UY","DisplayName":"espaol (Uruguay)"},{"Locale":"es-VE","DisplayName":"espaol (Venezuela)"},{"Locale":"et-EE","DisplayName":"eesti (Eesti)"},{"Locale":"eu-ES","DisplayName":"euskara (euskara)"},{"Locale":"fa-IR","DisplayName":" ()"},{"Locale":"fi-FI","DisplayName":"suomi (Suomi)"},{"Locale":"fil-PH","DisplayName":"Filipino (Pilipinas)"},{"Locale":"fr-BE","DisplayName":"franais (Belgique)"},{"Locale":"fr-BF","DisplayName":"franais (Burkina Faso)"},{"Locale":"fr-BI","DisplayName":"franais (Burundi)"},{"Locale":"fr-BJ","DisplayName":"franais (Bnin)"},{"Locale":"fr-BL","DisplayName":"franais (Saint-Barthlemy)"},{"Locale":"fr-CA","DisplayName":"franais (Canada)"},{"Locale":"fr-CF","DisplayName":"franais (Rpublique centrafricaine)"},{"Locale":"fr-CG","DisplayName":"franais (Congo)"},{"Locale":"fr-CH","DisplayName":"franais (Suisse)"},{"Locale":"fr-CI","DisplayName":"franais (Cte dIvoire)"},{"Locale":"fr-CM","DisplayName":"franais (Cameroun)"},{"Locale":"fr-DJ","DisplayName":"franais (Djibouti)"},{"Locale":"fr-DZ","DisplayName":"franais (Algrie)"},{"Locale":"fr-FR","DisplayName":"franais (France)"},{"Locale":"fr-GA","DisplayName":"franais (Gabon)"},{"Locale":"fr-GF","DisplayName":"franais (Guyane franaise)"},{"Locale":"fr-GN","DisplayName":"franais (Guine)"},{"Locale":"fr-GP","DisplayName":"franais (Guadeloupe)"},{"Locale":"fr-GQ","DisplayName":"franais (Guine quatoriale)"},{"Locale":"fr-HT","DisplayName":"franais (Hati)"},{"Locale":"fr-KM","DisplayName":"franais (Comores)"},{"Locale":"fr-LU","DisplayName":"franais (Luxembourg)"},{"Locale":"fr-MA","DisplayName":"franais (Maroc)"},{"Locale":"fr-MC","DisplayName":"franais (Monaco)"},{"Locale":"fr-MF","DisplayName":"franais (Saint-Martin)"},{"Locale":"fr-MG","DisplayName":"franais (Madagascar)"},{"Locale":"fr-ML","DisplayName":"franais (Mali)"},{"Locale":"fr-MQ","DisplayName":"franais (Martinique)"},{"Locale":"fr-MR","DisplayName":"franais (Mauritanie)"},{"Locale":"fr-MU","DisplayName":"franais (Maurice)"},{"Locale":"fr-NC","DisplayName":"franais (Nouvelle-Caldonie)"},{"Locale":"fr-NE","DisplayName":"franais (Niger)"},{"Locale":"fr-PF","DisplayName":"franais (Polynsie franaise)"},{"Locale":"fr-PM","DisplayName":"franais (Saint-Pierre-et-Miquelon)"},{"Locale":"fr-RE","DisplayName":"franais (La Runion)"},{"Locale":"fr-RW","DisplayName":"franais (Rwanda)"},{"Locale":"fr-SC","DisplayName":"franais (Seychelles)"},{"Locale":"fr-SN","DisplayName":"franais (Sngal)"},{"Locale":"fr-TD","DisplayName":"franais (Tchad)"},{"Locale":"fr-TG","DisplayName":"franais (Togo)"},{"Locale":"fr-TN","DisplayName":"franais (Tunisie)"},{"Locale":"fr-VU","DisplayName":"franais (Vanuatu)"},{"Locale":"fr-WF","DisplayName":"franais (Wallis-et-Futuna)"},{"Locale":"fr-YT","DisplayName":"franais (Mayotte)"},{"Locale":"ga-IE","DisplayName":"Gaeilge (ire)"},{"Locale":"gd-GB","DisplayName":"Gidhlig (An Roghachd Aonaichte)"},{"Locale":"gl-ES","DisplayName":"galego (galego)"},{"Locale":"gu-IN","DisplayName":" ()"},{"Locale":"ha-Latn-NG","DisplayName":"Hausa (Najeriya)"},{"Locale":"he-IL","DisplayName":" ()"},{"Locale":"hi-IN","DisplayName":" ()"},{"Locale":"hr-BA","DisplayName":"hrvatski (Bosna i Hercegovina)"},{"Locale":"hr-HR","DisplayName":"hrvatski (Hrvatska)"},{"Locale":"hu-HU","DisplayName":"magyar (Magyarorszg)"},{"Locale":"hy-AM","DisplayName":" ()"},{"Locale":"id-ID","DisplayName":"Indonesia (Indonesia)"},{"Locale":"is-IS","DisplayName":"slenska (sland)"},{"Locale":"it-CH","DisplayName":"italiano (Svizzera)"},{"Locale":"it-IT","DisplayName":"italiano (Italia)"},{"Locale":"it-SM","DisplayName":"italiano (San Marino)"},{"Locale":"it-VA","DisplayName":"italiano (Citt del Vaticano)"},{"Locale":"ja-JP","DisplayName":" ()"},{"Locale":"ka-GE","DisplayName":" ()"},{"Locale":"kk-KZ","DisplayName":"  ()"},{"Locale":"km-KH","DisplayName":" ()"},{"Locale":"kn-IN","DisplayName":" ()"},{"Locale":"ko-KR","DisplayName":"()"},{"Locale":"kok-IN","DisplayName":" ()"},{"Locale":"ky-KG","DisplayName":" ()"},{"Locale":"lb-LU","DisplayName":"Ltzebuergesch (Ltzebuerg)"},{"Locale":"lo-LA","DisplayName":" ()"},{"Locale":"lt-LT","DisplayName":"lietuvi (Lietuva)"},{"Locale":"lv-LV","DisplayName":"latvieu (Latvija)"},{"Locale":"mi-NZ","DisplayName":"te reo Mori (Aotearoa)"},{"Locale":"mk-MK","DisplayName":" ( )"},{"Locale":"ml-IN","DisplayName":" ()"},{"Locale":"mn-MN","DisplayName":" ()"},{"Locale":"mr-IN","DisplayName":" ()"},{"Locale":"ms-BN","DisplayName":"Melayu (Brunei)"},{"Locale":"ms-MY","DisplayName":"Melayu (Malaysia)"},{"Locale":"ms-SG","DisplayName":"Melayu (Singapura)"},{"Locale":"mt-MT","DisplayName":"Malti (Malta)"},{"Locale":"nb-NO","DisplayName":"norsk bokml (Norge)"},{"Locale":"nb-SJ","DisplayName":"norsk bokml (Svalbard og Jan Mayen)"},{"Locale":"ne-NP","DisplayName":" ()"},{"Locale":"nl-AW","DisplayName":"Nederlands (Aruba)"},{"Locale":"nl-BE","DisplayName":"Nederlands (Belgi)"},{"Locale":"nl-BQ","DisplayName":"Nederlands (Bonaire, Sint Eustatius en Saba)"},{"Locale":"nl-CW","DisplayName":"Nederlands (Curaao)"},{"Locale":"nl-NL","DisplayName":"Nederlands (Nederland)"},{"Locale":"nl-SR","DisplayName":"Nederlands (Suriname)"},{"Locale":"nl-SX","DisplayName":"Nederlands (Sint-Maarten)"},{"Locale":"or-IN","DisplayName":" ()"},{"Locale":"pa-IN","DisplayName":" ()"},{"Locale":"pl-PL","DisplayName":"polski (Polska)"},{"Locale":"prs-AF","DisplayName":" ()"},{"Locale":"pt-AO","DisplayName":"portugus (Angola)"},{"Locale":"pt-BR","DisplayName":"portugus (Brasil)"},{"Locale":"pt-CH","DisplayName":"portugus (Sua)"},{"Locale":"pt-CV","DisplayName":"portugus (Cabo Verde)"},{"Locale":"pt-GQ","DisplayName":"portugus (Guin Equatorial)"},{"Locale":"pt-GW","DisplayName":"portugus (Guin-Bissau)"},{"Locale":"pt-LU","DisplayName":"portugus (Luxemburgo)"},{"Locale":"pt-MO","DisplayName":"portugus (RAE de Macau)"},{"Locale":"pt-MZ","DisplayName":"portugus (Moambique)"},{"Locale":"pt-PT","DisplayName":"portugus (Portugal)"},{"Locale":"pt-ST","DisplayName":"portugus (So Tom e Prncipe)"},{"Locale":"pt-TL","DisplayName":"portugus (Timor-Leste)"},{"Locale":"quz-PE","DisplayName":"Runasimi (Per)"},{"Locale":"ro-MD","DisplayName":"romn (Republica Moldova)"},{"Locale":"ro-RO","DisplayName":"romn (Romnia)"},{"Locale":"ru-BY","DisplayName":" ()"},{"Locale":"ru-KG","DisplayName":" ()"},{"Locale":"ru-KZ","DisplayName":" ()"},{"Locale":"ru-MD","DisplayName":" ()"},{"Locale":"ru-RU","DisplayName":" ()"},{"Locale":"ru-UA","DisplayName":" ()"},{"Locale":"sd-Arab-PK","DisplayName":" ()"},{"Locale":"si-LK","DisplayName":" ( )"},{"Locale":"sk-SK","DisplayName":"slovenina (Slovensko)"},{"Locale":"sl-SI","DisplayName":"slovenina (Slovenija)"},{"Locale":"sq-AL","DisplayName":"shqip (Shqipri)"},{"Locale":"sq-MK","DisplayName":"shqip (Maqedonia e Veriut)"},{"Locale":"sq-XK","DisplayName":"shqip (Kosov)"},{"Locale":"sr-Cyrl-BA","DisplayName":" (  )"},{"Locale":"sr-Cyrl-ME","DisplayName":" ( )"},{"Locale":"sr-Cyrl-RS","DisplayName":" ()"},{"Locale":"sr-Cyrl-XK","DisplayName":" ()"},{"Locale":"sr-Latn-BA","DisplayName":"srpski (Bosna i Hercegovina)"},{"Locale":"sr-Latn-ME","DisplayName":"srpski (Crna Gora)"},{"Locale":"sr-Latn-RS","DisplayName":"srpski (Srbija)"},{"Locale":"sr-Latn-XK","DisplayName":"srpski (Kosovo)"},{"Locale":"sv-AX","DisplayName":"svenska (land)"},{"Locale":"sv-FI","DisplayName":"svenska (Finland)"},{"Locale":"sv-SE","DisplayName":"svenska (Sverige)"},{"Locale":"sw-KE","DisplayName":"Kiswahili (Kenya)"},{"Locale":"sw-TZ","DisplayName":"Kiswahili (Tanzania)"},{"Locale":"sw-UG","DisplayName":"Kiswahili (Uganda)"},{"Locale":"ta-IN","DisplayName":" ()"},{"Locale":"ta-LK","DisplayName":" ()"},{"Locale":"ta-MY","DisplayName":" ()"},{"Locale":"ta-SG","DisplayName":" ()"},{"Locale":"te-IN","DisplayName":" ()"},{"Locale":"th-TH","DisplayName":" ()"},{"Locale":"tk-TM","DisplayName":"Trkmen dili (Trkmenistan)"},{"Locale":"tr-CY","DisplayName":"Trke (Kbrs)"},{"Locale":"tr-TR","DisplayName":"Trke (Trkiye)"},{"Locale":"tt-RU","DisplayName":" ()"},{"Locale":"ug-CN","DisplayName":" (  )"},{"Locale":"uk-UA","DisplayName":" ()"},{"Locale":"ur-IN","DisplayName":" ()"},{"Locale":"ur-PK","DisplayName":" ()"},{"Locale":"uz-Arab-AF","DisplayName":" ()"},{"Locale":"uz-Cyrl-UZ","DisplayName":" ()"},{"Locale":"uz-Latn-UZ","DisplayName":"ozbek (Ozbekiston)"},{"Locale":"vi-VN","DisplayName":"Ting Vit (Vit Nam)"},{"Locale":"zh-CN","DisplayName":"()"},{"Locale":"zh-Hans-HK","DisplayName":" ()"},{"Locale":"zh-Hans-MO","DisplayName":" ()"},{"Locale":"zh-HK","DisplayName":"()"},{"Locale":"zh-MO","DisplayName":"()"},{"Locale":"zh-SG","DisplayName":"()"},{"Locale":"zh-TW","DisplayName":"()"}]')}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_plus_end"),shellPerformance.measure("shell_plus","shell_plus_start","shell_plus_end"));