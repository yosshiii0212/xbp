"use strict";(self["app-home_v1_jsonp"]=self["app-home_v1_jsonp"]||[]).push([[91116],{27659:(e,t,n)=>{n.d(t,{g:()=>d});var r=n(1397),o=n(71124),i=n(47647),a=n(38405),s=n(24939),l=n(18279);const c=()=>"";c.key="";const u=()=>"";u.key="";const g={officeAppName:i.zW.Unknown,officeAppDocType:i.iJ.Unknown,icon:"",documentIcon:"",createBlankUrl:"",fileExtensions:[],DefaultFileName:"",AppHomeOrigin:"",mobileDeviceStoreUrl:"",mobileDeviceDeepLinkScheme:"",CreatePartnerId:"",EnvironmentName:i.DF.Unknown,buildVersion:null,createBlankFileStringFunction:c,getMobileAppStringFunction:c,getMobileAppDialogTitleStringFunction:c,getMobileAppDialogSubtitleStringFunction:c,getMobileAppDialogPrimaryButtonStringFunction:c,loadBlankFileStringFunction:c,myFilesStringFunction:c,coreActionBanner:{AuthImages:{Mobile:"",Small:"",Large:"",XL:""},Style:{AuthContainer:"",Title:""},UnAuthImages:{Mobile:"",Small:"",Large:"",XL:""},UnAuthImagesRTL:{Mobile:"",Small:"",Large:"",XL:""},ButtonsDisabled:{UploadAFile:!1,CreateTemplate:!1}},coreActionTileThumbnail:{[a.o.CreateBlank]:"",[a.o.UploadFile]:"",[a.o.CreateWithCopilot]:""},showAllFilesStringFunction:c,OCVAppId:0,OCVHostName:s.u.Unknown,placeholderHeaderLeftIcon:"",AlternativeGoBackLink:"",createTemplatesAuthStyle:"",createTemplatesUnauthStyle:"",createTemplateUnauthMasonryMinHeightStyle:"",unauthHomePageTitleStringFunction:c,unauthPageTitleWrapperStringFunction:u,metaTagDescriptionStringFunction:c,authHomePageTitleStringFunction:c,upsellUrl:"",handoffWelcomeBannerStringFunction:c,handoffBrandingTaglineStringFunction:c,seoContents:[],destinationApp:r.Ww.NONE,sourceApp:r.Ww.NONE,themes:{[l.SV.Light]:{},[l.SV.Dark]:{}}},d=(0,o.createContext)(g)},42693:(e,t,n)=>{n.d(t,{Po:()=>c,UP:()=>r,XI:()=>g,_X:()=>u,gm:()=>o,lT:()=>a,nr:()=>i,sr:()=>s,uZ:()=>l}),n(39552);const r=()=>{var e,t;return(null===(e=window.navigator.userAgent)||void 0===e?void 0:e.indexOf("Edg/"))>-1||(null===(t=window.navigator.userAgent)||void 0===t?void 0:t.indexOf("EdgiOS"))>-1},o=()=>{var e;return(null===(e=window.navigator.userAgent)||void 0===e?void 0:e.indexOf("Firefox"))>0},i=()=>{var e,t,n,r,o;const i=(null===(e=window.navigator.userAgent)||void 0===e?void 0:e.indexOf("Chrome"))>-1,a=(null===(t=window.navigator.userAgent)||void 0===t?void 0:t.indexOf("CriOS"))>-1,s=(null===(n=window.navigator.userAgent)||void 0===n?void 0:n.indexOf("Edg/"))>-1,l=(null===(r=window.navigator.userAgent)||void 0===r?void 0:r.indexOf("EdgiOS"))>-1;return(null===(o=window.navigator.userAgent)||void 0===o?void 0:o.indexOf("Safari"))>-1&&!i&&!a&&!s&&!l},a=()=>{const e=window.navigator.userAgent.indexOf("MSIE ")>-1,t=window.navigator.userAgent.indexOf("Trident/")>-1;return e||t},s=()=>{const e=window.navigator.userAgent??"";return e.includes("Android")&&e.includes("Mobi")},l=()=>(window.navigator.userAgent??"").includes("iPhone"),c=()=>l()?"iPhone":s()?"AndroidPhone":"Other",u=()=>!!window.navigator.vendor&&window.navigator.vendor.indexOf("Apple")>-1&&!!window.navigator.userAgent&&window.navigator.userAgent.indexOf("CriOS")>-1&&l(),g=()=>{if(l()){const e=window.navigator.userAgent??"",t=e.indexOf("OS ");if(t>=0){const n=t+3,r=e.indexOf("_",n);if(r>0){const t=parseInt(e.substring(n,r));return isNaN(t)?0:t}}}return 0}},50378:(e,t,n)=>{n.d(t,{Ol:()=>h,iD:()=>g}),n(39552),n(39583);var r=n(70394),o=n(2515),i=n(54176),a=n(32041),s=n(48686),l=n(33746),c=n(4519),u=n(66855);const g=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{overrideToOneDriveForMSA:!1},n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;const g=u.Jp.getActiveAccount(),v={...e,redirectUri:l.AK};try{return await(0,r.L)((async()=>await d(v,t,n,g,s)),{totalAttempts:5,delayInMs:50,functionName:n,exponentialBackoff:!0,isRetryable:e=>!(e instanceof a.lR)||c.D.includes(e.errorCode)})}catch(t){const r=t,a=m(r,e,g,s);a?((0,o.a)({eventName:"GetTokenRedirect",httpCode:200,latency:0,subArea:"AuthUtilites",area:n}),await u.Jp.acquireTokenRedirect(a)):(0,i.v)({eventName:"GetTokenError",errorType:"Auth_Error",errorCode:null==r?void 0:r.errorCode,message:null==r?void 0:r.errorMessage,debugInfo:JSON.stringify(r)})}return null},d=async(e,t,n,r,i)=>{if(!r)return null;i&&(e={...e,claims:i}),t.overrideToOneDriveForMSA&&(0,l.Xu)((0,l.EO)(r))&&(e={...e,scopes:["OneDrive.ReadWrite"],authority:"https://login.microsoftonline.com/consumers"});const a=performance.now();try{const t=await u.Jp.acquireTokenSilent({...e,account:r});return(0,o.a)({eventName:"GetToken",httpCode:200,latency:performance.now()-a,subArea:"AuthUtilites",area:n}),t}catch(e){const t=e;throw(0,o.a)({eventName:"GetToken",httpCode:500,latency:performance.now()-a,subArea:"AuthUtilites",area:n,error:null==t?void 0:t.errorCode}),e}},m=(e,t,n,r)=>{return n&&(p(e)||v(e))?{scopes:t.scopes,authority:t.authority,correlationId:t.correlationId,account:t.account,extraQueryParameters:t.extraQueryParameters,tokenQueryParameters:t.tokenQueryParameters,redirectUri:t.redirectUri,loginHint:null===(o=n.idTokenClaims)||void 0===o?void 0:o.login_hint,claims:r}:null;var o},v=e=>e&&"invalid_grant"===e.errorCode&&e.errorMessage.startsWith("AADSTS700084"),p=e=>e&&(e instanceof s.CB||c.V.includes(null==e?void 0:e.errorCode)),h=e=>{const t={};if(-1!==e.indexOf(" ")){const n=e.indexOf(" ");e.substring(n+1).split(",").forEach((e=>{const[n,r]=e.split("=");t[n.trim()]=window.decodeURI(r.replace(/['"]+/g,""))}))}return t}},66855:(e,t,n)=>{n.d(t,{Jp:()=>I,ef:()=>w}),n(31033);var r=n(77760),o=n(42693),i=n(82038),a=n(29351),s=n(54176),l=n(90617),c=n(12092),u=n(98569),g=n(27766),d=n(33422),m=n(78705),v=n(29701),p=n(51681),h=n(70374),S=n(877),f=n(7947),A=n(92261);const w=async(e,t,n,r,o,i)=>{if((0,c.t)({featureName:"LoginRedirect",pageName:n},{SubArea:r,ScenarioId:o??""}),o&&o===u.C.UnauthAppHomePage){const e=window.location.href;let n=g.O.Unauth;i&&(n=g.O.UnauthControl);const o=t.wdOrigin;let a=(0,d.Io)(e,n,o);"SignInButton"===r&&(a=(0,d.Io)(a,g.O.ShellSignIn,o)),window.history.replaceState?window.history.replaceState({path:a},"",a):(0,s.v)({eventName:"AccessHistoryAPIError",errorType:"URF_Error",message:"Unable to access the HTML5 History API. Cannot append the new wdOrigin to the URL.",subArea:r})}await I.loginRedirect({...e,correlationId:t.sessionId,scenarioId:null==o?void 0:o.toString()})},O={auth:{clientId:"2821b473-fe24-4c86-ba16-62834d6e80c3",authority:"https://login.microsoftonline.com/common",postLogoutRedirectUri:"https://"+window.location.host,clientCapabilities:["CP1"],redirectUri:window.location.origin},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:(0,o.lT)()||(0,o.UP)()||(0,o.gm)()},system:{loggerOptions:{loggerCallback:(e,t,n)=>{if(!n)switch(e){case m.$.Error:return void(0,s.v)({eventName:"MsalAuthConfigError",errorType:"Auth_Error",message:"Error in msal auth config",debugInfo:t});case m.$.Warning:return void(0,c.t)({featureName:"MsalAuthConfigWarning",message:t});case m.$.Verbose:return void(0,c.t)({featureName:"MsalAuthConfigVerbose",message:t});default:return}}},iframeHashTimeout:1e4,loadFrameTimeout:2e4}},y={actAsBroker:!0,preferredInteractionType:p.X8.Redirect},I=new h.E(O,y,{enableMATS:!0,appName:"AppHomePages",appVersion:"1.0"});I.addEventCallback((async e=>{if(e.eventType===v.B.SSO_SILENT_SUCCESS&&e.payload)"logout"===sessionStorage.getItem(i.l.RequestOrigin)&&sessionStorage.removeItem(i.l.RequestOrigin),(0,c.t)({featureName:"SSOSilent",message:"Success"});else if(e.eventType===v.B.LOGOUT_SUCCESS)(0,S.U)(f.k.LoggedOut),localStorage.setItem(a.U.UserRecentlyLoggedOut,"true"),sessionStorage.setItem(i.l.RequestOrigin,"logout"),(0,l.Km)({eventName:"SignOutSuccess",area:"UnauthShell",result:"SignOut",target:"UnauthShell"});else if(e.eventType===v.B.LOGIN_FAILURE){var t,n;e.interactionType!==p.X8.Silent&&(0,s.v)({eventName:"SignInFailure",errorType:"Auth_Error",errorCode:null===(t=e.error)||void 0===t?void 0:t.name,debugInfo:null===(n=e.error)||void 0===n?void 0:n.message})}else if(e.eventType===v.B.LOGOUT_FAILURE){var r,o;(0,s.v)({eventName:"SignOutFailure",errorType:"Auth_Error",errorCode:null===(r=e.error)||void 0===r?void 0:r.name,debugInfo:null===(o=e.error)||void 0===o?void 0:o.message})}else e.eventType===v.B.ACQUIRE_TOKEN_SUCCESS&&e.payload&&(0,S.U)(f.k.LoggedIn)})),I.initializeBrokering().then((()=>I.initialize().then((()=>{I.handleRedirectPromise().then((e=>(async e=>{if(e){e.state&&!1===(0,r.p)(e.state)&&(0,s.v)({eventName:"UserIntentError",area:"AuthShell",errorType:"App_Error",message:"Error parsing user intent from state"}),"logout"===sessionStorage.getItem(i.l.RequestOrigin)&&sessionStorage.removeItem(i.l.RequestOrigin);const t=e.account;I.setActiveAccount(t),(0,S.U)(f.k.LoggedIn),localStorage.setItem(a.U.UserRecentlyLoggedOut,"false"),(0,l.Km)({eventName:"SignInSuccess",area:"AuthShell",result:"SignIn",target:"AuthShell"})}else{const e=localStorage.getItem(a.U.UserRecentlyLoggedOut),t=I.getAllAccounts();(null==t?void 0:t.length)>0?(I.getActiveAccount()||I.setActiveAccount(t[0]),(0,S.U)(f.k.LoggedIn)):null!==e&&"false"!==e||0!==(null==t?void 0:t.length)?(0,S.U)(f.k.LoggedOut):await(0,A.a)(I)}})(e))).catch((e=>{(0,s.v)({eventName:"HandleRedirectPromiseError",errorType:"Auth_Error",message:"Redirect with SSO failed",debugInfo:e instanceof Error?JSON.stringify({name:e.name,message:e.message,stack:e.stack}):void 0})}))})).catch((e=>{(0,s.v)({eventName:"MsalInitializeError",errorType:"Auth_Error",message:"MSAL initialization failed",debugInfo:e instanceof Error?JSON.stringify({name:e.name,message:e.message,stack:e.stack}):void 0})})))).catch((e=>{(0,s.v)({eventName:"BrokeringInitializeError",errorType:"Auth_Error",message:"Pairwise Broker Initialization failed",debugInfo:e instanceof Error?JSON.stringify({name:e.name,message:e.message,stack:e.stack}):void 0})}))}}]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/app-home_v1_91116_66a0015d0f21cdbca6bb.bundle.js.map/be761baf4980c9601ec873222de48378/app-home_v1_91116_66a0015d0f21cdbca6bb.bundle.js.map